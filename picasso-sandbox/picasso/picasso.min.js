/**
 * @qlik/picasso v0.34.0
 * Copyright (c) 2017 QlikTech International AB
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.picasso=e()}(this,function(){"use strict";function t(){return mu}function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.dock,n=void 0===e?"":e,i=t.displayOrder,r=void 0===i?0:i,o=t.prioOrder,a=void 0===o?0:o,s=t.requiredSize,c=void 0===s?function(){return 0}:s,u=t.minimumLayoutMode,l=t.show,h=void 0===l||l,f=function(){};return f.requiredSize=function(t){return"function"==typeof t?(c=t,this):c},f.dock=function(t){return void 0===t?n:(n=t,this)},f.displayOrder=function(t){return void 0===t?r:(r=t,this)},f.prioOrder=function(t){return void 0===t?a:(a=t,this)},f.minimumLayoutMode=function(t){return void 0===t?u:(u=t,this)},f.show=function(t){return void 0===t?h:(h=!!t,this)},f}function n(t){t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height)}function i(t,e){var i={x:0,y:0,width:0,height:0},r={x:0,y:0,width:0,height:0};if("function"==typeof t.getBoundingClientRect){var o=t.getBoundingClientRect();i.width=o.width,i.height=o.height}else i.width=t.width||0,i.height=t.height||0;return void 0!==e.size&&(i.width=isNaN(e.size.width)?i.width:e.size.width,i.height=isNaN(e.size.height)?i.height:e.size.height),void 0!==e.logicalSize?(r.width=isNaN(e.logicalSize.width)?i.width:e.logicalSize.width,r.height=isNaN(e.logicalSize.height)?i.height:e.logicalSize.height,r.align=isNaN(e.logicalSize.align)?.5:Math.min(Math.max(e.logicalSize.align,0),1),r.preserveAspectRatio=e.logicalSize.preserveAspectRatio):(r.width=i.width,r.height=i.height,r.preserveAspectRatio=!1),n(r),n(i),[r,i]}function r(t,e){return i(t,e)}function o(t){var e={logicalSize:{preserveAspectRatio:!1},center:{minWidthRatio:.5,minHeightRatio:.5,minWidth:0,minHeight:0}};return vu(!0,e,t),e.center.minWidthRatio=Math.min(Math.max(e.center.minWidthRatio,0),1),e.center.minHeightRatio=Math.min(Math.max(e.center.minHeightRatio,0),1),e.center.minWidth=Math.max(e.center.minWidth,0),e.center.minHeight=Math.max(e.center.minHeight,0),e}function a(t,e){return{x:t.x+e.x,y:t.y+e.y}}function s(t,e){return{x:t.x-e.x,y:t.y-e.y}}function c(t,e){return{x:t.x*e,y:t.y*e}}function u(t,e){return t.x-e.x}function l(t,e){return t.y-e.y}function h(t,e){return Math.pow(u(t,e),2)+Math.pow(l(t,e),2)}function f(t,e){return Math.sqrt(h(t,e))}function d(t,e){return t.x*e.x+t.y*e.y}function g(t,e){var n=d(t,e)/d(e,e)||1;return{x:e.x*n,y:e.y*n}}function p(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},i=Math.cos(e),r=Math.sin(e),o=s(t,n);return a({x:i*o.x-r*o.y,y:r*o.x+i*o.y},n)}function y(t,e,n){return a(g(s(n,t),s(e,t)),t)}function v(t,e,n){return f(t,n)+f(e,n)-f(t,e)<Ou}function m(t){return[{x:t.x1||0,y:t.y1||0},{x:t.x2||0,y:t.y2||0}]}function x(t){return[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}]}function b(t){for(var e=t.length,n=NaN,i=NaN,r=NaN,o=NaN,a=0;a<e;a++)n=isNaN(n)?t[a].x:Math.min(n,t[a].x),i=isNaN(i)?t[a].x:Math.max(i,t[a].x),r=isNaN(r)?t[a].y:Math.min(r,t[a].y),o=isNaN(o)?t[a].y:Math.max(o,t[a].y);return[n,r,i,o]}function w(t){var e=b(t),n=Ru(e,4),i=n[0],r=n[1];return{x:i,y:r,width:n[2]-i,height:n[3]-r}}function k(t,e){return{cx:t[0].x,cy:t[0].y,r:e}}function _(t){return{x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y}}function M(t){["resize"].forEach(function(e){if("function"!=typeof t[e])throw new Error('Component is missing required function "'+e+'"')})}function S(t,e,n){if(void 0===t.cachedSize){var i=t.config.requiredSize()(e,n);"object"===(void 0===i?"undefined":xu(i))?(t.cachedSize=Math.ceil(i.size),t.edgeBleed=i.edgeBleed):t.cachedSize=Math.ceil(i)}return t.cachedSize}function R(t,e,n){var i=Math.min(n.center.minWidth,t.width)||Math.max(t.width*n.center.minWidthRatio,1),r=Math.min(n.center.minHeight,t.height)||Math.max(t.height*n.center.minHeightRatio,1);return e.width>=i&&e.height>=r}function z(t,e){switch(e.config.dock()){case"top":t.y+=e.cachedSize,t.height-=e.cachedSize;break;case"bottom":t.height-=e.cachedSize;break;case"left":t.x+=e.cachedSize,t.width-=e.cachedSize;break;case"right":t.width-=e.cachedSize}}function O(t,e){var n=e.edgeBleed;n&&(t.left=Math.max(t.left,n.left||0),t.right=Math.max(t.right,n.right||0),t.top=Math.max(t.top,n.top||0),t.bottom=Math.max(t.bottom,n.bottom||0))}function N(t,e,n){e.x<n.left&&(e.width-=n.left-e.x,e.x=n.left);var i=t.width-(e.x+e.width);i<n.right&&(e.width-=n.right-i),e.y<n.top&&(e.height-=n.top-e.y,e.y=n.top);var r=t.height-(e.y+e.height);r<n.bottom&&(e.height-=n.bottom-r)}function A(t,e,n,i,r){var o=vu({},e),a=vu({},n);return z(o,i),O(a,i),N(t,o,a),!!R(t,o,r)&&(z(e,i),O(n,i),!0)}function E(t,e,n,i){var r={x:t.x,y:t.y,width:t.width,height:t.height},o={left:0,right:0,top:0,bottom:0},a=e.slice();a.sort(function(t,e){return t.config.prioOrder()-e.config.prioOrder()});for(var s=0;s<a.length;++s){var c=a[s];S(c,r,t),A(t,r,o,c,i)||(a.splice(s,1),n.push(c.instance),--s)}var u=e.filter(function(t){return-1!==a.indexOf(t)});return e.length=0,e.push.apply(e,zu(u)),N(t,r,o),r}function C(t,e,n,i){var r={x:i.width/n.width,y:i.height/n.height},o={left:0,top:0};if(n.preserveAspectRatio){var a=r.x<r.y,s=Math.min(r.x,r.y);r.x=s,r.y=s;var c=a?"height":"width",u=(i[c]-n[c]*r.x)*n.align;o.left=a?0:u,o.top=a?u:0}t.scaleRatio=r,t.margin=o,e.scaleRatio=r,e.margin=o,n.scaleRatio=r,n.margin=o}function T(t){var e;return w((e=[]).concat.apply(e,zu(t.map(x))))}function j(t,e,n,i){var r={x:n.x,y:n.y,width:n.width,height:n.height},o={x:n.x,y:n.y,width:n.width,height:n.height},a={};t.sort(function(t,e){return/^@/.test(e.config.dock())?-1:/^@/.test(t.config.dock())?1:t.config.displayOrder()-e.config.displayOrder()}).forEach(function(t){var s={},c={},u=t.config.dock();switch(u){case"top":s.height=c.height=t.cachedSize,s.width=e.width,c.width=r.width,s.x=e.x,c.x=r.x,s.y=c.y=r.y-t.cachedSize,r.y-=t.cachedSize,r.height+=t.cachedSize;break;case"bottom":s.x=e.x,c.x=r.x,s.y=c.y=r.y+r.height,s.width=e.width,c.width=r.width,s.height=c.height=t.cachedSize,r.height+=t.cachedSize;break;case"left":s.x=c.x=o.x-t.cachedSize,s.y=e.y,c.y=o.y,s.width=c.width=t.cachedSize,s.height=e.height,c.height=o.height,o.x-=t.cachedSize,o.width+=t.cachedSize;break;case"right":s.x=c.x=o.x+o.width,s.y=e.y,c.y=o.y,s.width=c.width=t.cachedSize,s.height=e.height,c.height=o.height,o.width+=t.cachedSize;break;default:s.x=c.x=n.x,s.y=c.y=n.y,s.width=c.width=n.width,s.height=c.height=n.height}if(/^@/.test(u)){var l=u.split(",").map(function(t){return a[t.replace("@","")]}).filter(function(t){return!!t});l.length>0&&(s=T(l.map(function(t){return t.outerRect})),c=T(l.map(function(t){return t.rect})))}else t.key&&(a[t.key]={rect:c,outerRect:s});C(c,s,e,i),t.instance.resize(c,s,e),t.cachedSize=void 0})}function P(t,e,n,i){for(var r=n.layoutModes||{},o=0;o<t.length;++o){var a=t[o],s=a.config.minimumLayoutMode(),c=a.config.show();c&&"object"===(void 0===s?"undefined":xu(s))?c=r[s.width]&&r[s.height]&&i.width>=r[s.width].width&&i.height>=r[s.height].height:c&&void 0!==s&&(c=r[s]&&i.width>=r[s].width&&i.height>=r[s].height),c||(t.splice(o,1),e.push(a.instance),--o)}}function F(t){var n=[],i=[],a=o(t),s=function(){};return s.addComponent=function(t,i){M(t),s.removeComponent(t),n.push({instance:t,key:i,config:"function"==typeof t.dockConfig?t.dockConfig:e(t.dockConfig)})},s.removeComponent=function(t){var e=n.map(function(t){return t.instance}).indexOf(t);e>-1&&n.splice(e,1)},s.layout=function(t){var e=r(t,a),o=Ru(e,2),s=o[0],c=o[1];P(n,i,a,s);var u=E(s,n,i,a);return j(n,s,u,c),{visible:n.map(function(t){return t.instance}),hidden:i}},s.settings=function(t){a=o(t)},s}function L(t){return"ontouchstart"in t&&"ontouchend"in t}function W(t){return!!t.changedTouches}function D(t,e){var n=W(t),i=n?t.changedTouches[0]:t,r=Date.now()-e.time,o=isNaN(e.x)?0:Math.abs(i.clientX-e.x),a=isNaN(e.y)?0:Math.abs(i.clientY-e.y);return(0===t.button||n)&&!e.multiTouch&&o<=12&&a<=12&&r<=300}function B(t){return"number"==typeof t&&!isNaN(t)}function H(t){var e=t||{},n=e.x,i=e.y,r=e.width,o=e.height,a=e.x1,s=e.x2,c=e.y1,u=e.y2,l=e.cx,h=e.cy,f=e.r,d=e.vertices;return B(l)&&B(h)&&B(f)?"circle":B(a)&&B(s)&&B(c)&&B(u)?"line":B(n)&&B(i)&&B(r)&&B(o)?"rect":B(n)&&B(i)?"point":Array.isArray(d)?"polygon":null}function I(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="",i=0;i<t.length;i++){var r=t[i];n+=0===i?"M"+r.x+" "+r.y:"L"+r.x+" "+r.y,n+=" "}return e&&(n+="Z"),n}function V(t,e){var n=e.types,i=e.logger,r={},o=[];Array.isArray(t)?o.push.apply(o,zu(t)):(i.warn('Deprecated: "data-source" configuration"'),o.push(t)),o.forEach(function(t,e){var i=n(t.type);if(i){var o=i({key:t.key||e,data:t.data,config:t.config});r[t.key||e]=o}});return function(t){return t?r[t]:r[Object.keys(r)[0]]}}function U(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function q(){return new U}function Y(t){return t>1?0:t<-1?Hu:Math.acos(t)}function X(t){return t>=1?Iu:t<=-1?-Iu:Math.asin(t)}function $(t){return t.innerRadius}function Z(t){return t.outerRadius}function G(t){return t.startAngle}function J(t){return t.endAngle}function K(t){return t&&t.padAngle}function Q(t,e,n,i,r,o,a,s){var c=n-t,u=i-e,l=a-r,h=s-o,f=(l*(e-o)-h*(t-r))/(h*c-l*u);return[t+f*c,e+f*u]}function tt(t,e,n,i,r,o,a){var s=t-n,c=e-i,u=(a?o:-o)/Du(s*s+c*c),l=u*c,h=-u*s,f=t+l,d=e+h,g=n+l,p=i+h,y=(f+g)/2,v=(d+p)/2,m=g-f,x=p-d,b=m*m+x*x,w=r-o,k=f*p-g*d,_=(x<0?-1:1)*Du(Fu(0,w*w*b-k*k)),M=(k*x-m*_)/b,S=(-k*m-x*_)/b,R=(k*x+m*_)/b,z=(-k*m+x*_)/b,O=M-y,N=S-v,A=R-y,E=z-v;return O*O+N*N>A*A+E*E&&(M=R,S=z),{cx:M,cy:S,x01:-l,y01:-h,x11:M*(r/w-1),y11:S*(r/w-1)}}function et(t){this._context=t}function nt(t){return t[0]}function it(t){return t[1]}function rt(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function ot(t){this._context=t}function at(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function st(t,e){this._context=t,this._k=(1-e)/6}function ct(t,e,n){var i=t._x1,r=t._y1,o=t._x2,a=t._y2;if(t._l01_a>Bu){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,r=(r*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>Bu){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*u+t._x1*t._l23_2a-e*t._l12_2a)/l,a=(a*u+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(i,r,o,a,t._x2,t._y2)}function ut(t,e){this._context=t,this._alpha=e}function lt(t){return t<0?-1:1}function ht(t,e,n){var i=t._x1-t._x0,r=e-t._x1,o=(t._y1-t._y0)/(i||r<0&&-0),a=(n-t._y1)/(r||i<0&&-0),s=(o*r+a*i)/(i+r);return(lt(o)+lt(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function ft(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function dt(t,e,n){var i=t._x0,r=t._y0,o=t._x1,a=t._y1,s=(o-i)/3;t._context.bezierCurveTo(i+s,r+s*e,o-s,a-s*n,o,a)}function gt(t){this._context=t}function pt(t){this._context=new yt(t)}function yt(t){this._context=t}function vt(t){this._context=t}function mt(t){var e,n,i=t.length-1,r=new Array(i),o=new Array(i),a=new Array(i);for(r[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<i-1;++e)r[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(r[i-1]=2,o[i-1]=7,a[i-1]=8*t[i-1]+t[i],e=1;e<i;++e)n=r[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(r[i-1]=a[i-1]/o[i-1],e=i-2;e>=0;--e)r[e]=(a[e]-r[e+1])/o[e];for(o[i-1]=(t[i]+r[i-1])/2,e=0;e<i-1;++e)o[e]=2*t[e+1]-r[e+1];return[r,o]}function xt(t,e){this._context=t,this._t=e}function bt(t,e){return t[e]}function wt(t){for(var e,n=0,i=-1,r=t.length;++i<r;)(e=+t[i][1])&&(n+=e);return n}function kt(t){function e(t,e){if(!t||"string"!=typeof t)throw new TypeError("Invalid argument: key must be a non-empty string");return!(t in o)&&(o[t]=e,!0)}function n(t){return o[t]||a.get(t)}function i(t,i){return void 0!==i?e(t,i):n(t||r)}var r=void 0,o={},a=t||{get:function(){},has:function(){return!1},default:function(){}};return r=a.default(),i.add=e,i.get=n,i.has=function(t){return!!o[t]||a.has(t)},i.remove=function(t){var e=o[t];return delete o[t],e},i.getKeys=function(){return Object.keys(o)},i.getValues=function(){return Object.keys(o).map(function(t){return o[t]})},i.default=function(t){return void 0!==t&&(r=t),r},i.register=e,i}function _t(t){return new Mt(t)}function Mt(t){if(!(e=ll.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",i=e[2]||">",r=e[3]||"-",o=e[4]||"",a=!!e[5],s=e[6]&&+e[6],c=!!e[7],u=e[8]&&+e[8].slice(1),l=e[9]||"";"n"===l?(c=!0,l="g"):ul[l]||(l=""),(a||"0"===n&&"="===i)&&(a=!0,n="0",i="="),this.fill=n,this.align=i,this.sign=r,this.symbol=o,this.zero=a,this.width=s,this.comma=c,this.precision=u,this.type=l}function St(t,e,n,i){function r(e){return t(e=new Date(+e)),e}return r.floor=r,r.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},r.round=function(t){var e=r(t),n=r.ceil(t);return t-e<n-t?e:n},r.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},r.range=function(n,i,o){var a=[];if(n=r.ceil(n),o=null==o?1:Math.floor(o),!(n<i&&o>0))return a;do{a.push(new Date(+n))}while(e(n,o),t(n),n<i);return a},r.filter=function(n){return St(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,i){if(t>=t)if(i<0)for(;++i<=0;)for(;e(t,-1),!n(t););else for(;--i>=0;)for(;e(t,1),!n(t););})},n&&(r.count=function(e,i){return bl.setTime(+e),wl.setTime(+i),t(bl),t(wl),Math.floor(n(bl,wl))},r.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?r.filter(i?function(e){return i(e)%t==0}:function(e){return r.count(0,e)%t==0}):r:null}),r}function Rt(t){return St(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*_l)/Ml})}function zt(t){return St(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/Ml})}function Ot(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Nt(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function At(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function Et(t){function e(t,e){return function(n){var i,r,o,a=[],s=-1,c=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(a.push(t.slice(c,s)),null!=(r=Wl[i=t.charAt(++s)])?i=t.charAt(++s):r="e"===i?" ":"0",(o=e[i])&&(i=o(n,r)),a.push(i),c=s+1);return a.push(t.slice(c,s)),a.join("")}}function n(t,e){return function(n){var r=At(1900);if(i(r,t,n+="",0)!=n.length)return null;if("p"in r&&(r.H=r.H%12+12*r.p),"W"in r||"U"in r){"w"in r||(r.w="W"in r?1:0);var o="Z"in r?Nt(At(r.y)).getUTCDay():e(At(r.y)).getDay();r.m=0,r.d="W"in r?(r.w+6)%7+7*r.W-(o+5)%7:r.w+7*r.U-(o+6)%7}return"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,Nt(r)):e(r)}}function i(t,e,n,i){for(var r,o,a=0,s=e.length,c=n.length;a<s;){if(i>=c)return-1;if(37===(r=e.charCodeAt(a++))){if(r=e.charAt(a++),!(o=M[r in Wl?e.charAt(a++):r])||(i=o(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}var r=t.dateTime,o=t.date,a=t.time,s=t.periods,c=t.days,u=t.shortDays,l=t.months,h=t.shortMonths,f=jt(s),d=Pt(s),g=jt(c),p=Pt(c),y=jt(u),v=Pt(u),m=jt(l),x=Pt(l),b=jt(h),w=Pt(h),k={a:function(t){return u[t.getDay()]},A:function(t){return c[t.getDay()]},b:function(t){return h[t.getMonth()]},B:function(t){return l[t.getMonth()]},c:null,d:Gt,e:Gt,H:Jt,I:Kt,j:Qt,L:te,m:ee,M:ne,p:function(t){return s[+(t.getHours()>=12)]},S:ie,U:re,w:oe,W:ae,x:null,X:null,y:se,Y:ce,Z:ue,"%":Me},_={a:function(t){return u[t.getUTCDay()]},A:function(t){return c[t.getUTCDay()]},b:function(t){return h[t.getUTCMonth()]},B:function(t){return l[t.getUTCMonth()]},c:null,d:le,e:le,H:he,I:fe,j:de,L:ge,m:pe,M:ye,p:function(t){return s[+(t.getUTCHours()>=12)]},S:ve,U:me,w:xe,W:be,x:null,X:null,y:we,Y:ke,Z:_e,"%":Me},M={a:function(t,e,n){var i=y.exec(e.slice(n));return i?(t.w=v[i[0].toLowerCase()],n+i[0].length):-1},A:function(t,e,n){var i=g.exec(e.slice(n));return i?(t.w=p[i[0].toLowerCase()],n+i[0].length):-1},b:function(t,e,n){var i=b.exec(e.slice(n));return i?(t.m=w[i[0].toLowerCase()],n+i[0].length):-1},B:function(t,e,n){var i=m.exec(e.slice(n));return i?(t.m=x[i[0].toLowerCase()],n+i[0].length):-1},c:function(t,e,n){return i(t,r,e,n)},d:Vt,e:Vt,H:qt,I:qt,j:Ut,L:$t,m:It,M:Yt,p:function(t,e,n){var i=f.exec(e.slice(n));return i?(t.p=d[i[0].toLowerCase()],n+i[0].length):-1},S:Xt,U:Lt,w:Ft,W:Wt,x:function(t,e,n){return i(t,o,e,n)},X:function(t,e,n){return i(t,a,e,n)},y:Bt,Y:Dt,Z:Ht,"%":Zt};return k.x=e(o,k),k.X=e(a,k),k.c=e(r,k),_.x=e(o,_),_.X=e(a,_),_.c=e(r,_),{format:function(t){var n=e(t+="",k);return n.toString=function(){return t},n},parse:function(t){var e=n(t+="",Ot);return e.toString=function(){return t},e},utcFormat:function(t){var n=e(t+="",_);return n.toString=function(){return t},n},utcParse:function(t){var e=n(t,Nt);return e.toString=function(){return t},e}}}function Ct(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(e)+r:r)}function Tt(t){return t.replace(Hl,"\\$&")}function jt(t){return new RegExp("^(?:"+t.map(Tt).join("|")+")","i")}function Pt(t){for(var e={},n=-1,i=t.length;++n<i;)e[t[n].toLowerCase()]=n;return e}function Ft(t,e,n){var i=Dl.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Lt(t,e,n){var i=Dl.exec(e.slice(n));return i?(t.U=+i[0],n+i[0].length):-1}function Wt(t,e,n){var i=Dl.exec(e.slice(n));return i?(t.W=+i[0],n+i[0].length):-1}function Dt(t,e,n){var i=Dl.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Bt(t,e,n){var i=Dl.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function Ht(t,e,n){var i=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function It(t,e,n){var i=Dl.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function Vt(t,e,n){var i=Dl.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function Ut(t,e,n){var i=Dl.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function qt(t,e,n){var i=Dl.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function Yt(t,e,n){var i=Dl.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function Xt(t,e,n){var i=Dl.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function $t(t,e,n){var i=Dl.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function Zt(t,e,n){var i=Bl.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function Gt(t,e){return Ct(t.getDate(),e,2)}function Jt(t,e){return Ct(t.getHours(),e,2)}function Kt(t,e){return Ct(t.getHours()%12||12,e,2)}function Qt(t,e){return Ct(1+Sl.count(Ol(t),t),e,3)}function te(t,e){return Ct(t.getMilliseconds(),e,3)}function ee(t,e){return Ct(t.getMonth()+1,e,2)}function ne(t,e){return Ct(t.getMinutes(),e,2)}function ie(t,e){return Ct(t.getSeconds(),e,2)}function re(t,e){return Ct(Rl.count(Ol(t),t),e,2)}function oe(t){return t.getDay()}function ae(t,e){return Ct(zl.count(Ol(t),t),e,2)}function se(t,e){return Ct(t.getFullYear()%100,e,2)}function ce(t,e){return Ct(t.getFullYear()%1e4,e,4)}function ue(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ct(e/60|0,"0",2)+Ct(e%60,"0",2)}function le(t,e){return Ct(t.getUTCDate(),e,2)}function he(t,e){return Ct(t.getUTCHours(),e,2)}function fe(t,e){return Ct(t.getUTCHours()%12||12,e,2)}function de(t,e){return Ct(1+Nl.count(Cl(t),t),e,3)}function ge(t,e){return Ct(t.getUTCMilliseconds(),e,3)}function pe(t,e){return Ct(t.getUTCMonth()+1,e,2)}function ye(t,e){return Ct(t.getUTCMinutes(),e,2)}function ve(t,e){return Ct(t.getUTCSeconds(),e,2)}function me(t,e){return Ct(Al.count(Cl(t),t),e,2)}function xe(t){return t.getUTCDay()}function be(t,e){return Ct(El.count(Cl(t),t),e,2)}function we(t,e){return Ct(t.getUTCFullYear()%100,e,2)}function ke(t,e){return Ct(t.getUTCFullYear()%1e4,e,4)}function _e(){return"+0000"}function Me(){return"%"}function Se(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.id,i=void 0===n?Vl.id:n,r=e.key,o=void 0===r?Vl.key:r,a=e.min,s=void 0===a?Vl.min:a,c=e.max,u=void 0===c?Vl.max:c,l=e.type,h=void 0===l?Vl.type:l,f=e.tags,d=void 0===f?Vl.tags:f,g=e.title,p=void 0===g?Vl.title:g,y=e.values,v=void 0===y?Vl.values:y,m=e.value,x=void 0===m?Vl.value:m,b=e.formatter,w=void 0===b?Vl.formatter:b;return{id:function(){return i(t)},key:function(){return o(t)},tags:function(){return d(t)},type:function(){return h(t)},min:function(){return s(t)},max:function(){return u(t)},title:function(){return p(t)},items:function(){return v(t)},formatter:function(){return w(t)},value:x}}function Re(t,e,n){for(var i={},r=e.stackKey,o=e.value,a=e.startProp||"start",s=e.endProp||"end",c=e.offset||"none",u=e.order||"none",l=e.valueRef||"",h=0,f={},d=0;d<t.items.length;d++){var g=t.items[d],p=l?g[l]:null;if(p&&p.source){var y=(p.source.key||"")+"/"+p.source.field;f[y]||(f[y]=p.source)}var v=r(g);i[v]=i[v]||{items:[]},i[v].items.push(g),h=Math.max(h,i[v].items.length)}for(var m=Array.apply(null,{length:h}).map(Number.call,Number),x=Object.keys(i).map(function(t){return i[t].items}),b=il().keys(m).value(function(t,e){return t[e]?o(t[e]):0}).order(ql[u]).offset(Ul[c])(x),w=[],k=0;k<b.length;k++)for(var _=b[k],M=0;M<_.length;M++){var S=_[M],R=_[M].data[_.key];R&&(R[a]={value:S[0]},R[s]={value:S[1]},w.push(S[0],S[1]))}var z=Object.keys(f).map(function(t){var e=n(f[t].key);return e?e.field(f[t].field):null}).filter(function(t){return!!t}),O=Se({title:z.map(function(t){return t.title()}).join(", "),min:Math.min.apply(Math,w),max:Math.max.apply(Math,w),type:"measure",formatter:z[0]?z[0].formatter:void 0});t.fields.push(O)}function ze(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).logger;if(Array.isArray(t))n.items=t.map(function(t){return{value:t}});else if(t){if("collection"in t)return e.collection(t.collection);var r=e.dataset?e.dataset(t.source):null,o=t.value||function(t){return t};if(t.groupBy||t.mapTo)i.warn('Deprecated "data" configuration',t),n.items=[];else if(t.hierarchy)n.root=r.hierarchy?r.hierarchy(t.hierarchy):null;else if(t.items)n.items=t.items.map(function(t){return{value:o(t)}});else if(r)if(n.source=r,t.extract){n.items=r.extract(t.extract);var a=[];(Array.isArray(t.extract)?t.extract:[t.extract]).forEach(function(t){t.field&&a.push(r.field(t.field))}),a.length&&(n.fields=a)}else if(t.fields)t.fields.forEach(function(t){var e=r.field(t);e&&(n.fields||(n.fields=[]),n.fields.push(e))});else if(void 0!==t.field){var s=r.field(t.field);s&&(n.fields||(n.fields=[]),n.fields.push(s),"value"in t||(o=s.value||function(t){return t},n.value=o),n.items=s.items().map(function(e){return{value:o(e),source:{field:t.field}}}))}n.items&&t.map&&(n.items=n.items.map(t.map))}return t&&t.stack&&Re(n,t.stack,e.dataset),n}function Oe(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ze,r={};(t||[]).forEach(function(t){if(!t.key)throw new Error('Data collection is missing "key" property');if("object"===xu(t.data)&&"collection"in t.data)throw new Error("Data config for collections may not reference other collections");r[t.key]=i(t.data,e,n)});return function(t){var e=void 0,n=void 0;if("string"==typeof t?e=t:"object"===(void 0===t?"undefined":xu(t))&&(e=t.key,n=t),!(e in r))throw new Error("Unknown data collection: "+e);var i=r[e];if(n&&n.fields&&n.fields.filter){var o=i.fields.filter(n.fields.filter);i.fields.length!==o.length&&(i=vu(i,{fields:o}))}return i}}function Ne(t,e){return e.title()===t}function Ae(t,e,n){if(t.source){var i=e.findField(t.source,Ne);if(i&&void 0!==i.field)return i.field.formatter()}var r=void 0;return r=t.formatter?(t.formatter||"d3")+"-"+(t.type||"number"):t.type||"d3-number",n.formatter(r)(t.format||"")}function Ee(t,e,n){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=Ae(t[r],e,n));return i}function Ce(t,e,n,i){var r=void 0;return"string"==typeof t&&e[t]?r=e[t]:"object"===(void 0===t?"undefined":xu(t))&&"formatter"in t&&e[t.formatter]?r=e[t.formatter]:"object"===(void 0===t?"undefined":xu(t))&&"type"in t&&e[t.type]&&(r=e[t.type]),r||Ae(t,n,i)}function Te(t){return function(e,n){return Yl(t(e),n)}}function je(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=Zl?10:o>=Gl?5:o>=Jl?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=Zl?10:o>=Gl?5:o>=Jl?2:1)}function Pe(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=Zl?r*=10:o>=Gl?r*=5:o>=Jl&&(r*=2),e<t?-r:r}function Fe(){}function Le(t,e){var n=new Fe;if(t instanceof Fe)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var i,r=-1,o=t.length;if(null==e)for(;++r<o;)n.set(r,t[r]);else for(;++r<o;)n.set(e(i=t[r],r,t),i)}else if(t)for(var a in t)n.set(a,t[a]);return n}function We(){}function De(t){function e(e){var o=e+"",a=n.get(o);if(!a){if(r!==ih)return r;n.set(o,a=i.push(e))}return t[(a-1)%t.length]}var n=Le(),i=[],r=ih;return t=null==t?[]:nh.call(t),e.domain=function(t){if(!arguments.length)return i.slice();i=[],n=Le();for(var r,o,a=-1,s=t.length;++a<s;)n.has(o=(r=t[a])+"")||n.set(o,i.push(r));return e},e.range=function(n){return arguments.length?(t=nh.call(n),e):t.slice()},e.unknown=function(t){return arguments.length?(r=t,e):r},e.copy=function(){return De().domain(i).range(t).unknown(r)},e}function Be(){function t(){var t=r().length,i=a[1]<a[0],h=a[i-0],f=a[1-i];e=(f-h)/Math.max(1,t-c+2*u),s&&(e=Math.floor(e)),h+=(f-h-e*(t-c))*l,n=e*(1-c),s&&(h=Math.round(h),n=Math.round(n));var d=$l(t).map(function(t){return h+e*t});return o(i?d.reverse():d)}var e,n,i=De().unknown(void 0),r=i.domain,o=i.range,a=[0,1],s=!1,c=0,u=0,l=.5;return delete i.unknown,i.domain=function(e){return arguments.length?(r(e),t()):r()},i.range=function(e){return arguments.length?(a=[+e[0],+e[1]],t()):a.slice()},i.rangeRound=function(e){return a=[+e[0],+e[1]],s=!0,t()},i.bandwidth=function(){return n},i.step=function(){return e},i.round=function(e){return arguments.length?(s=!!e,t()):s},i.padding=function(e){return arguments.length?(c=u=Math.max(0,Math.min(1,e)),t()):c},i.paddingInner=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),t()):c},i.paddingOuter=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),t()):u},i.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),t()):l},i.copy=function(){return Be().domain(r()).range(a).round(s).paddingInner(c).paddingOuter(u).align(l)},t()}function He(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Ie(){}function Ve(t){var e;return t=(t+"").trim().toLowerCase(),(e=ch.exec(t))?(e=parseInt(e[1],16),new $e(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1)):(e=uh.exec(t))?Ue(parseInt(e[1],16)):(e=lh.exec(t))?new $e(e[1],e[2],e[3],1):(e=hh.exec(t))?new $e(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=fh.exec(t))?qe(e[1],e[2],e[3],e[4]):(e=dh.exec(t))?qe(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=gh.exec(t))?Ze(e[1],e[2]/100,e[3]/100,1):(e=ph.exec(t))?Ze(e[1],e[2]/100,e[3]/100,e[4]):yh.hasOwnProperty(t)?Ue(yh[t]):"transparent"===t?new $e(NaN,NaN,NaN,0):null}function Ue(t){return new $e(t>>16&255,t>>8&255,255&t,1)}function qe(t,e,n,i){return i<=0&&(t=e=n=NaN),new $e(t,e,n,i)}function Ye(t){return t instanceof Ie||(t=Ve(t)),t?(t=t.rgb(),new $e(t.r,t.g,t.b,t.opacity)):new $e}function Xe(t,e,n,i){return 1===arguments.length?Ye(t):new $e(t,e,n,null==i?1:i)}function $e(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Ze(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Je(t,e,n,i)}function Ge(t){if(t instanceof Je)return new Je(t.h,t.s,t.l,t.opacity);if(t instanceof Ie||(t=Ve(t)),!t)return new Je;if(t instanceof Je)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),a=NaN,s=o-r,c=(o+r)/2;return s?(a=e===o?(n-i)/s+6*(n<i):n===o?(i-e)/s+2:(e-n)/s+4,s/=c<.5?o+r:2-o-r,a*=60):s=c>0&&c<1?0:a,new Je(a,s,c,t.opacity)}function Je(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Ke(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Qe(t){if(t instanceof tn)return new tn(t.l,t.a,t.b,t.opacity);if(t instanceof sn){var e=t.h*vh;return new tn(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof $e||(t=Ye(t));var n=on(t.r),i=on(t.g),r=on(t.b),o=en((.4124564*n+.3575761*i+.1804375*r)/xh),a=en((.2126729*n+.7151522*i+.072175*r)/bh);return new tn(116*a-16,500*(o-a),200*(a-en((.0193339*n+.119192*i+.9503041*r)/wh)),t.opacity)}function tn(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}function en(t){return t>Sh?Math.pow(t,1/3):t/Mh+kh}function nn(t){return t>_h?t*t*t:Mh*(t-kh)}function rn(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function on(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function an(t){if(t instanceof sn)return new sn(t.h,t.c,t.l,t.opacity);t instanceof tn||(t=Qe(t));var e=Math.atan2(t.b,t.a)*mh;return new sn(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function sn(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function cn(t){if(t instanceof ln)return new ln(t.h,t.s,t.l,t.opacity);t instanceof $e||(t=Ye(t));var e=t.r/255,n=t.g/255,i=t.b/255,r=(Th*i+Eh*e-Ch*n)/(Th+Eh-Ch),o=i-r,a=(Ah*(n-r)-Oh*o)/Nh,s=Math.sqrt(a*a+o*o)/(Ah*r*(1-r)),c=s?Math.atan2(a,o)*mh-120:NaN;return new ln(c<0?c+360:c,s,r,t.opacity)}function un(t,e,n,i){return 1===arguments.length?cn(t):new ln(t,e,n,null==i?1:i)}function ln(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function hn(t,e){return function(n){return t+n*e}}function fn(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function dn(t){return 1==(t=+t)?gn:function(e,n){return n-e?fn(e,n,t):jh(isNaN(e)?n:e)}}function gn(t,e){var n=e-t;return n?hn(t,n):jh(isNaN(t)?e:t)}function pn(t){return function(){return t}}function yn(t){return function(e){return t(e)+""}}function vn(t){return function e(n){function i(e,i){var r=t((e=un(e)).h,(i=un(i)).h),o=gn(e.s,i.s),a=gn(e.l,i.l),s=gn(e.opacity,i.opacity);return function(t){return e.h=r(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,i.gamma=e,i}(1)}function mn(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Yh(e)}function xn(t){return function(e,n){var i=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:i(t)}}}function bn(t){return function(e,n){var i=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:i(t)}}}function wn(t,e,n,i){var r=t[0],o=t[1],a=e[0],s=e[1];return o<r?(r=n(o,r),a=i(s,a)):(r=n(r,o),a=i(a,s)),function(t){return a(r(t))}}function kn(t,e,n,i){var r=Math.min(t.length,e.length)-1,o=new Array(r),a=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)o[s]=n(t[s],t[s+1]),a[s]=i(e[s],e[s+1]);return function(e){var n=Xl(t,e,1,r)-1;return a[n](o[n](e))}}function _n(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function Mn(t,e){function n(){return r=Math.min(s.length,c.length)>2?kn:wn,o=a=null,i}function i(e){return(o||(o=r(s,c,l?xn(t):t,u)))(+e)}var r,o,a,s=$h,c=$h,u=Vh,l=!1;return i.invert=function(t){return(a||(a=r(c,s,mn,l?bn(e):e)))(+t)},i.domain=function(t){return arguments.length?(s=eh.call(t,Xh),n()):s.slice()},i.range=function(t){return arguments.length?(c=nh.call(t),n()):c.slice()},i.rangeRound=function(t){return c=nh.call(t),u=Uh,n()},i.clamp=function(t){return arguments.length?(l=!!t,n()):l},i.interpolate=function(t){return arguments.length?(u=t,n()):u},n()}function Sn(t){var e=t.domain;return t.ticks=function(t){var n=e();return Kl(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return Zh(e(),t,n)},t.nice=function(n){null==n&&(n=10);var i,r=e(),o=0,a=r.length-1,s=r[o],c=r[a];return c<s&&(i=s,s=c,c=i,i=o,o=a,a=i),(i=je(s,c,n))>0?i=je(s=Math.floor(s/i)*i,c=Math.ceil(c/i)*i,n):i<0&&(i=je(s=Math.ceil(s*i)/i,c=Math.floor(c*i)/i,n)),i>0?(r[o]=Math.floor(s/i)*i,r[a]=Math.ceil(c/i)*i,e(r)):i<0&&(r[o]=Math.ceil(s*i)/i,r[a]=Math.floor(c*i)/i,e(r)),t},t}function Rn(){var t=Mn(mn,Wh);return t.copy=function(){return _n(t,Rn())},Sn(t)}function zn(){function t(t){if(t<=t)return n[Xl(e,t,0,i)]}var e=[.5],n=[0,1],i=1;return t.domain=function(r){return arguments.length?(e=nh.call(r),i=Math.min(e.length,n.length-1),t):e.slice()},t.range=function(r){return arguments.length?(n=nh.call(r),i=Math.min(e.length,n.length-1),t):n.slice()},t.invertExtent=function(t){var i=n.indexOf(t);return[e[i-1],e[i]]},t.copy=function(){return zn().domain(e).range(n)},t}function On(t,e){var n=t&&void 0!==t.min,i=t&&void 0!==t.max,r=n?+t.min:0,o=i?+t.max:1;if(e&&e.length){if(!n){var a=e.map(Jh).filter(Qh);r=a.length?Math.min.apply(Math,zu(a)):r}if(!i){var s=e.map(Kh).filter(Qh);o=s.length?Math.max.apply(Math,zu(s)):o}}return[r,o]}function Nn(t){return"number"!=typeof t||isNaN(t)}function An(t){var e=(.5*(Math.floor(t/Math.PI*2)+2)+.25)*Math.PI,n=Math.cos(Math.abs(e-t))*Math.sqrt(2),i=n*Math.cos(t),r=n*Math.sin(t);return{x1:i<0?1:0,y1:r<0?1:0,x2:i>=0?i:i+1,y2:r>=0?r:r+1}}function En(t){return-t/180*Math.PI}function Cn(t){return An(En(t))}function Tn(t){return void 0===t?function(t){return t}:function(e){return t(e)}}function jn(t,e,n){for(var i=Math.abs(e-n)/(t+1),r=[],o=1;o<=t;o++){var a=o*i;r.push(e<n?e+a:e-a)}return r}function Pn(t,e,n){if(1===t.length)return t;for(var i=t.concat([]),r=0;r<t.length;r++){var o=t[r],a=t[r+1];0===r&&o!==n.start()?(i.push.apply(i,zu(jn(e,o,a))),o-=a-o,a=t[r],i.push.apply(i,zu(jn(e,o,a)))):r===t.length-1&&a!==n.end()?(a=o+(o-t[r-1]),i.push.apply(i,zu(jn(e,o,a)))):i.push.apply(i,zu(jn(e,o,a)))}return i.filter(function(t){return t>=n.min()&&t<=n.max()})}function Fn(t){var e=t.distance,n=t.scale,i=t.minorCount,r=void 0===i?0:i,o=t.unitDivider,a=void 0===o?100:o,s=t.formatter,c=void 0===s?void 0:s,u=Nn(a)||Nn(e)?2:Math.max(e/a,2),l=Math.min(1e3,Math.round(u)),h=n.ticks(l);h.length<=1&&(h=n.ticks(l+1));var f=r>0?Pn(h,r,n):h;f.sort(function(t,e){return t-e});var d=f.map(Tn(c));return f.map(function(t,e){return{position:n(t),label:d[e],value:t,isMinor:-1===h.indexOf(t)}})}function Ln(t){var e=t.distance,n=t.scale,i=t.minorCount,r=void 0===i?0:i,o=t.unitDivider,a=void 0===o?100:o,s=t.formatter,c=void 0===s?void 0:s,u=Nn(a)||Nn(e)?2:Math.max(e/a,2),l=Math.min(1e3,Math.round(u)),h=l>10?10:l;n.nice(h);var f=n.ticks(l),d=r>0?Pn(f,r,n):f;d.sort(function(t,e){return t-e});var g=d.map(Tn(c));return d.map(function(t,e){return{position:n(t),label:g[e],value:t,isMinor:-1===f.indexOf(t)}})}function Wn(t){var e=t.count,n=t.minorCount,i=t.scale,r=t.formatter;return i.ticks((e-1)*n+e).map(function(t,e){return{position:i(t),label:r(t),isMinor:e%(n+1)!=0,value:t}})}function Dn(t){var e=t.values,n=t.scale,i=t.formatter;return e.sort(function(t,e){return t-e}).filter(function(t,e,i){return t<=n.max()&&t>=n.min()&&i.indexOf(t)===e}).map(function(t){return{position:n(t),label:i(t),isMinor:!1,value:t}})}function Bn(t,e,n){var i=t.map(function(t){return t.position}),r=e.range();-1===i.indexOf(r[0])?t.splice(0,0,{position:r[0],label:n(e.start()),isMinor:!1,value:e.start()}):t[0]&&t[0].isMinor&&(t[0].isMinor=!1);var o=t[t.length-1];-1===i.indexOf(r[1])?t.push({position:r[1],label:n(e.end()),isMinor:!1,value:e.end()}):o&&o.isMinor&&(o.isMinor=!1)}function Hn(t){var e=t.settings,n=t.scale,i=t.distance,r=t.formatter,o=void 0,a=e.minorTicks&&!Nn(e.minorTicks.count)?Math.min(100,e.minorTicks.count):0;return Array.isArray(e.ticks.values)?o=Dn({values:e.ticks.values.filter(function(t){return!Nn(t)}),scale:n.copy(),formatter:r}):Nn(e.ticks.count)?(o=(e.ticks.tight?Ln:Fn)({distance:i,minorCount:a,unitDivider:e.ticks.distance,scale:n,formatter:r}),e.ticks.forceBounds&&Bn(o,n,r)):o=Wn({count:Math.min(1e3,e.ticks.count),minorCount:a,scale:n.copy(),formatter:r}),o}function In(t){var e=t.scale,n=e.domain(),i=e.data().items,r=e.labels?e.labels():n;return n.map(function(t,n){return{position:e(t)+e.bandwidth()/2,label:""+r[n],data:i?i[n]:void 0}})}function Vn(){return{ticks:{tight:!1,forceBounds:!1,distance:100},minorTicks:{count:3}}}function Un(t,e,n){return"function"==typeof t[n]?t[n](e):t[n]}function qn(t,e){var n={};return tf.forEach(function(i){n[i]=Un(t,e,i)}),n}function Yn(t,e){var n=+t.min,i=+t.max,r=0,o=1;if(e&&e[0]){var a=e.map(function(t){return t.min()}).filter(function(t){return!isNaN(t)}),s=e.map(function(t){return t.max()}).filter(function(t){return!isNaN(t)});if(r=a.length?Math.min.apply(Math,zu(a)):Number.NaN,o=s.length?Math.max.apply(Math,zu(s)):Number.NaN,isNaN(r)||isNaN(o))r=-1,o=1;else if(r===o&&0===r)r=-1,o=1;else if(r===o&&r)r-=Math.abs(.1*r),o+=Math.abs(.1*o);else if(!isNaN(t.expand)){var c=o-r;r-=c*t.expand,o+=c*t.expand}if(Array.isArray(t.include)){var u=t.include.filter(function(t){return!isNaN(t)});r=Math.min.apply(Math,zu(u).concat([r])),o=Math.max.apply(Math,zu(u).concat([o]))}}return{mini:isNaN(n)?r:n,maxi:isNaN(i)?o:i}}function Xn(t,e){t.instance||(t.instance=e.copy(),t.instance.domain([e.start(),e.end()]),t.instance.clamp(!0),t.instance.range(t.invert?[1,0]:[0,1]))}function $n(t,e){function n(t){return Nn(t)?NaN:i(t)}var i=Rn(),r={instance:null,invert:!1},o=void 0;if(n.data=function(){return e},n.invert=function(t){return i.invert(t)},n.rangeRound=function(t){return i.rangeRound(t),n},n.clamp=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return i.clamp(t),n},n.cachedTicks=function(){return o},n.clearTicksCache=function(){return o=void 0,this},n.ticks=function(e){return null!==e&&"object"===(void 0===e?"undefined":xu(e))?(e.settings=e.settings||{},e.settings=vu(!0,Vn(),t,e.settings),e.scale=n,o=Hn(e)):o=i.ticks(e)},n.nice=function(t){return i.nice(t),n},n.tickFormat=function(t,e){return i.tickFormat(t,e)},n.interpolate=function(t){return i.interpolate(t),n},n.domain=function(t){return arguments.length?(i.domain(t),r.instance&&r.instance.domain([n.start(),n.end()]),n):i.domain()},n.range=function(t){return arguments.length?(i.range(t),n):i.range()},n.start=function(){return n.domain()[0]},n.end=function(){return n.domain()[this.domain().length-1]},n.min=function(){return Math.min(this.start(),this.end())},n.max=function(){return Math.max(this.start(),this.end())},n.classify=function(t){for(var e=(n.start()-n.end())/t,i=[n.end()],r=[],o=e/2,a=0;a<t;a++){var s=i[i.length-1]||0,c=s+e,u=n(s+o);i.push.apply(i,[c,c]),r.push.apply(r,[u,u])}return i.pop(),n.domain(i),n.range(r),n},n.copy=function(){var r=$n(t,e);return r.domain(n.domain()),r.range(n.range()),r.clamp(i.clamp()),r},n.norm=function(t){return Xn(r,n),r.instance(t)},n.normInvert=function(t){return Xn(r,n),r.instance.invert(t)},t){var a=qn(t,e?e.fields:[]),s=Yn(a,e?e.fields:[]),c=s.mini,u=s.maxi;n.domain([c,u]),n.range(a.invert?[1,0]:[0,1]),r.invert=a.invert}return n}function Zn(t,e,n){return"function"==typeof t[n]?t[n](e):t[n]}function Gn(t,e){var n={};return ef.forEach(function(i){n[i]=Zn(t,e,i)}),n}function Jn(t,e,n){var i=t.length;if(2===i)return[e,n];var r=[],o=(n-e)/(i-1);r.push(e);for(var a=1;a<i-1;a++)r.push(e+o*a);return r.push(n),r}function Kn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).theme,i=$n(t,e,{}).clamp(!0).interpolate(Ph),r=i;vu(!0,r,i);var o=On(t,e?e.fields:[]),a=Ru(o,2),s=a[0],c=a[1],u=t.domain?t.domain.length:-1,l=n?n.palette("sequential",u>0?u:2):[],h="function"==typeof t.range?t.range(e,{theme:n}):t.range||l;return r.range(t.invert?h.slice().reverse():h.slice()),r.domain(t.domain||Jn(r.range(),s,c)),r}function Qn(t,e,n){var i=t.length;if(2===i)return[e+(n-e)/2];for(var r=[],o=(n-e)/i,a=1;a<i;a++)r.push(e+o*a);return r}function ti(t){for(var e=[],n=0;n<t.length-1;n++)e.push((t[n]+t[n+1])/2);return e}function ei(t,e,n,i){n=t[0],i=t&&t.length>=2?t[t.length-1]:i;var r=Kn().domain([n,i]).range(e);return[n].concat(zu(ti(t)),[i]).map(function(t){return r(t)})}function ni(t,e,n){var i=2===t.length?10:Math.max(1,t.length),r=Rn().domain([e,n]).nice([i]).ticks([i]);if(!t||!t.length)return r;for(var o=Math.max(0,t.length-1);r.length>o;)r[0]-e<=n-r[r.length-1]?r.shift():r.pop();return r}function ii(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],n=De(),i="function"==typeof t.value?t.value:function(t){return t.value},r="function"==typeof t.label?t.label:i,o=e.items||[],a={},s=[],c=[],u=0;u<o.length;u++){var l=i(o[u]);-1===s.indexOf(l)&&(s.push(l),c.push(r(o[u])),a[l]=u)}return n.data=function(){return e},n.labels=function(){return c},n.label=function(t){var e=s.indexOf(t);return c[e]},n.datum=function(t){return o[a[t]]},t.range&&n.range(t.range),t.domain?n.domain(t.domain):n.domain(s),n}function ri(t){return-1!==t.map(function(t){return"dimension"===t.type()?"band":"linear"}).indexOf("linear")?"linear":"band"}function oi(t,e){return e&&e[0]?ri(e):"linear"}function ai(t,e,n){var i=t.data;t.source&&(n.logger.warn("Deprecated: Scale data source configuration"),i={extract:[]},(Array.isArray(t.source)?t.source:[t.source]).forEach(function(t){i.extract.push({field:t})}));var r=ze(i,e,n),o=t.type||oi(t,r.fields),a=void 0;return"color"===o&&(o=r.fields&&r.fields[0]&&"dimension"===r.fields[0].type()?"categorical-color":"sequential-color"),n.scale.has(o)&&((a=(a=n.scale.get(o))(t,r,n)).type=o),a}function si(t,e,n,i){var r=void 0;return"string"==typeof t&&e[t]?r=e[t]:"object"===(void 0===t?"undefined":xu(t))&&"scale"in t&&e[t.scale]&&(r=e[t.scale]),r||ai(t,n,i)}function ci(t,e,n){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=ai(t[r],e,n));return i}function ui(){ui.init.call(this)}function li(){var t=0,e=0,n=0,i=0;n=n||t;var r={move:function(t){this.moveTo(n+t)},moveTo:function(o){var a=Math.max(t,Math.min(e-i,o));n!==a&&(n=a,r.emit("update"))},update:function(o){var a=!1,s=o.min;t=void 0===s?t:s;var c=o.max;e=void 0===c?e:c,void 0!==o.viewSize&&o.viewSize!==i&&(i=o.viewSize,a=!0);var u=Math.max(t,Math.min(e-i,n));n!==u&&(n=u,a=!0),a&&r.emit("update")},getState:function(){return{min:t,max:e,start:n,viewSize:i}}};return af.mixin(r),r}function hi(t,e){var n=t.min||0,i=t.max||0,r=t.viewSize||0,o=e||li();return o.update({min:n,max:i,viewSize:r}),o}function fi(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=hi(t[i],e?e[i]:null));return n}function di(t,e){return e[t]||(e[t]=li()),e[t]}function gi(t,e,n){for(var i=0;i<t.length&&e>t[i];)++i;return t[i]===e&&n&&++i,i}function pi(t,e){for(var n=t.length,i=1;i<n;i+=2)if(t[i-1]<=e&&e<=t[i])return!0;return!1}function yi(){function t(){}var e=[];return t.add=function(t){var n,i=t.min,r=t.max,o=gi(e,i),a=gi(e,r,!0),s=[o,a-o];o%2==0&&s.push(i),a%2==0&&s.push(r);var c=e.join(",");return(n=e).splice.apply(n,s),c!==e.join(",")},t.remove=function(t){var n,i=t.min,r=t.max,o=gi(e,i),a=gi(e,r,!0),s=[o,a-o];o%2==1&&s.push(i),a%2==1&&s.push(r);var c=e.join(",");return(n=e).splice.apply(n,s),c!==e.join(",")},t.set=function(n){var i=e.join(",");return e=[],Array.isArray(n)?n.forEach(t.add):t.add(n),i!==e.join(",")},t.clear=function(){var t=e.length>0;return e=[],t},t.containsValue=function(t){return pi(e,t)},t.containsRange=function(t){var n=t.min,i=t.max,r=gi(e,n,!0),o=gi(e,i);return r===o&&o%2==1},t.toggle=function(e){return t.containsRange(e)?t.remove(e):t.add(e)},t.ranges=function(){for(var t=[],n=1;n<e.length;n+=2)t.push({min:e[n-1],max:e[n]});return t},t}function vi(){function t(){}var e=[];return t.add=function(t){return-1===e.indexOf(t)&&(e.push(t),!0)},t.remove=function(t){var n=e.indexOf(t);return-1!==n&&(e.splice(n,1),!0)},t.contains=function(t){return-1!==e.indexOf(t)},t.values=function(){return e.slice()},t.clear=function(){return e=[]},t}function mi(t){for(var e=t.items,n=t.values,i=t.vc,r={},o=[],a=void 0,s=void 0,c=0,u=e.length;c<u;c++)a=e[c].key,s=e[c].value,n[a]||(n[a]=i()),n[a].add(s)&&(r[a]=r[a]||[],r[a].push(s));for(var l=Object.keys(r),h=0,f=l.length;h<f;h++)a=l[h],o.push({id:a,values:r[a]});return o}function xi(t){for(var e=t.items,n=t.values,i={},r=[],o=void 0,a=void 0,s=0,c=e.length;s<c;s++)o=e[s].key,a=e[s].value,n[o]&&n[o].remove(a)&&(i[o]=i[o]||[],i[o].push(a));for(var u=Object.keys(i),l=0,h=u.length;l<h;l++)o=u[l],r.push({id:o,values:i[o]});return r}function bi(t){for(var e={},n=void 0,i=void 0,r=0,o=t.length;r<o;r++)n=t[r].key,i=t[r].value,e[n]||(e[n]=[]),-1===e[n].indexOf(i)&&e[n].push(i);return e}function wi(t){var e=t.key,n=t.collection,i=t.obj,r=t.fn,o=t.value;n[e]||(n[e]=r()),i[e]=i[e]||[],i[e].push(o),n[e].add(o)}function ki(t){for(var e=t.items,n=t.values,i=t.vc,r={},o={},a=[],s=[],c=bi(e),u=void 0,l=void 0,h=void 0,f=Object.keys(c),d=0,g=f.length;d<g;d++)for(var p=0,y=(h=c[u=f[d]]).length;p<y;p++)l=h[p],n[u]&&n[u].contains(l)?n[u]&&n[u].contains(l)&&(o[u]=o[u]||[],o[u].push(l),n[u].remove(l)):wi({key:u,value:l,collection:n,obj:r,fn:i});for(var v=Object.keys(r),m=0,x=v.length;m<x;m++)u=v[m],a.push({id:u,values:r[u]});for(var b=Object.keys(o),w=0,k=b.length;w<k;w++)u=b[w],s.push({id:u,values:o[u]});return[a,s]}function _i(t,e){for(var n=[],i=Object.keys(t),r=void 0,o=void 0,a=0,s=i.length;a<s;a++)r=i[a],e[r]?(o=t[r].filter(function(t){return-1===e[r].indexOf(t)})).length&&n.push({id:r,values:o}):n.push({id:r,values:t[r]});return n}function Mi(t){for(var e=t.items,n=t.vCollection,i=t.vc,r={},o=bi(e),a=[],s=[],c=void 0,u={},l=Object.keys(n),h=0,f=l.length;h<f;h++)u[c=l[h]]=n[c].values().slice(),delete n[c];for(var d=Object.keys(o),g=0,p=d.length;g<p;g++)o[c=d[g]].forEach(function(t){n[c]&&n[c].contains(t)||wi({key:c,value:t,collection:n,obj:r,fn:i})});return s=_i(u,r),a=_i(r,u),[a,s]}function Si(t,e){if(!Object.keys(e).length)return t;for(var n=t.length,i=Array(n),r=0;r<n;r++)i[r]=t[r].key in e?vu({},t[r],{key:e[t[r].key]}):t[r];return i}function Ri(t,e,n){var i=Si(e,n);return t&&t.length?t.reduce(function(t,e){return e(t)},i):i}function zi(t){return t.replace(/(-[a-z])/g,function(t){return t.toUpperCase().replace("-","")})}function Oi(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}function Ni(t,e,n){var i=n.ranges,r=n.interceptors,o=n.rc,a=n.aliases,s=!1;return Ri(r[e+"Ranges"],t,a).forEach(function(t){var n=t.key;i[n]||(i[n]=o()),s=i[n][e](t.range)||s}),s}function Ai(){function t(){}var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.vc,i=void 0===n?vi:n,r=e.rc,o=void 0===r?yi:r,a=!1,s={},c={},u={},l={addValues:[],removeValues:[],toggleValues:[],setValues:[],addRanges:[],setRanges:[],removeRanges:[],toggleRanges:[]};return t.start=function(){a||(a=!0,t.emit("start"))},t.end=function(){a&&(a=!1,s={},c={},t.emit("end"))},t.isActive=function(){return a},t.clear=function(){var e=t.brushes().filter(function(t){return"value"===t.type&&t.brush.values().length}).map(function(t){return{id:t.id,values:t.brush.values()}}),n=Object.keys(s).length>0||e.length;s={},c={},n&&t.emit("update",[],e)},t.brushes=function(){var t=[];return t=t.concat(Object.keys(s).map(function(t){return{type:"range",id:t,brush:s[t]}})),t=t.concat(Object.keys(c).map(function(t){return{type:"value",id:t,brush:c[t]}}))},t.addValue=function(e,n){t.addValues([{key:e,value:n}])},t.addValues=function(e){var n=Ri(l.addValues,e,u),r=mi({vc:i,values:c,items:n});t.emit("add-values",n),r.length&&(a||(a=!0,t.emit("start")),t.emit("update",r,[]))},t.setValues=function(e){var n=Ri(l.setValues,e,u),r=Mi({items:n,vCollection:c,vc:i});t.emit("set-values",n),(r[0].length>0||r[1].length>0)&&(a||(a=!0,t.emit("start")),t.emit("update",r[0],r[1]))},t.removeValue=function(e,n){t.removeValues([{key:e,value:n}])},t.removeValues=function(e){var n=Ri(l.removeValues,e,u),i=xi({values:c,items:n});t.emit("remove-values",n),i.length&&t.emit("update",[],i)},t.addAndRemoveValues=function(e,n){var r=Ri(l.addValues,e,u),o=Ri(l.removeValues,n,u),s=mi({vc:i,values:c,items:r}),h=xi({values:c,items:o});t.emit("add-values",r),t.emit("remove-values",o),(s.length||h.length)&&(a||(a=!0,t.emit("start")),t.emit("update",s,h))},t.toggleValue=function(e,n){t.toggleValues([{key:e,value:n}])},t.toggleValues=function(e){var n=Ri(l.toggleValues,e,u),r=ki({items:n,values:c,vc:i});t.emit("toggle-values",n),(r[0].length>0||r[1].length>0)&&(a||(a=!0,t.emit("start")),t.emit("update",r[0],r[1]))},t.containsValue=function(t,e){var n=u[t]||t;return!!c[n]&&c[n].contains(e)},t.addRange=function(e,n){t.addRanges([{key:e,range:n}])},t.addRanges=function(e){Ni(e,"add",{ranges:s,rc:o,interceptors:l,aliases:u})&&(a||(a=!0,t.emit("start")),t.emit("update",[],[]))},t.removeRange=function(e,n){t.removeRanges([{key:e,range:n}])},t.removeRanges=function(e){Ni(e,"remove",{ranges:s,rc:o,interceptors:l,aliases:u})&&(a||(a=!0,t.emit("start")),t.emit("update",[],[]))},t.setRange=function(e,n){t.setRanges([{key:e,range:n}])},t.setRanges=function(e){Ni(e,"set",{ranges:s,rc:o,interceptors:l,aliases:u})&&(a||(a=!0,t.emit("start")),t.emit("update",[],[]))},t.toggleRange=function(e,n){t.toggleRanges([{key:e,range:n}])},t.toggleRanges=function(e){Ni(e,"toggle",{ranges:s,rc:o,interceptors:l,aliases:u})&&(a||(a=!0,t.emit("start")),t.emit("update",[],[]))},t.containsRangeValue=function(t,e){var n=u[t]||t;return!!s[n]&&s[n].containsValue(e)},t.containsRange=function(t,e){var n=u[t]||t;return!!s[n]&&s[n].containsRange(e)},t.containsMappedData=function(t,e,n){for(var i=[],r=Object.keys(t),o=void 0,a=void 0,l=void 0,h=void 0,f=0,d=r.length;f<d;f++){if("value"===(o=r[f]))a=t,i[f]={key:"",i:f,bool:!1};else{if("source"===o)continue;a=t[o],i[f]={key:o,i:f,bool:!1}}void 0!==(l=a.source&&a.source.field)&&(void 0!==a.source.key&&(l=a.source.key+"/"+l),l in u&&(l=u[l]),h=a.value,s[l]?i[f].bool=Array.isArray(h)?s[l].containsRange({min:h[0],max:h[1]}):s[l].containsValue(h):c[l]&&c[l].contains(h)&&(i[f].bool=!0))}return e?(i=i.filter(function(t){return-1!==e.indexOf(t.key)}),"and"===n?!!i.length&&!i.some(function(t){return!1===t.bool}):"xor"===n?!!i.length&&i.some(function(t){return t.bool})&&i.some(function(t){return!1===t.bool}):i.some(function(t){return t.bool})):i.some(function(t){return t.bool})},t.intercept=function(t,e){var n=zi(t);l[n]&&l[n].push(e)},t.removeInterceptor=function(t,e){var n=zi(t);if(l[n]){var i=l[n].indexOf(e);-1!==i&&l[n].splice(i,1)}},t.removeAllInterceptors=function(e){var n=[];if(e){var i=zi(e);l[i]&&l[i].length&&n.push({name:e,handlers:l[i]})}else Object.keys(l).forEach(function(t){l[t].length&&n.push({name:Oi(t),handlers:l[t]})});n.forEach(function(e){e.handlers.slice().forEach(function(n){return t.removeInterceptor(e.name,n)})})},t.addKeyAlias=function(t,e){u[t]=e},t.removeKeyAlias=function(t){delete u[t]},af.mixin(t),t}function Ei(t){return cf.concat(sf.get(t)||[])}function Ci(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(t,e){return Array.isArray(e.children)?t.concat(Ci(e.children)):(t.push(e),t)},[])}function Ti(t,e){var n=e.context,i=e.data,r=e.style,o=t.chart.brush(n),a=i,s=r.active||{},c=r.inactive||{},u=[];Object.keys(s).forEach(function(t){u.push(t)}),Object.keys(c).forEach(function(t){-1===u.indexOf(t)&&u.push(t)});var l=[],h=!1,f=function(){for(var e=Ci(t.nodes),n=e.length,i=void 0,r=!1,f=0;f<n;f++){(function(t){if(!(i=e[t].data))return"continue";e[t].__style||(e[t].__style={},u.forEach(function(n){e[t].__style[n]=e[t][n]}));var n=o.containsMappedData(i,a),f=l.indexOf(e[t]),d=!1;n&&-1===f?(l.push(e[t]),d=!0):n||-1===f||(l.splice(f,1),d=!0),(d||h)&&(u.forEach(function(i){n&&i in s?e[t][i]=s[i]:!n&&i in c?e[t][i]=c[i]:(e[t].__style||(e[t].__style=e[t].__style||{},u.forEach(function(n){e[t].__style[n]=e[t][n]})),e[t][i]=e[t].__style[i])}),r=!0)})(f)}return h=!1,r},d=function(){for(var e=Ci(t.nodes),n=e.length,i=0;i<n;i++)!function(t){e[t].__style=e[t].__style||{},u.forEach(function(n){e[t].__style[n]=e[t][n]})}(i);h=!0,l.length=0,t.renderer.render(t.nodes)},g=function(){for(var e=Ci(t.nodes),n=e.length,i=0;i<n;i++)!function(t){e[t].__style&&(Object.keys(e[t].__style).forEach(function(n){e[t][n]=e[t].__style[n]}),e[t].__style=void 0)}(i);l.length=0,t.renderer.render(t.nodes)},p=function(){f()&&t.renderer.render(t.nodes)};return o.on("start",d),o.on("end",g),o.on("update",p),{isActive:function(){return o.isActive()},update:function(){l.length=0,h=!0,f()},cleanUp:function(){o.removeListener("start",d),o.removeListener("end",g),o.removeListener("update",p)}}}function ji(t){var e=t.dataPoints,n=t.action,i=t.chart,r=t.trigger;if(r){var o=r.data||[""],a={items:[],actionFn:"toggleRanges"},s={items:[],actionFn:"toggleValues"};-1!==["add","remove","set","toggle"].indexOf(n)&&(a.actionFn=n+"Ranges",s.actionFn=n+"Values");for(var c=0;c<e.length;c++){(function(t){var n=e[t];if(!n)return"continue";o.forEach(function(t){var e=n&&!t?n:n[t];if(e){var i={key:e.source.field};void 0!==e.source.key&&(i.key=e.source.key+"/"+e.source.field),Array.isArray(e.value)?(i.range={min:e.value[0],max:e.value[1]},a.items.push(i)):(i.value=e.value,s.items.push(i))}})})(c)}r.contexts.forEach(function(t){a.items.length?i.brush(t)[a.actionFn](a.items):i.brush(t)[s.actionFn](s.items)})}}function Pi(t){for(var e=t.nodes,n=t.action,i=t.chart,r=t.trigger,o=[],a=0;a<e.length;a++){var s=e[a].data;null!==s&&o.push(s)}ji({dataPoints:o,action:n,chart:i,trigger:r})}function Fi(t){var e=t.collisions,n=t.t,i=t.config,r=t.action,o=[],a=!1;return e.length>0&&(o=e,a=!0,"stop"===n.propagation&&(o=[e[e.length-1]])),Pi({nodes:o.map(function(t){return t.node}),action:r,chart:i.chart,data:i.data,trigger:n}),a}function Li(t,e){return 1!==t.changedTouches.length?null:{x:t.changedTouches[0].clientX-e.left,y:t.changedTouches[0].clientY-e.top}}function Wi(t,e){return{x:t.clientX-e.left,y:t.clientY-e.top}}function Di(t,e,n){var i=n.element().getBoundingClientRect(),r=W(t)?Li(t,i):Wi(t,i);return null===r||r.x<0||r.y<0||r.x>i.width||r.y>i.height?[]:(e.touchRadius>0&&W(t)&&(r={cx:r.x,cy:r.y,r:e.touchRadius}),n.itemsAt(r))}function Bi(t,e,n){return t?"function"==typeof t?t(e):t:n}function Hi(t){var e=t.e,n=t.t,i=t.config;return Fi({collisions:Di(e,n,i.renderer),t:n,config:i,action:Bi(n.action,e,"toggle")})}function Ii(t){var e=t.e,n=t.t,i=t.config;return Fi({collisions:Di(e,n,i.renderer),t:n,config:i,action:Bi(n.action,e,"set")})}function Vi(t,e,n){var i=e.require,r=void 0===i?[]:i,o=e.mediator||{},a=n.settings,s=n.formatter,c=n.scale,u=n.data,l=n.renderer,h=n.chart,f=n.dockConfig,d=n.mediator,g=n.instance,p=n.style,y=n.update;Object.defineProperty(t,"settings",{get:a}),Object.defineProperty(t,"data",{get:u}),Object.defineProperty(t,"formatter",{get:s}),Object.defineProperty(t,"scale",{get:c}),Object.defineProperty(t,"mediator",{get:d}),Object.defineProperty(t,"style",{get:p}),Object.keys(e).forEach(function(n){uf(n)||("function"==typeof e[n]?t[n]=e[n].bind(t):t[n]=e[n])}),r.forEach(function(e){"renderer"===e?Object.defineProperty(t,"renderer",{get:l}):"chart"===e?Object.defineProperty(t,"chart",{get:h}):"dockConfig"===e?Object.defineProperty(t,"dockConfig",{get:f}):"instance"===e?Object.defineProperty(t,"instance",{get:g}):"update"===e&&y&&Object.defineProperty(t,"update",{get:y})}),Object.keys(o).forEach(function(e){t.mediator.on(e,o[e].bind(t))})}function Ui(t,e){return t.displayOrder=e.displayOrder,t.dock=e.dock,t.prioOrder=e.prioOrder,t.minimumLayoutMode=e.minimumLayoutMode,t.show=e.show,t}function qi(t,e,n){Object.keys(n.on||{}).forEach(function(i){t.eventListeners=t.eventListeners||[];var r=n.on[i].bind(t);t.eventListeners.push({event:i,listener:r}),e.on(i,r)}),t.emit=function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return e.emit.apply(e,[t].concat(i))}}function Yi(t){function e(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(){for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];var a="function"==typeof t[e],s="function"==typeof h[e],c=void 0;if(a){var u;c=(u=t[e]).call.apply(u,[M].concat(r))}if("function"==typeof h[e]){var l;c=(l=h[e]).call.apply(l,[S].concat(r))}return a||s||(c=n.call.apply(n,[M].concat(r))),_.forEach(function(t){if(t[e]){var n;(n=t[e]).call.apply(n,[S].concat(r))}}),c}}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.defaultSettings,r=void 0===i?{}:i,o=n.chart,a=n.container,s=n.mediator,c=n.registries,u=n.theme,l=n.renderer,h=n.settings||{},f=af.mixin({}),d=vu(!0,{},r,h),g=[],p=void 0,y=void 0,v=void 0,m=void 0,x=void 0,b={nodes:[],chart:o,config:d.brush||{},renderer:null},w={tap:[],over:[]},k=[],_=Ei(d.type),M={},S=vu({},h,_.filter(function(t){return!uf(t)})),R=e("preferredSize",function(){return 0}),z=e("resize",function(t){return t.inner}),O=e("created"),N=e("beforeMount"),A=e("mounted"),E=e("beforeUpdate"),C=e("updated"),T=e("beforeRender"),j=e("beforeDestroy"),P=e("destroyed"),F=t.render,L=function(){d.brush&&(d.brush.consume||[]).forEach(function(t){t.context&&t.style&&k.push(Ti(b,t))})},W=function(){d.brush&&(d.brush.trigger||[]).forEach(function(t){"over"===t.on?w.over.push(t):w.tap.push(t)})};Object.defineProperty(b,"data",{get:function(){return g}});var D=d.renderer||t.renderer,B=D?l||c.renderer(D)():l||c.renderer()();b.renderer=B;var H={requiredSize:function(t,e){return R({inner:t,outer:e,dock:H.dock})}};Ui(H,d);var I=function(){};I.dockConfig=H,I.set=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.settings&&(d=vu(!0,{},r,t.settings),Ui(H,d)),d.scale&&(p=o.scale(d.scale)),g=d.data?ze(d.data,{dataset:o.dataset,collection:o.dataCollection},{logger:o.logger()},o.dataCollection):p?p.data():[],"string"==typeof d.formatter?y=o.formatter(d.formatter):"object"===xu(d.formatter)?y=o.formatter(d.formatter):p&&p.data().fields&&(y=p.data().fields[0].formatter()),x=u.style(d.style||{})},I.resize=function(t,e){var n=z({inner:t,outer:e});n?(B.size(n),m=n):(B.size(t),m=t),S.rect=t},I.getRect=function(){return S.rect};var V=function(){var t=B.renderArgs?B.renderArgs.slice(0):[];return t.push({data:g}),t};I.beforeMount=N,I.beforeRender=function(){T({size:m})},I.render=function(){var t=b.nodes=F.call.apply(F,[M].concat(zu(V())));B.render(t)},I.hide=function(){I.unmount(),B.size({x:0,y:0,width:0,height:0}),B.clear()},I.beforeUpdate=function(){E({settings:d,data:g})},I.update=function(){var t=b.nodes=F.call.apply(F,[M].concat(zu(V())));k.forEach(function(t){return t.cleanUp()}),k.length=0,w.tap=[],w.over=[],d.brush&&(L(),W()),k.forEach(function(t){t.isActive()&&t.update()}),B.render(t)},I.updated=C,I.destroy=function(){I.unmount(),j(v),B.destroy(),P(),v=null};var U=function(t){b.nodes=t,k.forEach(function(t){t.isActive()&&t.update()}),B.render(t)};return Vi(M,t,{settings:function(){return d},data:function(){return g},scale:function(){return p},formatter:function(){return y},renderer:function(){return B},chart:function(){return o},dockConfig:function(){return H},mediator:function(){return s},instance:function(){return S},style:function(){return x},update:function(){return U}}),Vi(S,h,{settings:function(){return d},data:function(){return g},scale:function(){return p},formatter:function(){return y},renderer:function(){return B},chart:function(){return o},dockConfig:function(){return H},mediator:function(){return s},style:function(){return x}}),I.getBrushedShapes=function(t,e,n){var i=[];if(d.brush&&d.brush.trigger){var r=o.brush(t),a=B.findShapes("*");d.brush.trigger.forEach(function(t){a.forEach(function(o){var a=o.data;a&&r.containsMappedData(a,n||t.data,e)&&i.push(o)})})}return i},I.findShapes=function(t){for(var e=B.findShapes(t),n=0,i=e.length;n<i;n++)e[n].key=d.key;return e},I.shapesAt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=B.itemsAt(t),i=void 0;i=e&&"stop"===e.propagation&&n.length>0?[n.pop().node]:n.map(function(t){return t.node});for(var r=0,o=i.length;r<o;r++)i[r].key=d.key;return i},I.brushFromShapes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.contexts=Array.isArray(e.contexts)?e.contexts:[],Pi({nodes:t,action:e.action||"toggle",trigger:e,chart:o,data:b.data})},I.mount=function(){v=B.element&&B.element()?v:B.appendTo(a),d.brush&&(L(),W()),qi(S,f,h),qi(M,f,t)},I.mounted=function(){return A(v)},I.unmount=function(){[S,M].forEach(function(t){(t.eventListeners||[]).forEach(function(t){var e=t.event,n=t.listener;f.removeListener(e,n)})}),w.tap=[],w.over=[],k.forEach(function(t){t.cleanUp()}),k.length=0},I.onBrushTap=function(t){w.tap.forEach(function(e){Hi({e:t,t:e,config:b})&&"stop"===e.globalPropagation&&o.toggleBrushing(!0)})},I.onBrushOver=function(t){w.over.forEach(function(e){Ii({e:t,t:e,config:b})&&"stop"===e.globalPropagation&&o.toggleBrushing(!0)})},I.def=M,I.ctx=S,I.renderer=function(){return B},I.set({settings:h}),O(),I}function Xi(){var t={};return af.mixin(t),t}function $i(t){return t.x1===t.x2&&t.y1===t.y2}function Zi(t){return t.width<=0||t.height<=0}function Gi(t){return t.r<=0}function Ji(t){return t.edges.length<=2}function Ki(t,e,n){var i=vu({},e,t),r={},o=n.slice();return Object.keys(t).forEach(function(e){if(e!==ff&&!hf.test(e)){r[e]=t[e];var a=r[e];if(hf.test(a)&&a in i){if(-1!==n.indexOf(a))throw new Error('Cyclical reference for "'+a+'"');o.push(a),"object"===(void 0===(a=i[a])?"undefined":xu(a))?(a[ff]&&(a=vu({},i[a[ff]],a)),r[e]=Ki(a,i,o)):r[e]=a}}}),r}function Qi(t,e){return Ki(t,e,[])}function tr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={};(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach(function(t){e[t.key]={colors:t.colors,sizes:t.colors.map(function(t){return t.length})}});var n=function(t,n){var i=e[t];if(!i)return[];for(var r=i.sizes,o=0;o<r.length;o++)if(n<=r[o])return i.colors[o];return i.colors[r.length-1]};return{palette:function(t,e){return n(t,e)},style:function(e){return Qi(e,t)}}}function er(t,e,n){var i=e.left-n.left,r=e.top-n.top,o=H(t),a=vu(!0,{},t);switch(o){case"circle":a.cx+=i,a.cy+=r;break;case"polygon":for(var s=0,c=a.vertices.length;s<c;s++){var u=a.vertices[s];u.x+=i,u.y+=r}break;case"line":a.x1+=i,a.y1+=r,a.x2+=i,a.y2+=r;break;case"point":case"rect":a.x+=i,a.y+=r}return a}function nr(e,n){function i(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(){for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];var a=void 0;if("function"==typeof e[t]){var s;a=(s=e[t]).call.apply(s,[v].concat(r))}else a=n.call.apply(n,[v].concat(r));return p.forEach(function(e){if(e[t]){var n;(n=e[t]).call.apply(n,[v].concat(r))}}),a}}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e={},n=t.filter(function(t){return!!t.key}).map(function(t){return t.key});M.forEach(function(t){t.key&&-1!==n.indexOf(t.key)?e[t.key]=t:t.destroy()}),M=t.map(function(t){var n=t.key&&e[t.key]?e[t.key]:f.interaction(t.type)(v,m,o);return n.set(t),n})}var o=e.element,a=e.data,s=void 0===a?[]:a,c=e.settings,u=void 0===c?{}:c,l=e.on,h=void 0===l?{}:l,f=n.registries,d=n.logger,g=tr(n.style,n.palettes),p=t(),y=[],v=vu({},e,p.filter(function(t){return!df(t)})),m=Xi(),x=[],b=[],w=null,k=null,_=null,M=[],S=function(){},R=function(){},z={},O=!1,N=function(t,e){return{instance:Yi(f.component(t.type),{settings:t,chart:v,mediator:m,registries:f,theme:g,container:e}),settings:vu(!0,{},t),key:t.key,hasKey:void 0!==t.key}},A=function(t){for(var e=0;e<x.length;e++)if(x[e].instance===t)return x[e];return null},E=function(t){for(var e=0;e<x.length;e++){var n=x[e];if(n.hasKey&&n.key===t)return e}return-1},C=function(t){var e=F(u.dockLayout);t.forEach(function(t){e.addComponent(t.instance,t.key)});var n=e.layout(o),i=n.visible,r=n.hidden;return{visible:i.map(function(t){return A(t)}),hidden:r.map(function(t){return A(t)})}},T=function(t,e){var n=t.instance.renderer().element();if(!isNaN(e)&&n&&o&&o.childNodes){var i=o.childNodes,r=Math.min(i.length-1,Math.max(e,0)),a=i[r];o.insertBefore&&void 0!==a&&o.insertBefore(n,i[r])}},j=i("created"),P=i("beforeMount"),W=i("mounted"),B=i("beforeUpdate"),H=i("updated"),I=i("beforeRender"),U=i("beforeDestroy"),q=i("destroyed"),Y=function(t,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).partialData,i=e.formatters,r=void 0===i?{}:i,o=e.scales,a=void 0===o?{}:o,s=e.scroll,c=void 0===s?{}:s;S=V(t,{logger:d,types:f.data}),n||Object.keys(z).forEach(function(t){return z[t].clear()}),R=Oe(e.collections,{dataset:S},{logger:d}),w=ci(a,{dataset:S,collection:R},{scale:f.scale,theme:g,logger:d}),k=Ee(r,{dataset:S,collection:R},{formatter:f.formatter,theme:g,logger:d}),_=fi(c,_)},X=function(){var t=u.components,e=void 0===t?[]:t;I(),Y(s,u),x=e.map(function(t){return N(t,o)});var n=C(x),i=n.visible,r=n.hidden;b=i,r.forEach(function(t){t.instance.hide(),t.visible=!1}),i.forEach(function(t){return t.instance.beforeMount()}),i.forEach(function(t){return t.instance.mount()}),i.forEach(function(t){return t.instance.beforeRender()}),i.forEach(function(t){return t.instance.render()}),i.forEach(function(t){return t.instance.mounted()}),i.forEach(function(t){t.visible=!0})},$=function(){y.forEach(function(t){var e=t.key,n=t.listener;return o.removeEventListener(e,n)}),r()};return v.update=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.partialData;t.data&&(s=t.data),t.settings&&(u=t.settings,r(t.settings.interactions)),B(),Y(s,u,{partialData:e});for(var n=u,i=n.formatters,a=n.scales,c=n.components,l=void 0===c?[]:c,h=x.length-1;h>=0;h--)!function(t){var e=x[t];l.some(function(t){return e.hasKey&&e.key===t.key})||(x.splice(t,1),e.instance.destroy())}(h);(x=l.map(function(t){var e=E(t.key);return-1===e?N(t,o):(x[e].updateWith={formatters:i,scales:a,data:s,settings:t},x[e])})).forEach(function(t){t.updateWith&&t.instance.set(t.updateWith)}),x.forEach(function(t){t.updateWith&&t.instance.beforeUpdate()});var f=[],d=[];if(e)x.forEach(function(t){t.updateWith&&t.visible&&f.push(t)});else{var g=C(x),p=g.visible,y=g.hidden;b=p,p.forEach(function(t){t.updateWith&&t.visible?f.push(t):d.push(t)}),y.forEach(function(t){t.instance.hide(),t.visible=!1,delete t.updateWith})}d.forEach(function(t){return t.instance.beforeMount()}),d.forEach(function(t){return t.instance.mount()}),d.forEach(function(t){return t.instance.beforeRender()}),f.forEach(function(t){return t.instance.beforeRender()}),d.forEach(function(t){return t.instance.render()}),f.forEach(function(t){return t.instance.update()}),b.forEach(function(t,e){return T(t,e)}),d.forEach(function(t){return t.instance.mounted()}),f.forEach(function(t){return t.instance.updated()}),b.forEach(function(t){delete t.updateWith,t.visible=!0}),H()},v.destroy=function(){U(),x.forEach(function(t){return t.instance.destroy()}),x=[],$(),delete v.update,delete v.destroy,q()},v.getAffectedShapes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"and",n=arguments[2],i=arguments[3],r=[];return x.filter(function(t){return void 0===i||null===i||t.key===i}).forEach(function(i){r.push.apply(r,zu(i.instance.getBrushedShapes(t,e,n)))}),r},v.findShapes=function(t){var e=[];return b.forEach(function(n){e.push.apply(e,zu(n.instance.findShapes(t)))}),e},v.componentsFromPoint=function(t){var e=o.getBoundingClientRect(),n={x:t.x-e.left,y:t.y-e.top},i=[];return b.forEach(function(t){var e=t.instance.getRect();lf.testRectPoint(e,n)&&i.push(t.instance.ctx)}),i},v.shapesAt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],i=o.getBoundingClientRect(),r=b;if(Array.isArray(e.components)&&e.components.length>0){var a=e.components.map(function(t){return t.key});r=b.filter(function(t){return-1!==a.indexOf(t.key)}).map(function(t){return{instance:t.instance,opts:e.components[a.indexOf(t.key)]}})}for(var s=r.length-1;s>=0;s--){var c=r[s],u=er(t,i,c.instance.renderer().element().getBoundingClientRect()),l=c.instance.shapesAt(u,c.opts),h=l.length>0&&"stop"===e.propagation;if(n.push.apply(n,zu(l)),n.length>0&&h)return n}return n},v.brushFromShapes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{components:[]},n=e.components.map(function(t){return t.key});b.forEach(function(i){var r=n.indexOf(i.key);if(-1!==r){for(var o=[],a=0,s=t.length;a<s;a++){var c=t[a];c.key===i.key&&o.push(c)}i.instance.brushFromShapes(o,e.components[r])}})},v.scroll=function(){return di(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",_)},v.dataset=function(t){return S(t)},v.dataCollection=function(t){return R(t)},v.scales=function(){return w},v.formatters=function(){return k},v.brush=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return z[t]||(z[t]=Ai()),z[t]},v.scale=function(t){return si(t,w,{dataset:S,collection:R},{scale:f.scale,theme:g,logger:d})},v.formatter=function(t){return Ce(t,k,{dataset:S,collection:R},{formatter:f.formatter,theme:g,logger:d})},v.toggleBrushing=function(t){O=void 0!==t?t:!O},v.component=function(t){var e=E(t);if(-1!==e)return x[e].instance.ctx},v.logger=function(){return d},Object.defineProperty(v,"interactions",{get:function(){return{instances:M,on:function(){M.forEach(function(t){return t.on()})},off:function(){M.forEach(function(t){return t.off()})}}}}),j(),o&&(P(),function(){o.innerHTML="",X(),Object.keys(h).forEach(function(t){var e=h[t].bind(v);o.addEventListener(t,e),y.push({key:t,listener:e})});var t={},e=function(e){e.touches?(t.x=e.touches[0].clientX,t.y=e.touches[0].clientY,t.multiTouch=e.touches.length>1):(t.x=e.clientX,t.y=e.clientY,t.multiTouch=!1),t.time=Date.now()},n=function(e){if("touchend"===e.type&&e.preventDefault(),D(e,t))for(var n=b.length-1;n>=0;n--)if(b[n].instance.onBrushTap(e),O){O=!1;break}},i=[];i.push({key:"mousedown",listener:e}),i.push({key:"mouseup",listener:n}),L(o)&&(i.push({key:"touchstart",listener:e}),i.push({key:"touchend",listener:n})),i.push({key:"mousemove",listener:function(t){for(var e=b.length-1;e>=0;e--)if(b[e].instance.onBrushOver(t),O){O=!1;break}}}),i.forEach(function(t){o.addEventListener(t.key,t.listener),y.push(t)}),r(u.interactions)}(),W(o),v.element=o),v}function ir(t,e){"/"===t.charAt(0)&&(t=t.substring(1));for(var n=t.split("/"),i=void 0,r=e,o=0;o<n.length;o++){if("*"===n[o]&&Array.isArray(r)){var a=[];i=n.slice(o+1).join("/");for(var s=0;s<r.length;s++)a.push.apply(a,zu(ir(i,r[s])));return a}if(!n[o]&&Array.isArray(r)){var c=new Array(r.length);i=n.slice(o+1).join("/");for(var u=0;u<r.length;u++)c[u]=ir(i,r[u]);return c}n[o]in r&&(r=r[n[o]])}return r}function rr(t,e){var n=e.cache;if("number"==typeof t)return n.fields[t];for(var i=0;i<n.fields.length;i++)if(n.fields[i].title()===t)return n.fields[i];return null}function or(t,e,n,i){var r={},o=i.field||(void 0!==t.field?e.field(t.field):null);return Object.keys(n).forEach(function(t){var i=n[t],a=r[t]={};-1!==["number","string","boolean"].indexOf(void 0===i?"undefined":xu(i))?(a.type="primitive",a.value=i):"function"==typeof i?(a.type="function",a.value=i,a.field=o):"object"===(void 0===i?"undefined":xu(i))&&(void 0!==i.field?(a.type="field",a.field=e.field(i.field),a.value=a.field.value):o&&(a.value=o.value,a.field=o),void 0!==i.value&&(a.value=i.value),"function"==typeof i.reduce?a.reduce=i.reduce:i.reduce?a.reduce=mf[i.reduce]:a.field&&a.field.reduce&&(a.reduce="string"==typeof a.field.reduce?mf[a.field.reduce]:a.field.reduce))}),r}function ar(t,e){var n=or(t,e,{main:{value:t.value,reduce:t.reduce}},{}).main;return{props:or(t,e,t.props||{},n),main:n}}function sr(t,e,n){var i=n.key,r={value:"function"==typeof t.value?t.value(e):void 0!==t.value?t.value:e};return t.field&&(r.source={key:i,field:t.field.key()}),r}function cr(t,e){var n=[];return(Array.isArray(t)?t:[t]).forEach(function(t){if(void 0!==t.field){var i=e.field(t.field),r=e.key();if(!i)throw Error("Field '"+t.field+"' not found");var o=ar(t,e),a=o.props,s=o.main,c=Object.keys(a),u=!!t.trackBy,l="function"==typeof t.trackBy?t.trackBy:null,h={},f=[],d=void 0,g=i.items().map(function(e,n){var i=e,o=sr(s,i,{key:r});if(c.forEach(function(t){var e=a[t],s=e.field?e.field.items()[n]:i;o[t]=sr(e,s,{key:r})}),u){d=l?l(e):e[t.trackBy];var g=h[d];g||(g=h[d]={items:[],id:d},f.push(g)),g.items.push(o)}return o});u?n.push.apply(n,zu(f.map(function(t){var e=t.items.map(function(t){return t.value}),n=s.reduce,i={value:n?n(e):e,source:t.items[0].source};return c.forEach(function(e){var n=t.items.map(function(t){return t[e].value}),r=a[e].reduce;i[e]={value:r?r(n):n},t.items[0][e].source&&(i[e].source=t.items[0][e].source)}),i}))):n.push.apply(n,zu(g))}}),n}function ur(t,e){var n=e.cache;if(t){var i=t[0],r=t.slice(1);i.forEach(function(t,e){var o=ir("//"+e,r),a=xf.numeric(o),s=a.length>0,c=s?"measure":"dimension",u=s?Math.min.apply(Math,zu(a)):NaN,l=s?Math.max.apply(Math,zu(a)):NaN;n.fields.push(Se({title:i[e],values:o,min:u,max:l,type:c,value:function(t){return t}}))})}}function lr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=t.data,i={fields:[]},r={key:function(){return e},raw:function(){return n},field:function(t){return rr(t,{cache:i,matrix:n})},fields:function(){return i.fields.slice()},extract:function(t){return cr(t,r,i)},hierarchy:function(){return null}};return ur(n,{cache:i}),r}function hr(t){function e(){return e.settings=t||{style:{}},e}return e.style=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return vu(t,n[e]||{})},e.horizontalLine=function(t,n,i,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return e.style({type:"line",y1:n,x1:t-i/2,y2:n,x2:t+i/2},r,o)},e.verticalLine=function(t,n,i,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return e.style({type:"line",y1:n,x1:t,y2:i,x2:t},r,o)},e.whisker=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{whisker:{}},r=i.whisker.width||1;return e.style({type:"line",y1:n,x1:t-r/2,cx:t,cy:n,r:r/2,y2:n,x2:t+r/2},"whisker",i)},e.openwhisker=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{whisker:{}},r=i.whisker.width||1;return e.whisker(t-r/2,n,i)},e.closewhisker=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{whisker:{}},r=i.whisker.width||1;return e.whisker(t+r/2,n,i)},e.box=function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{box:{}},o=r.box.width||1;return e.style({type:"rect",x:t-o/2,y:n,height:i,width:o},"box",r)},e()}function fr(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(_f,[null].concat(e)))}function dr(t){var e=void 0===t?"undefined":xu(t);return"object"!==e&&"function"!==e&&"undefined"!==e}function gr(t,e,n){var i=vu({},t),r=vu({},e);return Object.keys(i).forEach(function(t){r[t]={};var o=i[t],a=void 0===o?"undefined":xu(o);if("function"==typeof o)r[t].fn=o;else if(dr(o)){var s=e[t];"string"==typeof s&&Sf.test(s)&&(s=Mf[s]);var c=void 0===s?"undefined":xu(s);r[t]="undefined"===c?o:c===a?o:s}else o&&"object"===(void 0===o?"undefined":xu(o))&&("function"==typeof o.fn&&(r[t].fn=o.fn),void 0!==o.scale&&(r[t].scale=n.scale(o.scale)),"string"==typeof o.ref&&(r[t].ref=o.ref))}),Object.keys(e).forEach(function(t){if(!(t in i)){var n=e[t];"string"===(void 0===n?"undefined":xu(n))&&Sf.test(n)?r[t]=Mf[n]:r[t]=n}}),r}function pr(t,e,n){for(var i={},r=Object.keys(e),o=r.length,a=t,s=0;s<o;s++){var c=r[s],u=e[c],l=void 0!==u,h=l&&"string"==typeof u.ref,f=l&&c in t,d=h?t[u.ref]:f?t[c]:a;if(dr(u))i[c]=u;else if(l&&u.fn){var g={data:t};u.scale&&(g.scale=u.scale);var p=n?n.indexOf(t):-1;i[c]=u.fn.call(g,h&&t?t[u.ref]:void 0,p,n)}else l&&u.scale&&d?(i[c]=u.scale(d.value),u.scale.bandwidth&&(i[c]+=u.scale.bandwidth()/2)):i[c]=h?d.value:u}return i}function yr(t,e,n){var i={};return Object.keys(e).forEach(function(r){i[r]=gr(t[r],e[r],n)}),i}function vr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=void 0,r=void 0,o=void 0,a=void 0,s=void 0,c=void 0,u=void 0,l=void 0,h=void 0,f=function t(){return t};return f.updateSettings=function(e){n=e.settings,h=gr({major:n.major},{major:.5},t),i=h.major.scale,r=n.minor?t.scale(n.minor):null,o=0,a=null,s=fr(),c=hr(n)},f.onData=function(o,s){if(u=[],l=yr(n,e,t),i&&i.pxScale){var c="horizontal"===n.orientation?s.height:s.width;i=i.pxScale(c)}if(r&&r.pxScale){var f="horizontal"===n.orientation?s.width:s.height;r=r.pxScale(f)}var d=n.major?n.major.ref||"":"",g="object"===(void 0===d?"undefined":xu(d))?n.major.ref.start:null,p="object"===(void 0===d?"undefined":xu(d))?n.major.ref.end:null;if(i&&!i.bandwidth&&"string"==typeof d){var y=o.items.map(function(t){return""===d?t.value:t[d].value});y.sort(function(t,e){return t-e});for(var v=y[y.length-1],m=0;m<y.length;m++)y[m]&&y[m-1]&&(null===v||v>y[m]-y[m-1])&&(v=y[m]-y[m-1]);a=v}o.items.forEach(function(t,e,n){var o={};Object.keys(l).forEach(function(e){o[e]=pr(t,l[e],n)});var a={style:o,majorStart:i&&t[g]?i(t[g].value):null,majorEnd:i&&t[p]?i(t[p].value):null,min:r&&"min"in t?r(t.min.value):null,max:r&&"max"in t?r(t.max.value):null,start:r&&"start"in t?r(t.start.value):null,end:r&&"end"in t?r(t.end.value):null,med:r&&"med"in t?r(t.med.value):null,data:t};null!==a.majorStart?a.major=(a.majorStart+a.majorEnd)/2:a.major=pr(t,h,n).major,u.push(a)})},f.items=function(){return u},f.bandwidth=function(){return o},f.doodle=function(){return c},f.blueprint=function(){return s},f.render=function(t,e){if(null!==a){0===a&&(a=1e-9);var r=i(i.domain()[0])-i(i.domain()[0]+a);o=Math.abs(r)}else o=i&&i.bandwidth?i.bandwidth():1;s.reset(),s.width=t.width,s.height=t.height,s.x=t.x,s.y=t.y,s.flipXY="horizontal"===n.orientation,s.crisp=!0;var l=[];return u.forEach(function(t){var n=e({item:t,blueprint:s,doodle:c});n.forEach(function(e){e.data=t.data,e.collider={type:null}}),l.push.apply(l,zu(n))}),0===l.length?l:u.map(function(t){for(var e={type:"container",data:t.data,collider:{type:"bounds"},children:[]},n=0;n<l.length;n++){var i=l[n];i.data===e.data&&(e.children.push(i),l.splice(n,1),n--)}return e})},f()}function mr(t,e,n){return Math.max(t,Math.min(e,n))}function xr(t,e,n){var i=t[e];i&&i.scale&&i.scale.pxScale?i.scale=i.scale.pxScale(n):i&&i.pxScale&&(t[e]=i.pxScale(n))}function br(t,e){return t.pxScale?t.pxScale(e):t}function wr(t,e){Object.keys(Of).forEach(function(n){var i=e[n];if(void 0!==i){var r=Of[n];t[r]=i}})}function kr(t,e,n,i){var r=n/2,o=t-i/2,a=e-i/2,s=t-r,c=e-r;return[{x:o,y:a},{x:o,y:c},{x:o+i,y:c},{x:o+i,y:a},{x:s+n,y:a},{x:s+n,y:a+i},{x:o+i,y:a+i},{x:o+i,y:c+n},{x:o,y:c+n},{x:o,y:a+i},{x:s,y:a+i},{x:s,y:a}]}function _r(t){var e=t.x,n=t.y,i=t.size,r=i/2;return{type:"rect",x:e-r,y:n-r,width:i,height:i}}function Mr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(e).forEach(function(n){void 0!==Of[n]&&"transform"!==n&&(t[n]=e[n])})}function Sr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Af.get(t.type);if(e){var n=e(t);return n.collider||(n.collider=_r(t)),Mr(n,t),void 0!==t.data&&(n.data=t.data),n}return e}function Rr(t,e){return t&&"function"==typeof t.bandwidth?{isBandwidth:!0,value:Math.max(1,t.bandwidth()*e)}:{isBandwidth:!1,value:Math.max(1,e)}}function zr(t,e,n,i,r){var o=Rr(t?t.scale:void 0,n,r),a=Rr(e?e.scale:void 0,i,r),s=Math.min(o.value*r[o.isBandwidth?"maxRelDiscrete":"maxRelExtent"],a.value*r[a.isBandwidth?"maxRelDiscrete":"maxRelExtent"]),c=Math.min(o.value*r[o.isBandwidth?"minRelDiscrete":"minRelExtent"],a.value*r[a.isBandwidth?"minRelDiscrete":"minRelExtent"]);return{min:Math.max(1,Math.floor(c)),max:Math.max(1,Math.floor(s)),maxGlobal:r.maxPx,minGlobal:r.minPx}}function Or(t,e){var n=gr(t,Ef,e);return n.errorShape=gr(t.errorShape,Tf.errorShape,e),n}function Nr(t,e,n,i){e.x,e.y;var r=e.width,o=e.height;return t.filter(function(t){return!isNaN(t.x+t.y)}).map(function(t){var e=Nn(t.size)?t.errorShape:t,a=n.min+e.size*(n.max-n.min),s={type:"rect"===e.shape?"square":e.shape,label:t.label,x:t.x*r,y:t.y*o,fill:e.fill,size:Math.min(n.maxGlobal,Math.max(n.minGlobal,a)),stroke:e.stroke,strokeWidth:e.strokeWidth,strokeDasharray:e.strokeDasharray,opacity:e.opacity};e===t.errorShape&&(s.width=e.width);var c=i(s);return c.data=t.data,c})}function Ar(t,e,n,i){var r=Ru(t,2),o=r[0],a=r[1],s=Math.sqrt(o*o+a*a),c=n-i;return{x:(o/=s)*e*c,y:(a/=s)*e*c}}function Er(t,e,n){var i=e.x,r=e.y,o=e.width,a=e.height,s=Uu(),c={x:i+o/2,y:r+a/2},u=Math.min(o,a)/2,l=Math.min(o,a)/2,h=l/100;return t.map(function(t,e){var i=n[e];i.type="path";var r=l*i.outerRadius,o=u*i.innerRadius;s.innerRadius(o),s.outerRadius(r),s.cornerRadius(h*i.cornerRadius),i.d=s(t);var a=s.centroid(t),f=i.offset?Ar(a,i.offset,r,o):{x:0,y:0};return i.transform="translate("+f.x+", "+f.y+") translate("+c.x+", "+c.y+")",i})}function Cr(t,e){return t&&e?t.cachedTicks&&t.cachedTicks()||t.ticks({distance:e}):[]}function Tr(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bottom";if(n*=.8,"left"===i||"right"===i){var r="right"===i;return"\n      M "+t+" "+(e-n)+"\n      A "+1.25*n+" "+1.25*n+", 0, 1, "+(r?0:1)+", "+t+" "+(e+n)+"\n      L "+(r?t+n:t-n)+" "+e+" Z\n    "}var o="bottom"===i;return"\n    M "+(t-n)+" "+e+"\n    A "+1.25*n+" "+1.25*n+", 0, 1, "+(o?1:0)+", "+(t+n)+" "+e+"\n    L "+t+" "+(o?e+n:e-n)+" Z\n  "}function jr(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bottom";if(n*=.75,"left"===i||"right"===i){var r="right"===i;return"\n      M "+(t+=r?1.5*n:-1.5*n)+" "+(e-n)+"\n      L "+t+" "+(e+n)+"\n      L "+(r?t+n:t-n)+" "+e+" Z\n    "}var o="bottom"===i;return e+=o?1.5*n:-1.5*n,"\n    M "+(t-n)+" "+e+"\n    L "+(t+n)+" "+e+"\n    L "+t+" "+(o?e+n:e-n)+" Z\n  "}function Pr(t){for(var e=t.blueprint,n=t.oob,i=t.settings,r=t.items,o=Object.keys(n),a=i.style.oob||{},s=0,c=o.length;s<c;s++)!function(t,i){var s=o[t],c=n[s];if(c.length>0){var u=s.charAt(1),l="y"===s.charAt(0),h=a.padding.x+a.width,f=a.padding.y+a.width,d="bottom";d=l?"1"===u?"bottom":"top":"1"===u?"right":"left";var g=e.processItem({fn:function(t){var e=t.width,n=t.height,i=u*e+("1"===u?-h:h),r=l?f:n-f;return"arc"===a.type?{type:"path",d:Tr(l?r:i,l?i:r,a.width,d),x:i,y:r,stroke:a.stroke,fill:a.fill,strokeWidth:a.strokeWidth||0}:{type:"circle",cx:i,cy:r,r:a.width,stroke:a.stroke,fill:a.fill,strokeWidth:a.strokeWidth||0,opacity:a.opacity,data:c}},flipXY:l}),p=g.cx||g.x,y=g.cy||g.y,v={type:"text",text:c.length||"",x:p-.4*a.width,y:y+.4*a.width,fontFamily:a.text.fontFamily,fontSize:1.3*a.width+"px",stroke:a.text.stroke,fill:a.text.fill,strokeWidth:a.text.strokeWidth||0,opacity:a.text.opacity},m={type:"path",d:jr(p,y,a.width,d),x:p,y:y,stroke:a.triangle.stroke,fill:a.triangle.fill,strokeWidth:a.triangle.strokeWidth||0,opacity:a.triangle.opacity};r.push(g,v,m)}}(s)}function Fr(){return{fill:"#000",fontFamily:"Arial",fontSize:"12px",opacity:1,maxWidth:1,maxWidthPx:9999,padding:5,background:{fill:"#fff",stroke:"transparent",strokeWidth:0,opacity:.5}}}function Lr(t){if(void 0===t)return 0;if("number"==typeof t&&isFinite(t))return t;if("string"==typeof t)switch(t){case"center":case"middle":return.5;case"bottom":case"right":return 1;case"top":case"left":default:return 0}return 0}function Wr(t){var e=t.chart,n=t.blueprint,i=t.renderer,r=t.p,o=t.settings,a=t.items,s=!0,c=!1,u=!1,l=!1,h=!1,f=vu(!0,{},o.style.line,r.line||{});if(c=n.processItem({type:"line",x1:r.position,y1:0,x2:r.position,y2:1,stroke:f.stroke||"black",strokeWidth:f.strokeWidth||1,flipXY:r.flipXY||!1}),r.label){var d=vu(!0,Fr(),o.style.label||{},{fill:f.stroke},r.label),g=void 0,p={width:0,height:0},y="";"string"==typeof r.formatter?g=e.formatter(r.formatter):"object"===xu(r.formatter)?g=e.formatter(r.formatter):void 0!==r.scale&&void 0!==r.scale.sources&&(g=e.formatter({source:r.scale.sources[0]})),g?y=" ("+g(r.value)+")":r.scale&&(y=" ("+r.value+")"),y&&(p=i.measureText({text:y,fontFamily:d.fontFamily,fontSize:d.fontSize}));var v=i.measureText({text:d.text||"",fontFamily:d.fontFamily,fontSize:d.fontSize}),m={width:v.width+p.width,height:Math.max(v.height,p.height)},x=d.padding,b=Lr(r.flipXY?d.vAlign:d.align),w=Lr(r.flipXY?d.align:d.vAlign),k=Math.min(1+m.width+2*x,d.maxWidth*n.width,d.maxWidthPx),_=m.height+2*x,M=r.flipXY?_:k,S=r.flipXY?k:_;if((u=n.processItem({fn:function(t){var e=t.width,i=t.height,o=r.position*e-(r.flipXY?_:k)*(1-b);return{type:"rect",x:o=r.flipXY?o:Math.max(o,0),y:Math.max(Math.abs(w*i-S*w),0),width:r.flipXY?M:Math.min(M,n.width-o),height:S,stroke:d.background.stroke,strokeWidth:d.background.strokeWidth,fill:d.background.fill,opacity:d.background.opacity}},flipXY:r.flipXY||!1})).x<-1||u.x+u.width>n.width+1||u.y<-1||u.y+u.height>n.height+1)u=void 0;else{l={type:"text",text:d.text||"",fill:d.fill,opacity:d.opacity,fontFamily:d.fontFamily,fontSize:d.fontSize,x:u.x+x,y:u.y+u.height/2+m.height/3,maxWidth:u.width-2*x-p.width,anchor:"start"},y&&(h={type:"text",text:y||"",fill:d.fill,opacity:d.opacity,fontFamily:d.fontFamily,fontSize:d.fontSize,x:l.x+3+(u.width-(p.width+2*x)),y:l.y});for(var R=0,z=a.length;R<z;R++){var O=a[R];"rect"===O.type?lf.testRectRect(u,O)&&(s=!1):"line"===O.type&&r.flipXY===O.flipXY&&lf.testRectLine(u,O)&&(s=!1)}}}a.push(c),s&&u&&l&&(a.push(u,l),h&&a.push(h))}function Dr(t){var e={value:t.value};return t.label&&(e.label=t.label.text),e}function Br(t){return void 0!==t.value}function Hr(t,e){vu(t,e.style);var n=t.strokeWidth/2;"top"===e.align?(t.y1-=n,t.y2-=n):"bottom"===e.align?(t.y1+=n,t.y2+=n):"left"===e.align?(t.x1-=n,t.x2-=n):"right"===e.align&&(t.x1+=n,t.x2+=n)}function Ir(t){var e={type:"line",x1:0,x2:0,y1:0,y2:0,collider:{type:null}};return"top"===t.align||"bottom"===t.align?(e.x1=t.innerRect.x-t.outerRect.x,e.x2=t.innerRect.width+t.innerRect.x,e.y1=e.y2="top"===t.align?t.innerRect.height-t.padding:t.padding):(e.x1=e.x2="left"===t.align?t.innerRect.width-t.padding:t.padding,e.y1=t.innerRect.y-t.outerRect.y,e.y2=t.innerRect.height+t.innerRect.y),Hr(e,t),e}function Vr(t){return"string"==typeof t||"number"==typeof t?t:"-"}function Ur(t,e){["fill","fontSize","fontFamily"].forEach(function(n){t[n]=e.style[n]})}function qr(t,e){if(!e.tilted)if("top"===e.align||"bottom"===e.align){var n=e.outerRect.width,i=Math.min(.75*e.maxWidth/2,e.textRect.width/2),r=t.x-i,o=t.x+i;r<0?(t.anchor="start",t.x=e.innerRect.x-e.outerRect.x,t.maxWidth*=.75):o>n&&(t.anchor="end",t.x=e.innerRect.width+e.innerRect.x,t.maxWidth*=.75)}else{var a=e.outerRect.height,s=e.maxHeight/2,c=t.y-s,u=t.y+s;if(c<0)t.y=e.innerRect.y-e.outerRect.y,t.dy=e.textRect.height;else if(u>a)t.y=e.innerRect.height+(e.innerRect.y-e.outerRect.y),t.dy=0;else{t.dy=e.textRect.height/3}}}function Yr(t,e){"top"===e.align?t.y-=e.padding:"bottom"===e.align?t.y+=e.padding+e.maxHeight:"left"===e.align?t.x-=e.padding:"right"===e.align&&(t.x+=e.padding)}function Xr(t,e){if(e.tilted){var n=-e.angle,i=n*(Math.PI/180);"bottom"===e.align?(t.x-=e.maxHeight*Math.sin(i)/2,t.y-=e.maxHeight,t.y+=e.maxHeight*Math.cos(i)/2):t.x-=e.maxHeight*Math.sin(i)/3,t.transform="rotate("+n+", "+t.x+", "+t.y+")",t.anchor="bottom"===e.align==e.angle<0?"start":"end";var r=Math.cos(i)*e.maxWidth;if("bottom"===e.align==e.angle<0){var o=e.outerRect.width-e.paddingEnd;t.x+r>o&&(t.maxWidth=(o-t.x-10)/Math.cos(i))}else{var a=e.paddingEnd;t.x-r<a&&(t.maxWidth=(t.x-a-10)/Math.cos(i))}}}function $r(t,e,n){if("bottom"===n.align||"top"===n.align){var i=t.position*n.innerRect.width+(n.innerRect.x-n.outerRect.x-n.stepSize/2);e.collider={type:"rect",x:i,y:0,width:i<0?n.stepSize+i:n.stepSize,height:n.innerRect.height}}else{var r=t.position*n.innerRect.height+(n.innerRect.y-n.outerRect.y-n.stepSize/2);e.collider={type:"rect",x:0,y:r,width:n.innerRect.width,height:r<0?n.stepSize+r:n.stepSize}}var o=e.collider;o.x=Math.max(o.x,0),o.y=Math.max(o.y,0);var a=o.x+o.width-(n.outerRect.x+n.outerRect.width);o.width=a>0?o.width-a:o.width;var s=o.y+o.height-(n.outerRect.y+n.outerRect.height);o.height=s>0?o.height-s:o.height}function Zr(t,e){e.collider={type:"polygon",vertices:[{x:e.boundingRect.x,y:e.boundingRect.y},{x:e.boundingRect.x+e.boundingRect.width,y:e.boundingRect.y},{x:e.boundingRect.x+e.boundingRect.width,y:e.boundingRect.y+e.boundingRect.height},{x:e.boundingRect.x,y:e.boundingRect.y+e.boundingRect.height}]}}function Gr(t,e,n){var i=n.angle*(Math.PI/180),r=Math.max(n.stepSize/2,e.boundingRect.height/2),o="start"===e.anchor,a="end"===e.anchor&&i<0,s="start"===e.anchor&&i>=0,c=e.boundingRect.y+(s||a?e.boundingRect.height:0),u=[{x:e.x-r,y:c},{x:e.x+r,y:c}].map(function(t){return p(t,i,{x:e.x,y:e.y})}),l={x:o?e.boundingRect.x+e.boundingRect.width+10:e.boundingRect.x-10,y:e.boundingRect.y+e.boundingRect.height},h={x:o?e.boundingRect.x+e.boundingRect.width+10:e.boundingRect.x-10,y:e.boundingRect.y},f=i>=0?[l,h]:[h,l];u.push.apply(u,f),e.collider={type:"polygon",vertices:u}}function Jr(t,e,n){n.layered||!n.stepSize?Zr(t,e):n.tilted?Gr(t,e,n):$r(t,e,n)}function Kr(t,e){t.boundingRect=e.textBounds(t)}function Qr(t,e){var n={type:"text",text:Vr(t.label),x:0,y:0,maxWidth:e.maxWidth,maxHeight:e.maxHeight};return"top"===e.align||"bottom"===e.align?(n.x=t.position*e.innerRect.width+(e.innerRect.x-e.outerRect.x),n.y="top"===e.align?e.innerRect.height:0,n.anchor="middle"):(n.y=t.position*e.innerRect.height+(e.innerRect.y-e.outerRect.y),n.x="left"===e.align?e.innerRect.width:0,n.anchor="left"===e.align?"end":"start"),Ur(n,e),qr(n,e),Yr(n,e),Xr(n,e),Kr(n,e),Jr(t,n,e),n}function to(t,e){vu(t,e.style)}function eo(t,e){"top"===e.align?(t.y1-=e.padding,t.y2-=e.padding):"bottom"===e.align?(t.y1+=e.padding,t.y2+=e.padding):"left"===e.align?(t.x1-=e.padding,t.x2-=e.padding):"right"===e.align&&(t.x1+=e.padding,t.x2+=e.padding)}function no(t,e){var n=t.strokeWidth/2;t.x1===e.innerRect.width?(t.x1-=n,t.x2-=n):0===t.x1?(t.x1+=n,t.x2+=n):t.y1===e.innerRect.height?(t.y1-=n,t.y2-=n):0===t.y1&&(t.y1+=n,t.y2+=n)}function io(t,e){var n={type:"line",x1:0,x2:0,y1:0,y2:0,collider:{type:null}};return"top"===e.align||"bottom"===e.align?(n.x1=n.x2=t.position*e.innerRect.width+(e.innerRect.x-e.outerRect.x),n.y1="top"===e.align?e.innerRect.height:0,n.y2="top"===e.align?n.y1-e.tickSize:n.y1+e.tickSize):(n.y1=n.y2=t.position*e.innerRect.height+(e.innerRect.y-e.outerRect.y),n.x1="left"===e.align?e.innerRect.width:0,n.x2="left"===e.align?n.x1-e.tickSize:n.x1+e.tickSize),to(n,e),eo(n,e),no(n,e),n}function ro(t){return!t.isMinor}function oo(t){var e=t.majorTicks,n=t.measureText,i=t.rect.height,r=n("M").height;return!(e.length<2)&&i*Math.abs(e[0].position-e[1].position)<r}function ao(t){for(var e=t.majorTicks,n=t.measureText,i=t.rect,r=t.scale,o="layered"===t.state.labels.activeMode?2:1,a=i.width,s=e.map(function(t){return t.label}).map(function(t){return t.slice(0,1)+(t.length>1?"…":"")}).map(n).map(function(t){return t.width}),c=0;c<e.length;++c)if(o*a*r.bandwidth()<s[c])return!0;return!1}function so(t){var e=t.majorTicks,n=t.measure,i=t.rect,r=t.scale,o=t.state,a=t.settings.labels.maxGlyphCount,s="layered"===o.labels.activeMode?2:1,c=n("…").width,u=s*i.width*r.bandwidth();if(isNaN(a))for(var l=0;l<e.length;l++){var h=e[l].label;if(n(h).width*(h.length>1?.7:1)+c>u)return!0}else if(.7*n("M").width*a+c>u)return!0;return!1}function co(t){var e=t.majorTicks,n=t.measureText,i=t.rect,r=t.bleedSize,o=t.angle;if(e.length<2)return!1;if(0===o)return!0;var a=Math.abs(o),s=1/((i.width-r)*Math.abs(e[0].position-e[1].position));return n("M").height>Math.sin(a*(Math.PI/180))/s}function uo(t){var e=t.rect,n=t.scale,i=t.state,r=t.majorTicks,o=t.measure;return t.horizontal?ao({majorTicks:r,measureText:o,rect:e,scale:n,state:i}):oo({majorTicks:r,measureText:o,rect:e,state:i})}function lo(t){var e=t.value,n=t.maxValue,i=t.minValue,r=t.range,o=t.modifier;return isNaN(r)||isNaN(o)||(e=r*o),e>n&&(e=n),e<i&&(e=i),e}function ho(t){var e=t.isDiscrete,n=t.rect,i=t.formatter,r=t.measureText,o=t.scale,a=t.settings,s=t.state,c=0,u={left:0,top:0,right:0,bottom:0},l=a.labels,h=l.maxLengthPx,f=l.minLengthPx;if(a.labels.show){var d=a.align,g="top"===d||"bottom"===d,p=g?n.width:n.height,y=o.ticks({settings:a,distance:p,formatter:i}).filter(ro),v=function(t){var e=r({text:t,fontSize:a.labels.fontSize,fontFamily:a.labels.fontFamily});return e.width=lo({value:e.width,maxValue:h,minValue:f}),e};if(e&&g&&"auto"===a.labels.mode&&(so({majorTicks:y,measure:v,rect:n,scale:o,state:s,settings:a})?s.labels.activeMode="tilted":s.labels.activeMode="horizontal"),e&&"tilted"!==s.labels.activeMode&&uo({rect:n,scale:o,state:s,majorTicks:y,measure:v,horizontal:g}))return{size:Math.max(n.width,n.height),isToLarge:!0};var m=void 0;if("tilted"===s.labels.activeMode){var x=Math.abs(a.labels.tiltAngle)*(Math.PI/180);m=function(t){return lo({value:t.width,maxValue:h,minValue:f})*Math.sin(x)+t.height*Math.cos(x)}}else m=g?function(t){return t.height}:function(t){return lo({value:t.width,maxValue:h,minValue:f})};var b=void 0;if(g&&"tilted"!==s.labels.activeMode)b=["M"];else if(isNaN(a.labels.maxGlyphCount))b=y.map(function(t){return t.label});else{for(var w="",k=0;k<a.labels.maxGlyphCount;k++)w+="M";b=[w]}var _=b.map(v),M=_.map(m),S=Math.max.apply(Math,zu(M).concat([0]));if(c+=S,c+=a.labels.margin,"layered"===s.labels.activeMode&&(c*=2),"tilted"===s.labels.activeMode){var R="bottom"===a.align==a.labels.tiltAngle>=0,z=Math.abs(a.labels.tiltAngle)*(Math.PI/180),O=(S-r("M").height*Math.cos(z))/Math.sin(z),N=Math.min(a.labels.maxEdgeBleed,Math.max.apply(Math,zu(_.map(function(t){return Math.min(O,t.width)*Math.cos(z)+t.height}).map(function(t,e){var i=y[e]?y[e].position:0;return R?t-i*n.width:t-(1-i)*n.width})).concat([0])))+a.paddingEnd;if(u[R?"left":"right"]=N,e&&co({majorTicks:y,measureText:r,rect:n,bleedSize:N,angle:a.labels.tiltAngle}))return{size:Math.max(n.width,n.height),isToLarge:!0}}}return{size:c,edgeBleed:u}}function fo(t){var e=0;return e+=t.paddingStart,e+=t.line.show?t.line.strokeWidth:0,e+=t.ticks.show?t.ticks.margin:0}function go(t){return t.line.strokeWidth+t.minorTicks.margin}function po(t){var e=0;return e+=t.ticks.show?t.ticks.tickSize:0,e+=fo(t)+t.labels.margin}function yo(t){var e=t.style;return(0,t.measureText)({text:t.tick.label,fontSize:e.fontSize,fontFamily:e.fontFamily})}function vo(t){return t.filter(function(t){return!t.isMinor})}function mo(t){return t.filter(function(t){return t.isMinor})}function xo(t,e){return t.map(function(t){return io(t,e)})}function bo(t,e,n){return t.map(function(t){e.textRect=yo({tick:t,measureText:n,style:e.style});var i=Qr(t,e);return i.data=t.data,i})}function wo(t,e,n,i){var r=e.padding,o=po(n)+e.maxHeight+n.labels.margin;return t.map(function(t,n){e.layer=n%2,e.padding=n%2==0?r:o,e.textRect=yo({tick:t,measureText:i,style:e.style});var a=Qr(t,e);return a.data=t.data,a})}function ko(t,e){for(var n=0;n<=t.length-1;n++)for(var i=n+1;i<=Math.min(n+5,n+(t.length-1));i++)t[n]&&t[i]&&function(t,e){var n=t.boundingRect,i=e.boundingRect;return lf.testRectRect(n,i)}(t[n],t[i])&&(i===t.length-1?(t.splice(n,1),e&&e.splice(n,1)):(t.splice(i,1),e&&e.splice(i,1)),i--,n--)}function _o(t){var e=t.measureText,n=t.settings,i=t.innerRect,r=t.scale,o=t.tilted,a=t.layered,s=e({text:"M",fontSize:n.labels.fontSize,fontFamily:n.labels.fontFamily}).height,c={width:0,height:s};if("left"===n.align||"right"===n.align)c.width=i.width-po(n)-n.paddingEnd;else if(a)c.width=r.bandwidth()*i.width*2;else if(o){var u=Math.abs(n.labels.tiltAngle)*(Math.PI/180);c.width=(i.height-po(n)-n.paddingEnd-s*Math.cos(u))/Math.sin(u)}else c.width=r.bandwidth()*i.width;return c.width=lo({value:c.width,maxValue:n.labels.maxLengthPx,minValue:n.labels.minLengthPx}),c}function Mo(t){var e=t.measureText,n=t.settings,i=t.innerRect,r=t.ticks,o=t.tilted,a=t.layered,s=e({text:"M",fontSize:n.labels.fontSize,fontFamily:n.labels.fontFamily}).height,c={width:0,height:s};if("left"===n.align||"right"===n.align)c.width=i.width-po(n)-n.paddingEnd;else if(a)c.width=i.width/vo(r).length*.75*2;else if(o){var u=Math.abs(n.labels.tiltAngle)*(Math.PI/180);c.width=(i.height-po(n)-n.paddingEnd-s*Math.cos(u))/Math.sin(u)}else c.width=i.width/vo(r).length*.75;return c.width=lo({value:c.width,maxValue:n.labels.maxLengthPx,minValue:n.labels.minLengthPx}),c}function So(t){function e(){return r=Mo,o=function(){return null},a=!0,e}function n(){return r=_o,o=function(t){var e=t.innerRect,n=t.scale,i=t.settings;return("top"===i.align||"bottom"===i.align?e.width:e.height)*n.bandwidth()},n}function i(t){var e=t.settings,n=t.scale,i=t.innerRect,s=t.outerRect,c=t.measureText,u=t.ticks,l=t.state,h=t.textBounds,f=[],d=vo(u),g=mo(u),p={innerRect:i,align:e.align,outerRect:s},y="tilted"===l.labels.activeMode,v="layered"===l.labels.activeMode,m=void 0;if(e.line.show&&(p.style=e.line,p.padding=e.paddingStart,f.push(Ir(p))),e.ticks.show&&(p.style=e.ticks,p.tickSize=e.ticks.tickSize,p.padding=fo(e),m=xo(d,p)),e.labels.show){var x=r({measureText:c,settings:e,innerRect:i,ticks:u,scale:n,tilted:y,layered:v}),b=po(e);p.stepSize=o({innerRect:i,scale:n,ticks:u,settings:e}),p.style=e.labels,p.padding=b,p.maxWidth=x.width,p.maxHeight=x.height,p.tilted=y,p.layered=v,p.angle=e.labels.tiltAngle,p.paddingEnd=e.paddingEnd,p.textBounds=h;var w=[];w=!v||"top"!==e.align&&"bottom"!==e.align?bo(d,p,c):wo(d,p,e,c),a&&!p.tilted&&ko(w,m),f.push.apply(f,zu(w))}return e.minorTicks&&e.minorTicks.show&&g.length>0&&(p.style=e.minorTicks,p.tickSize=e.minorTicks.tickSize,p.padding=go(e),f.push.apply(f,zu(xo(g,p)))),m&&f.push.apply(f,zu(m)),f}var r=void 0,o=void 0,a=!1;return e.build=i,n.build=i,t?n():e()}function Ro(t){var e=t.isDiscrete,n=t.rect,i=t.formatter,r=t.measureText,o=t.scale,a=t.settings,s=0,c=ho({isDiscrete:e,rect:n,formatter:i,measureText:r,scale:o,settings:a,state:t.state}),u=c.size,l=c.edgeBleed;if(s+=u,c.isToLarge)return{size:s};if(a.ticks.show&&(s+=a.ticks.margin,s+=a.ticks.tickSize),a.minorTicks&&a.minorTicks.show){var h=a.minorTicks.margin+a.minorTicks.tickSize;h>s&&(s=h)}return a.line.show&&(s+=a.line.strokeWidth),s+=a.paddingStart,s+=a.paddingEnd,{size:s,edgeBleed:l}}function zo(t,e){for(var n=t,i=0;i<e.length;i++){if(!n[e[i]])return;n=n[e[i]]}return n}function Oo(t,e){return null===e&&t?t:e}function No(t,e,n,i){for(var r=arguments.length,o=Array(r>4?r-4:0),a=4;a<r;a++)o[a-4]=arguments[a];var s=n?n.call.apply(n,[i].concat(o)):null;return void 0!==s?Oo(t,s):e&&"function"==typeof e.fn?e.fn.apply(e,[i].concat(o)):e}function Ao(t,e,n,i){var r=t[i],o=Df[e];if(!r)return n;var a=xu(r[e]);if("undefined"===a)return i<t.length-1?Ao(t,e,n,i+1):n;if(xu(r[e])===(void 0===n?"undefined":xu(n))||null===r[e])return Oo(o,r[e]);if("function"===a){var s=Ao(t,e,n,i+1);return r[e].fn=function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return No.apply(void 0,[o,s,r[e]].concat(n))},r[e]}return"object"===a?r[e]:n}function Eo(t,e,n,i){for(var r=e.length,o=[];r>=0;)o.push(zo(t,e)),e.pop(),r--;return Ao(o,n,i,0)}function Co(t,e,n){var i=n?n.split("."):[],r={};return Object.keys(t).forEach(function(n){var o=null===t[n]&&void 0!==Df[n]?Df[n]:t[n];r[n]=Eo(e,i.concat(),n,o)}),r}function To(t,e,n){var i={};return e?Object.keys(t).forEach(function(r){i[r]=t[r]&&"function"==typeof t[r].fn?t[r].fn(void 0,e[r][n],n,e[r]):t[r]}):Object.keys(t).forEach(function(e){i[e]=t[e]&&"function"==typeof t[e].fn?t[e].fn():t[e]}),i}function jo(t){return"object"!==(void 0===t?"undefined":xu(t))}function Po(t,e,n,i,r){var o={};return Object.keys(t).forEach(function(a){var s=void 0!==t[a],c=s&&"function"==typeof t[a].scale,u=s&&!!t[a].ref,l=s&&t[a].ref?e[t[a].ref]:e;if("function"==typeof t[a]){var h=vu({},{data:e},r);c&&(h.scale=t[a].scale),"function"==typeof t[a].fn?o[a]=t[a].fn(h,u?e[t[a].ref]:void 0,n,i):o[a]=t[a].call(h,u?e[t[a].ref]:void 0,n,i)}else c?(o[a]=t[a].scale(jo(l)?l:l.value),t[a].scale.bandwidth&&(o[a]+=t[a].scale.bandwidth()/2)):o[a]=u?l:t[a]}),o}function Fo(t,e,n,i){var r=vu(!0,{},t),o=i?r[i]:r,a=i?e[i]:e;return o&&Object.keys(o).forEach(function(t){if(o[t])if(!o[t].source&&!o[t].scale||o[t].fn)o[t].fn&&(o[t]=o[t].fn);else{var e=n.scale(o[t]);e&&(o[t]=e)}}),Co(a,r,i)}function Lo(t){var e=t.align,n=t.inner;return"left"===e?{x:n.width+n.x}:"right"===e||"bottom"===e?n:{y:n.y+n.height}}function Wo(t,e){var n=["top","bottom"],i=["left","right"];return-1!==n.indexOf(t)&&-1===i.indexOf(e)?t:-1!==i.indexOf(t)&&-1===n.indexOf(e)?t:e}function Do(t,e,n){var i={};return Object.keys(e).forEach(function(r){i[r]=Fo(t,e,n,r)}),i}function Bo(t,e,n){var i=e.labels.mode;return n&&t.isHorizontal?"auto"===i?t.labels.activeMode:-1!==["layered","tilted"].indexOf(e.labels.mode)&&-1!==["top","bottom"].indexOf(e.dock)?i:"horizontal":"horizontal"}function Ho(t,e,n){var i="";return"function"==typeof t?i=t():"string"==typeof t?i=t:n&&(i=(n.data().fields||[]).map(function(t){return t.title()}).join(e)),i}function Io(t,e){var n="middle";return"left"===t?"top"===e?n="end":"bottom"===e&&(n="start"):"right"===t?"top"===e?n="start":"bottom"===e&&(n="end"):"left"===e?n="start":"right"===e&&(n="end"),n}function Vo(t){var e=t.title,n=t.definitionSettings,i=t.dock,r=t.rect,o=t.measureText,a={type:"text",text:e,x:0,y:0,dx:0,dy:0,anchor:Io(i,n.anchor),baseline:"alphabetical"};vu(a,n.style);var s=o(a);if("top"===i||"bottom"===i){var c=r.width/2;"left"===n.anchor?c=n.paddingLeft||0:"right"===n.anchor&&(c=r.width-(n.paddingRight||0)),a.x=c,a.y="top"===i?r.height-n.paddingStart:n.paddingStart+s.height,a.dy="top"===i?-s.height/6:-s.height/3,a.maxWidth=.8*r.width}else{var u=r.height/2;"top"===n.anchor?u=n.paddingStart:"bottom"===n.anchor&&(u=r.height-n.paddingStart),a.y=u,a.x="left"===i?r.width-n.paddingStart:n.paddingStart,a.dx="left"===i?-s.height/3:s.height/3;var l="left"===i?270:90;a.transform="rotate("+l+", "+(a.x+a.dx)+", "+(a.y+a.dy)+")",a.maxWidth=.8*r.height}return isNaN(n.maxLengthPx)||(a.maxWidth=Math.min(a.maxWidth,n.maxLengthPx)),a}function Uo(t,e){var n=t.settings.dock,i=t.settings.settings.invert,r="top"===n||"bottom"===n,o=r?"width":"height",a=t.rect[o],s=t.chart.scroll(t.settings.scroll),c=void 0,u=e[r?"x":"y"];i&&(u=a-u);var l=s.getState();c={startOffset:u,startScroll:l.start,swipe:!1};var h=u/a*(l.max-l.min)+l.min;h<l.start?c.startScroll=h:h>l.start+l.viewSize&&(c.startScroll=h-l.viewSize);return{update:function(t){var e=t[r?"x":"y"];if(i&&(e=a-e),!c.swipe){if(Math.abs(c.startOffset-e)<=1)return;c.swipe=!0}var n=s.getState(),o=(e-c.startOffset)/a*(n.max-n.min),u=c.startScroll+o;s.moveTo(u)},end:function(t){var e=t[r?"x":"y"];i&&(e=a-e);var n=s.getState();if(c.swipe){var o=(e-c.startOffset)/a*(n.max-n.min),u=c.startScroll+o;s.moveTo(u)}else{var l=e/a*(n.max-n.min)+n.min-n.viewSize/2;s.moveTo(l)}}}}function qo(t,e){var n=e.element().getBoundingClientRect();return{x:t.center.x-n.left,y:t.center.y-n.top}}function Yo(t){var e=t.h,n=t.isVertical,i=t.value,r=t.pos,o=t.align,a=t.borderHit,s=t.state,c="end"!==o,u={left:"0",top:"0"},l={right:"0",bottom:"0"},h=c?u:l,f=0,d="100%",g="100%";return s.targetRect&&"start"===s.settings.bubbles.align?(d=s.targetRect.x+s.targetRect.width+"px",g=s.targetRect.y+s.targetRect.height+"px"):s.targetRect&&"end"===s.settings.bubbles.align&&(f=n?s.targetRect.x:s.targetRect.y,d=s.rect.width-f+"px",g=s.rect.height-f+"px"),c||(r-=a),e("div",{on:{mouseover:function(){this.children[0].elm.style.backgroundColor="#000",this.children[0].elm.style[n?"height":"width"]="2px"},mouseout:function(){this.children[0].elm.style.backgroundColor="rgba(50, 50, 50, 0.8)",this.children[0].elm.style[n?"height":"width"]="1px"}},attrs:{"data-value":i},style:{cursor:n?"ns-resize":"ew-resize",position:"absolute",left:n?f+"px":r+"px",top:n?r+"px":f+"px",height:n?a+"px":g,width:n?d:a+"px",pointerEvents:"auto"}},[e("div",{style:vu({backgroundColor:"rgba(50, 50, 50, 0.8)",position:"absolute",height:n?"1px":"100%",width:n?"100%":"1px"},h)})])}function Xo(t){var e,n=t.h,i=t.isVertical,r=t.label,o=t.otherValue,a=t.idx,s=t.pos,c=t.align,u=t.style,l="end"!==c,h="outside"===t.state.settings.bubbles.placement,f="none",d=void 0;return i?(d=l?"left":"right",h&&(f=l?"translate(-100%,  0px)":"translate(100%,  0px)")):(d=l?"top":"bottom",h&&(f=l?"translate(0px, -100%)":"translate(0px,  100%)")),n("div",{style:(e={position:"absolute"},ku(e,d,"0"),ku(e,i?"top":"left",s+"px"),ku(e,"transform",f),e)},[n("div",{attrs:{"data-other-value":o,"data-idx":a},style:vu({position:"relative",borderRadius:"6px",border:"1px solid #666",backgroundColor:"#fff",padding:"5px 9px",textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px",minWidth:"50px",minHeight:"1em",pointerEvents:"auto",transform:i?"translate(0,-50%)":"translate(-50%,0)"},u)},[r])])}function $o(t){var e=t.h,n=t.isVertical,i=t.top,r=t.height,o=t.color,a=t.on;return e("div",{style:{backgroundColor:o,position:"absolute",left:n?0:i+"px",top:n?i+"px":0,height:n?r+"px":"100%",width:n?"100%":r+"px",pointerEvents:"auto"},on:a},[])}function Zo(t){var e=t.borderHit,n=t.els,i=t.isVertical,r=t.state,o=t.vStart,a=t.vEnd,s=t.idx,c=0;r.targetRect&&(c=i?r.targetRect.y:r.targetRect.x);var u=!!r.scale,l=u?r.scale.norm(o)*r.size:o,h=u?r.scale.norm(a)*r.size:a,f=Math.abs(l-h),d=Math.min(l,h)+c,g=d+f;if(r.targetRect){var p=r.targetFillRect||r.targetRect,y=i?p.height:p.width,v=u?r.scale.norm(o)*y:o,m=u?r.scale.norm(a)*y:a,x=Math.abs(v-m),b=Math.min(v,m),w={h:r.h,isVertical:i,top:b,height:x,color:r.settings.target.fill};void 0!==r.settings.target.fillActive&&(w.on={mouseover:function(){this.elm.style.backgroundColor=r.settings.target.fillActive||r.settings.target.fill},mouseout:function(){this.elm.style.backgroundColor=r.settings.target.fill}}),n.push(r.h("div",{style:{position:"absolute",left:p.x+"px",top:p.y+"px",height:p.height+"px",width:p.width+"px"}},[$o(w)]))}n.push(Yo({h:r.h,isVertical:i,borderHit:e,value:l<h?o:a,pos:d,align:"start",state:r})),n.push(Yo({h:r.h,isVertical:i,borderHit:e,value:l<h?a:o,pos:g,align:"end",state:r}));var k=r.settings.bubbles;if(k&&k.show){var _={fontSize:k.fontSize,fontFamily:k.fontFamily,color:k.fill},M=[o,a];n.push(Xo({h:r.h,isVertical:i,align:k.align,style:_,idx:s,otherValue:l<h?a:o,label:""+r.format(l<h?o:a,M),pos:d,state:r})),n.push(Xo({h:r.h,isVertical:i,align:k.align,style:_,idx:s,otherValue:l<h?o:a,label:""+r.format(l<h?a:o,M),pos:g,state:r}))}}function Go(t){var e=t.active.limitHigh-t.active.end,n=t.active.limitLow-t.active.start,i=t.current-t.start;return i=i<0?Math.max(i,n):Math.min(i,e)}function Jo(t){if(!t.active)return[];var e=t.start,n=t.current;if(-1!==t.active.idx)if("foo"===t.active.mode)e=Math.min(t.active.start,t.active.end),n=Math.max(t.active.start,t.active.end);else if("modify"===t.active.mode)e=Math.min(t.start,t.current),n=Math.max(t.start,t.current);else{var i=Go(t);e=t.active.start+i,n=t.active.end+i}var r=[],o=t.direction===Uf;return t.ranges.forEach(function(e,n){n!==t.active.idx&&Zo({borderHit:Vf,els:r,isVertical:o,state:t,vStart:Math.min(e.min,e.max),vEnd:Math.max(e.min,e.max),idx:n})}),Zo({borderHit:Vf,els:r,isVertical:o,state:t,vStart:e,vEnd:n,idx:t.active.idx}),r}function Ko(t){return{min:t.scale.min(),max:t.scale.max()}}function Qo(t){return{min:0,max:t.direction?t.rect.width:t.rect.height}}function ta(t,e,n){var i=t.ranges,r=void 0,o=-1;for(r=0;r<i.length;r++){if(i[r].min<=e&&e<=i[r].max){o=r,n.min=r?i[r-1].max:n.min,n.max=r+1<i.length?i[r+1].min:n.max;break}if(e<i[r].min){n.max=i[r].min,n.min=r?i[r-1].max:n.min;break}}-1===o&&i.length&&r>=i.length&&(n.min=i[i.length-1].max);var a=void 0;-1!==o&&(a={idx:o,start:i[o].min,end:i[o].max,limitLow:n.min,limitHigh:n.max,mode:"foo"}),t.active=a}function ea(t){var e=t.state,n=t.e,i=t.renderer,r=t.ranges,o=t.targetSize;if(!e.started){var a=n.center.x-n.deltaX,s=n.center.y-n.deltaY,c=document.elementFromPoint(a,s);i.element().contains(c)||(c=null);var u={started:!0};e.offset=i.element().getBoundingClientRect(),e.ranges=r(e);var l=a-e.offset.left,h=s-e.offset.top,f=n.center[e.cssCoord.coord]-n[e.cssCoord.pos]-e.offset[e.cssCoord.offset],d=n.center[e.cssCoord.coord]-e.offset[e.cssCoord.offset],g=d,p=f;u.start=f,u.current=d;var y=e.ranges,v=Qo(e),m=void 0,x=-1;if(c&&c.hasAttribute("data-idx"))x=parseInt(c.getAttribute("data-idx"),10),v.min=x>0?y[x-1].max:v.min,v.max=x+1<y.length?y[x+1].min:v.max;else{for(m=0;m<y.length;m++){if(y[m].min<=p&&p<=y[m].max){x=m,v.min=m?y[m-1].max:v.min,v.max=m+1<y.length?y[m+1].min:v.max;break}if(p<y[m].min){v.max=y[m].min,v.min=m?y[m-1].max:v.min;break}}-1===x&&y.length&&m>=y.length&&(v.min=y[y.length-1].max)}-1!==x||e.multi||(u.ranges=[],v.min=0,v.max=e.direction?e.rect.width:e.rect.height);var b=void 0;if(-1!==x)if(b={idx:x,start:y[x].min,end:y[x].max,limitLow:v.min,limitHigh:v.max,mode:"move"},c&&c.hasAttribute("data-other-value"))u.start=parseFloat(c.getAttribute("data-other-value")),b.mode="modify";else{var w=b.start,k=b.end;Math.abs(f-w)<=o?(u.start=b.end,b.mode="modify"):Math.abs(f-k)<=o&&(u.start=b.start,b.mode="modify")}else b={idx:-1,start:p,end:g,limitLow:v.min,limitHigh:v.max,mode:"current"};u.active=b,"modify"!==b.mode&&e.targetRect&&!lf.testRectPoint(e.targetRect,{x:l,y:h})||Object.keys(u).forEach(function(t){return e[t]=u[t]})}}function na(t){var e=t.state,n=t.e,i=t.renderer,r=t.ranges,o=t.targetSize;if(!e.started){var a=n.center.x-n.deltaX,s=n.center.y-n.deltaY,c=document.elementFromPoint(a,s);i.element().contains(c)||(c=null);var u={started:!0};e.offset=vu({},i.element().getBoundingClientRect());var l=a-e.offset.left,h=s-e.offset.top;e.offset.left+=e.targetRect?e.targetRect.x:0,e.offset.top+=e.targetRect?e.targetRect.y:0,e.ranges=r(e,e.fauxBrushInstance||e.brushInstance);var f=n.center[e.cssCoord.coord]-n[e.cssCoord.pos]-e.offset[e.cssCoord.offset],d=n.center[e.cssCoord.coord]-e.offset[e.cssCoord.offset];u.current=e.scale.normInvert(d/e.size),u.start=e.scale.normInvert(f/e.size);var g=e.ranges,p=Ko(e),y=void 0,v=-1;if(c&&c.hasAttribute("data-idx"))v=parseInt(c.getAttribute("data-idx"),10),p.min=v>0?g[v-1].max:p.min,p.max=v+1<g.length?g[v+1].min:p.max;else{for(y=0;y<g.length;y++){if(g[y].min<=u.start&&u.start<=g[y].max){v=y,p.min=y?g[y-1].max:p.min,p.max=y+1<g.length?g[y+1].min:p.max;break}if(u.start<g[y].min){p.max=g[y].min,p.min=y?g[y-1].max:p.min;break}}-1===v&&g.length&&y>=g.length&&(p.min=g[g.length-1].max)}-1!==v||e.multi||(u.ranges=[],p.min=e.scale.min(),p.max=e.scale.max());var m=void 0;if(-1!==v)if(m={idx:v,start:g[v].min,end:g[v].max,limitLow:p.min,limitHigh:p.max,mode:"move"},c&&c.hasAttribute("data-other-value"))u.start=parseFloat(c.getAttribute("data-other-value")),m.mode="modify";else{var x=e.scale.norm(m.start)*e.size,b=e.scale.norm(m.end)*e.size;Math.abs(f-x)<=o?(u.start=m.end,m.mode="modify"):Math.abs(f-b)<=o&&(u.start=m.start,m.mode="modify")}else m={idx:-1,start:u.start,end:u.current,limitLow:p.min,limitHigh:p.max,mode:"current"};u.active=m,"modify"!==m.mode&&e.targetRect&&!lf.testRectPoint(e.targetRect,{x:l,y:h})||Object.keys(u).forEach(function(t){return e[t]=u[t]})}}function ia(t,e){t.started=!1,t.ranges=e(t,t.fauxBrushInstance||t.brushInstance);var n=Ko(t);ta(t,t.current,n)}function ra(t,e){t.started=!1,t.ranges=e(t);var n=Qo(t);ta(t,t.current,n)}function oa(t,e){var n=(e.center[t.cssCoord.coord]-t.offset[t.cssCoord.offset])/t.size,i=t.scale.normInvert(n);t.current=Math.max(Math.min(i,t.active.limitHigh),t.active.limitLow)}function aa(t,e){var n=e.center[t.cssCoord.coord]-t.offset[t.cssCoord.offset];t.current=Math.max(Math.min(n,t.active.limitHigh),t.active.limitLow)}function sa(t){t.renderer.render(Jo(t))}function ca(t,e){if(!e||!e.isActive())return[];var n=t.scale.data(),i=(n?n.fields||[]:[]).map(function(t){return t.id()}),r=e.brushes().filter(function(t){return"range"===t.type&&-1!==i.indexOf(t.id)})[0];return r?r.brush.ranges():[]}function ua(t){var e=t.ranges.map(function(t){return{min:t.min,max:t.max}});if(-1!==t.active.idx)if("modify"===t.active.mode)e[t.active.idx].min=Math.min(t.start,t.current),e[t.active.idx].max=Math.max(t.start,t.current);else{var n=Go(t);e[t.active.idx].min+=n,e[t.active.idx].max+=n}else e.push({min:Math.min(t.start,t.current),max:Math.max(t.start,t.current)});var i=t.scale.data();i&&i.fields&&i.fields.forEach(function(n){if(t.fauxBrushInstance){var i=ca(t,t.fauxBrushInstance),r=t.findValues(i),o=t.findValues(e),a=o.filter(function(t){return-1===r.indexOf(t)}),s=r.filter(function(t){return-1===o.indexOf(t)}),c=a.map(function(t){return{key:n.id(),value:t}}),u=s.map(function(t){return{key:n.id(),value:t}});t.brushInstance.addAndRemoveValues(c,u),t.fauxBrushInstance.setRange(n.id(),e)}else t.brushInstance.setRange(n.id(),e)})}function la(t,e){for(var n=void 0,i=1/0,r=e.domain(),o=e.bandwidth()/2,a=0;a<r.length;++a){var s=Math.abs(t-o-e(r[a]));s<i&&(i=s,n=r[a])}return n}function ha(t,e){var n=e.ticks(),i=e.domain().indexOf(la(t,e));return-1!==i?n[i].label:"-"}function fa(t,e){return Math.min.apply(Math,zu(t))<=Math.max.apply(Math,zu(e))&&Math.max.apply(Math,zu(t))>=Math.min.apply(Math,zu(e))}function da(t,e){var n=e.domain(),i=e.range(),r=[];return t.forEach(function(t){if(fa(i,[t.min,t.max])){var o=n.indexOf(la(t.min,e)),a=n.indexOf(la(t.max,e));r.push.apply(r,n.slice(Math.min(o,a),Math.max(o,a)+1))}}),r}function ga(t){return w(t.reduce(function(t,e){return t.push.apply(t,zu(x(e.bounds))),t},[]))}function pa(t){var e={targetRect:null,targetFillRect:null,scale:null,size:null},n=t.settings.settings,i=n.target?t.chart.component(n.target.component):null,r=n.target&&n.target.selector?t.chart.findShapes(n.target.selector):[],o=n.target&&n.target.fillSelector?t.chart.findShapes(n.target.fillSelector):[];if(r.length>0){var a=ga(r);if(e.size=a[t.state.direction===Uf?"height":"width"],e.scale=br(t.chart.scale(n.scale),e.size),e.targetRect=a,o.length>0){var s=ga(o);e.targetFillRect=s}}else i&&i.rect&&(e.targetRect={x:i.rect.x-t.state.rect.x,y:i.rect.y-t.state.rect.y,width:i.rect.width,height:i.rect.height});return e}function ya(t){t.renderer.render(Jo(t))}function va(t){return t.rc.ranges()}function ma(t,e){var n={x:t.direction?e.min+t.rect.x:t.rect.x,y:t.direction?t.rect.y:e.min+t.rect.y,width:t.direction?e.max-e.min:t.rect.width+t.rect.x,height:t.direction?t.rect.height+t.rect.y:e.max-e.min};return t.chart.shapesAt(n,t.settings.brush)}function xa(t,e){t.chart.brushFromShapes(e,t.settings.brush)}function ba(t){var e=t.ranges.map(function(t){return{min:t.min,max:t.max}});if(-1!==t.active.idx)if("modify"===t.active.mode)e[t.active.idx].min=Math.min(t.start,t.current),e[t.active.idx].max=Math.max(t.start,t.current);else{var n=Go(t);e[t.active.idx].min=t.active.start+n,e[t.active.idx].max=t.active.end+n}else e.push({min:Math.min(t.start,t.current),max:Math.max(t.start,t.current)});t.rc.set(e);var i=[];e.forEach(function(e){i.push.apply(i,zu(ma(t,e)))}),xa(t,i)}function wa(t,e,n){var i=Math.min.apply(Math,zu(n)),r=Math.max.apply(Math,zu(n)),o={x:t.direction?i+t.rect.x:t.rect.x,y:t.direction?t.rect.y:i+t.rect.y,width:t.direction?r-i:t.rect.width+t.rect.x,height:t.direction?t.rect.height+t.rect.y:r-i},a=t.chart.shapesAt(o,t.settings.brush);if(0===a.length)return"-";var s=a.reduce(function(n,r){return e===i?n.collider[t.cssCoord.coord]<=r.collider[t.cssCoord.coord]?n:r:n.collider[t.cssCoord.coord]+n.collider[t.cssCoord.area]>=r.collider[t.cssCoord.coord]+r.collider[t.cssCoord.area]?n:r}),c=t.settings.brush.components.reduce(function(t,e){return t.key===s.key?t:e}).data||["self"];return"function"==typeof t.settings.bubbles.label?t.settings.bubbles.label(s.data):s.data[c[0]].label}function ka(t){var e=t.brush;if(!e||!e.isActive())return[];var n=t.scale.data(),i=(n?n.fields||[]:[]).map(function(t){return t.id()}),r=e.brushes().filter(function(t){return"range"===t.type&&-1!==i.indexOf(t.id)})[0];return r?r.brush.ranges():[]}function _a(t){var e="vertical"===t.direction,n=t.rect[e?"height":"width"],i=t.rect[e?"width":"height"];return ka(t).map(function(r){var o=t.scale(r.min)*n,a=t.scale(r.max)*n,s=Math.min(o,a),c=Math.abs(o-a);return{type:"rect",fill:t.fill,opacity:t.opacity,x:e?0:s,width:e?i:c,y:e?s:0,height:e?c:i}})}function Ma(t){t.renderer.render(_a(t))}function Sa(t){t.renderer.render(_a(t))}function Ra(t){t.renderer.render(_a(t))}function za(t,e,n,i){function r(){Ma(t)}function o(){Sa(t)}function a(){Ra(t)}t.brush=e,e&&(e.on("start",r),e.on("update",o),e.on("end",a),t.start=r,t.update=o,t.end=a,t.brush=e,t.scale=n,t.renderer=i)}function Oa(t){t.brush&&(t.brush.removeListener("start",t.start),t.brush.removeListener("update",t.update),t.brush.removeListener("end",t.end)),t.start=void 0,t.update=void 0,t.end=void 0,t.brush=void 0,t.scale=void 0,t.renderer=void 0}function Na(t,e){var n=e.center.x,i=e.center.y;return{x:n-t.left,y:i-t.top}}function Aa(t,e,n){return h(t,e.points[0])<Math.pow(n.settings.snapIndicator.threshold,2)}function Ea(t,e){null==t.path.d?t.path.d="M"+e.x+" "+e.y+" ":t.path.d+="L"+e.x+" "+e.y+" ",t.points.push(e)}function Ca(t,e){var n=[t.startPoint,t.path,t.snapIndicator].filter(function(t){return t.visible});e.render(n)}function Ta(t){var e=t.state,n=t.start,i=void 0===n?null:n,r=t.end,o=void 0===r?null:r;null!==i&&(e.snapIndicator.x1=i.x,e.snapIndicator.y1=i.y),null!==o&&(e.snapIndicator.x2=o.x,e.snapIndicator.y2=o.y)}function ja(t,e){t.snapIndicator.visible=e}function Pa(t,e){t.startPoint.cx=e.x,t.startPoint.cy=e.y}function Fa(t,e){var n=t.element.getBoundingClientRect();return{x:e.left-n.left,y:e.top-n.top}}function La(t,e){if(t.active){var n=t.points[t.points.length-2],i=t.points[t.points.length-1];t.lineBrushShape.x1=n.x+t.componentDelta.x,t.lineBrushShape.y1=n.y+t.componentDelta.y,t.lineBrushShape.x2=i.x+t.componentDelta.x,t.lineBrushShape.y2=i.y+t.componentDelta.y;var r=e.shapesAt(t.lineBrushShape,{components:t.brushConfig});e.brushFromShapes(r,{components:t.brushConfig})}}function Wa(t,e){if(t.active){var n=t.componentDelta.x,i=t.componentDelta.y,r=t.points.map(function(t){return{x:t.x+n,y:t.y+i}}),o=e.shapesAt({vertices:r},{components:t.brushConfig});e.brushFromShapes(o,{components:t.brushConfig})}}function Da(t){return{visible:!0,type:"path",d:null,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,opacity:t.opacity,strokeDasharray:t.strokeDasharray,collider:{type:null}}}function Ba(t){return{visible:!1,type:"line",x1:0,y1:0,x2:0,y2:0,strokeDasharray:t.strokeDasharray,stroke:t.stroke,strokeWidth:t.strokeWidth,opacity:t.opacity,collider:{type:null}}}function Ha(t){return{visible:!0,type:"circle",cx:0,cy:0,r:t.r,fill:t.fill,opacity:t.opacity,stroke:t.stroke,strokeWidth:t.strokeWidth,collider:{type:null}}}function Ia(t){return t.settings.brush.components.map(function(t){return{key:t.key,contexts:t.contexts||["lassoBrush"],data:t.data||[""],action:t.action||"add"}})}function Va(t,e){t.brushConfig.forEach(function(t){t.contexts.forEach(function(t){e.brush(t).end()})})}function Ua(t,e,n){var i={type:"text",text:e,maxWidth:t.width,x:0,y:t.y,dx:0,dy:0,fill:n.fill,anchor:"start",baseline:"alphabetical",fontSize:n.fontSize+"px",fontFamily:n.fontFamily},r=n.textMetrics;if(t.width<n.fontSize||t.height<r.height*Zf)return!1;var o=Math.max(0,t.width-r.width),a=Math.max(0,t.height-r.height*Zf);return i.x=t.x+n.align*o,i.y=t.y+r.height+n.justify*a,n.transform&&(i.transform="rotate(90, "+(i.x+i.dx)+", "+(i.y+i.dy)+")"),i}function qa(t,e,n){var i={type:"text",text:e,maxWidth:t.height,x:0,y:t.y,dx:0,dy:0,fill:n.fill,anchor:"end",baseline:"alphabetical",fontSize:n.fontSize+"px",fontFamily:n.fontFamily},r=n.textMetrics;if(t.width<n.fontSize||t.height<r.height*Zf)return!1;var o=Math.max(0,t.width-r.height*Zf),a=Math.max(0,t.height-r.width);return i.x=t.x+r.height+n.align*o,i.y=t.y+n.justify*a,i.transform="rotate(-90, "+(i.x+i.dx)+", "+(i.y+i.dy)+")",i}function Ya(t){var e=t.bar,n=t.view,i=t.direction,r=t.position,o={};if("up"===i||"down"===i){o.x=e.x,o.width=e.width;var a=Math.max(0,Math.min(e.y,n.height)),s=Math.max(0,Math.min(e.y+e.height,n.height));"outside"===r&&"up"===i||"opposite"===r&&"down"===i?(o.y=Gf,o.height=a-Jf):"outside"===r&&"down"===i||"opposite"===r&&"up"===i?(o.y=s+Gf,o.height=Math.max(0,n.height-s-Jf)):(o.height=s-a-Jf,o.y=a+Gf)}return o}function Xa(t){for(var e=t.nodes,n=t.stngs,i=t.placementSettings,r=t.labelSettings,o=t.measurements,a=t.texts,s=t.rect,c=t.fitsHorizontally,u=[],l=c?Ua:qa,h=void 0,f=void 0,d=void 0,g=void 0,p=void 0,y=void 0,v=void 0,m=void 0,x=void 0,b=void 0,w=void 0,k=void 0,_=void 0,M=void 0,S=void 0,R=0,z=e.length;R<z;R++){y=null,d=(f=e[R]).data,k=a[R],b="function"==typeof n.direction?n.direction(d):n.direction||"up";for(var O=0;O<k.length;O++)if(g=k[O]){w=r[O],x=o[R][O],M=w.placements;var N=void 0,A=[];for(S=0;S<M.length;S++)if(_=i[O][S],m=Ya({bar:f.localBounds,view:s,direction:b,position:_.position}),A.push(m),N=!S||m.height>N.height?m:N,c&&m.height>x.height*Zf||!c&&m.height>x.width){y=m;break}!c&&!y&&N.height>2*w.fontSize&&(y=N,S=A.indexOf(y)),_=i[O][S],y&&_&&(p=_.justify,v="function"==typeof _.fill?_.fill({node:f,data:d},R):_.fill,"up"===b&&(p=1-p),"opposite"===_.position&&(p=1-p),(h=l(y,g,{fill:v,justify:p,align:_.align,fontSize:w.fontSize,fontFamily:w.fontFamily,textMetrics:x}))&&u.push(h))}}return u}function $a(t){for(var e=t.settings,n=t.nodes,i=t.data,r=t.rect,o=t.renderer,a={fontSize:12,fontFamily:"Arial",align:.5,justify:0,fill:"#333"},s=[],c=[],u={},l=!0,h=void 0,f=void 0,d=void 0,g=void 0,p=void 0,y=void 0,v=e.labels.map(function(t){return vu({},a,e,t)}),m=e.labels.map(function(t){return t.placements.map(function(n){return vu({},a,e,t,n)})}),x=0,b=n.length;x<b;x++)if(c[x]=[],s[x]=[],h=n[x],g=h.localBounds,lf.testRectRect(g,r)){f=h.data;for(var w=0;w<v.length;w++)(d="function"==typeof(y=v[w]).label?y.label(f):"")&&(u.fontFamily=y.fontFamily,u.fontSize=y.fontSize+"px",u.text=d,p=o.measureText(u),s[x][w]=p,c[x][w]=d,l=l&&p.width<=g.width)}return Xa({nodes:n,texts:c,measurements:s,stngs:e,placementSettings:m,labelSettings:v,data:i,rect:r,fitsHorizontally:l})}function Za(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=0;return r=n-e,r*=Math.min(1,Math.max(i,0))}function Ga(t){if("object"===(void 0===t?"undefined":xu(t))&&null!==t){var e={};return e.top=parseFloat(t.top||0),e.right=parseFloat((void 0===t.right||isNaN(t.right)?e.top:t.right)||0),e.bottom=parseFloat((void 0===t.bottom||isNaN(t.bottom)?e.top:t.bottom)||0),e.left=parseFloat((void 0===t.left||isNaN(t.left)?e.right:t.left)||0),e.width=e.left+e.right,e.height=e.top+e.bottom,e}if("number"==typeof t)return{top:t,right:t,bottom:t,left:t,width:2*t,height:2*t};if("string"==typeof t){var n=t.replace(/px/gi,"").split(" ");return Ga({top:n[0],right:n[1],bottom:n[2],left:n[3]})}return{top:0,right:0,bottom:0,left:0,width:0,height:0}}function Ja(t){var e=t.x,n=t.y,i=t.fixedInnerWidth,r=t.fixedInnerHeight,o=t.color,a=t.label,s=t.labelBounds,c=t.labelMeasure,u=t.anchor,l=void 0===u?"left":u,h=t.renderingArea,f=void 0===h?{x:0,y:0,width:0,height:0}:h,d=t.margin,g=t.symbolPadding,p=void 0===g?0:g,y=t.shape,v=t.shapeSize,m=void 0===v?0:v,x=t.maxShapeSize,b=void 0===x?m:x,w=t.data,k=t.justify,_=void 0===k?0:k,M=t.align,S=void 0===M?0:M;d=Ga(d);var R="left"===l,z=vu({},a,{type:"text",data:w,collider:{type:null}}),O=i||s.width+m+p,N=r||Math.max(s.height,m),A=O+d.left+d.right,E=N+d.top+d.bottom,C={type:"container",x:R?e:f.width-e-A,y:n,width:A,height:E,innerWidth:O,innerHeight:N,data:w,children:[]};if(C.collider={type:"rect",x:C.x,y:C.y,width:C.width,height:C.height},y){var T=m/2,j=R?C.x+d.left+T:C.x+A-d.right-T,P=C.y+T+d.top,F=Za(j,m,b,R?S:1-S);j+=R?F:-F,P+=Za(P,m,N,_);var L=void 0;L="object"!==(void 0===y?"undefined":xu(y))?{type:y}:y;var W=Sr(vu({size:m,fill:o,stroke:o},L,{x:j,y:P,data:w,collider:{type:null}}));C.children.push(W)}return z.x=R?C.x+d.left+b+p:C.x+A-d.right-b-p,z.y=C.y+d.top+c.height,z.y+=Za(z.y,s.height,N,_),C.children.push(z),C}function Ka(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bottom";if("left"===i||"right"===i){var r="right"===i;return"\n      M "+(t+=r?-n:n)+" "+(e-n)+"\n      L "+t+" "+(e+n)+"\n      L "+(r?t+1.5*n:t-1.5*n)+" "+e+" Z\n    "}var o="down"===i;return e+=o?-n:n,"\n    M "+(t-n)+" "+e+"\n    L "+(t+n)+" "+e+"\n    L "+t+" "+(o?e+1.5*n:e-1.5*n)+" Z\n  "}function Qa(t){var e=t.x,n=t.y,i=t.width,r=t.height,o=t.direction,a=t.action,s=t.rect,c=t.symbol,u=vu({type:"rect",x:e,y:n,width:i,height:r,fill:"transparent",stroke:"grey",strokeWidth:1,opacity:1},s),l=.6*Math.min(i/2,r/2),h=vu({},c,{type:"path",d:Ka(e+i/2,n+r/2,l,o)}),f={type:"container",x:e,y:n,width:i,height:r};return f.collider=vu({},f,{type:"rect"}),f.children=[u,h],f.desc={action:a},f.tag="scroll-button",f}function ts(t){var e=t.HORIZONTAL,n=t.rect,i=t.state,r=t.buttonRectMinus,o=t.buttonRectPlus,a=t.buttonSymbolMinus,s=t.buttonSymbolPlus,c=t.anchor,u=[],l=Qf,h=td,f="left"===c;if(e){var d=(i.maxOuterHeight||n.height)/2,g=f?n.width-nd-Qf:nd;u.push(Qa({x:g,y:d+ed,width:l,height:h,action:"-",direction:f?"left":"right",rect:r,symbol:a})),u.push(Qa({x:g,y:d-td-ed,width:l,height:h,action:"+",direction:f?"right":"left",rect:o,symbol:s}))}else{var p=(i.maxOuterWidth||n.width)/2,y=n.height-nd-td;u.push(Qa({x:f?p+ed:n.width-p-ed-Qf,y:y,width:l,height:h,action:f?"-":"+",direction:f?"up":"down",rect:f?r:o,symbol:f?a:s})),u.push(Qa({x:f?p-ed-Qf:n.width-p+ed,y:y,width:l,height:h,action:f?"+":"-",direction:f?"down":"up",rect:f?o:r,symbol:f?s:a}))}return u}function es(t,e){var n=t.defs,i=t.titleDef,r=0,o=0,a=0,s=0,c=0,u=0,l=0,h=0,f=0;i.show&&(r=u=i.margin.left+i.margin.right+i.labelBounds.width,o=l=i.margin.top+i.margin.bottom+i.labelBounds.height),t.buttonDefs.show&&(h=nd+2*ed+2*Qf,f=nd+2*ed+2*td,r=e.isHorizontal?r:Math.max(r,h),o=e.isHorizontal?Math.max(o,f):o),n.forEach(function(t){c=Math.max(c,t.shapeSize||0)});for(var d=0,g=n.length;d<g;d++){var p=n[d];if(p.show){var y=p.labelBounds.width+c+p.symbolPadding,v=Math.max(p.labelBounds.height,c);a=Math.max(a,y),s=Math.max(s,v),r=Math.max(r,p.margin.left+p.margin.right+y+(e.isHorizontal?u+h:0)),o=Math.max(o,p.margin.top+p.margin.bottom+v+(e.isHorizontal?0:l+f))}}return{maxOuterWidth:r,maxOuterHeight:o,maxInnerWidth:a,maxInnerHeight:s,maxShapeSize:c}}function ns(t){var e=Po(t.buttons.rect,{},0,[]),n=Po(t.buttons.symbol,{},0,[]),i=Po(t.buttons["rect:disabled"],{},0,[]),r=Po(t.buttons["symbol:disabled"],{},0,[]);return{show:t.buttons.show,buttonRect:e,buttonSymbol:n,buttonRectDisabled:i,buttonSymbolDisabled:r}}function is(t){var e=t.settings,n=t.local,i=t.renderer,r=void 0;r=e.title.text?e.title.text:n.sourceTitle;var o={show:e.title.show,margin:Ga(e.title.margin),label:{text:r,fontSize:e.title.fontSize,fontFamily:e.title.fontFamily,fill:e.title.fill,wordBreak:e.title.wordBreak,hyphens:e.title.hyphens,maxLines:e.title.maxLines,lineHeight:e.title.lineHeight,maxWidth:e.title.maxWidth,anchor:"left"===n.anchor?"start":"end"}};return o.labelMeasure=i.measureText(o.label),o.labelBounds=i.textBounds(o.label),o}function rs(t){for(var e=t.scale,n=t.settings,i=t.renderer,r=t.local,o=[],a=e.domain(),s=e.data(),c=0;c<Math.min(1500,a.length);c++){var u=a[c],l=e.label?e.label(u):"",h=e.datum?e.datum(u):{};r.isThreshold&&(h={value:[u,a[c+1]],source:{field:r.sourceField.id()}},!e.label&&r.formatter&&(l=r.formatter(u)));var f=Po(n.item,h,c,s,{formatter:r.formatter});!1!==f.show&&("object"===xu(n.item.shape)&&(f.shape=Po(n.item.shape,h,c,s),f.shapeSize=f.shape.size),f.margin=Ga(f.margin),f.label=vu({},f.label),f.label.anchor="left"===r.anchor?"start":"end",f.label.text=l||u,f.labelMeasure=i.measureText(f.label),f.shapeSize=f.shapeSize||f.labelMeasure.height,f.labelBounds=i.textBounds(f.label),f.color=e(u),f.data=h,o.push(f))}return o}function os(t){var e=t.settings,n=t.chart,i=t.rect,r=t.local,o=t.state,a=[],s={},c=0,u=0,l=r.isHorizontal?i.width-Qf-nd:i.height-td-nd;o.titleDef.show&&(s=Ja(vu(o.titleDef,{x:s.width||c,y:s.height||u,anchor:r.anchor,renderingArea:i})),a.push(s),l-=r.isHorizontal?s.width:s.height);var h=!1;o.pageSize=0;for(var f=o.index;f<o.defs.length;f++){var d=o.defs[f];if(c+=s.width||0,u+=s.height||0,d.x=r.isHorizontal?c:0,d.y=r.isHorizontal?0:u,r.isStacked||(d.fixedInnerWidth=o.fixedInnerWidth,d.fixedInnerHeight=o.fixedInnerHeight),s=Ja(vu(d,{anchor:r.anchor,renderingArea:i,maxShapeSize:o.maxShapeSize})),(l-=r.isHorizontal?s.width:s.height)<0){h=!0;break}a.push(s),o.pageSize++,o.index+o.pageSize>=o.defs.length&&o.pageSize<o.defs.length&&(h=!0)}return e.buttons.show&&!e.key&&n.logger().warn("legend-cat requires a key for the index to be preserved when paging. Disable buttons or add a key to the item."),o.pageMax=Math.max(0,o.defs.length-o.pageSize),o.pageMin=0,h&&e.buttons.show&&a.push.apply(a,zu(ts({HORIZONTAL:r.isHorizontal,rect:i,state:o,buttonRectMinus:o.index<=0?o.buttonDefs.buttonRectDisabled:o.buttonDefs.buttonRect,buttonRectPlus:o.index>=o.pageMax?o.buttonDefs.buttonRectDisabled:o.buttonDefs.buttonRect,buttonSymbolMinus:o.index<=0?o.buttonDefs.buttonSymbolDisabled:o.buttonDefs.buttonSymbol,buttonSymbolPlus:o.index>=o.pageMax?o.buttonDefs.buttonSymbolDisabled:o.buttonDefs.buttonSymbol,anchor:r.anchor}))),a}function as(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=t.state,i=isNaN(e)?3:e;n.index=Math.max(n.pageMin,Math.min(n.pageMax,n.index+i));var r=os({chart:t.chart,settings:t.settings.settings,scale:t.scale,rect:t.rect,local:t.local,state:t.state});t.update(r)}function ss(t,e){var n=0,i={type:t.state.isVertical?"justify":"align",coord:t.state.isVertical?"y":"x",pos:t.state.isVertical?"height":"width",fn:t.state.isVertical?"requiredHeight":"requiredWidth"};n=t.state.rect[i.pos]-t.state.legend.length()-t.state.title[i.fn](),n*=Math.min(1,Math.max(t.stgns[i.type],0)),e[i.coord]+=n}function cs(t){var e=t.state.legend.fillScale,n=t.state.legend.majorScale;return e.domain().map(function(t){return{type:"stop",color:e(t),offset:Math.min(1,Math.max(0,n.norm(t)))}}).sort(function(t,e){return t.offset-e.offset})}function us(t){var e=t.state,n=t.stgns,i="left"===e.ticks.anchor,r="top"===e.ticks.anchor,o=e.rect.x,a=e.rect.y,s="start";"left"===e.title.anchor?(o+=e.title.requiredWidth()-n.title.padding,a+=e.title.textMetrics.height,a+=r?e.rect.height-e.title.textBounds.height:0,s="end"):"right"===e.title.anchor?(o+=e.legend.length(),o+=n.title.padding,a+=e.title.textMetrics.height,a+=r?e.rect.height-e.title.textBounds.height:0):"top"===e.title.anchor&&(o+=i?e.rect.width:0,a+=e.title.textMetrics.height,s=i?"end":"start");var c={type:"text",x:o,y:Math.min(a,e.rect.y+e.rect.height),text:n.title.text,fill:n.title.fill,fontSize:n.title.fontSize,fontFamily:n.title.fontFamily,maxWidth:n.title.maxLengthPx,maxLines:n.title.maxLines,wordBreak:n.title.wordBreak,hyphens:n.title.hyphens,lineHeight:n.title.lineHeight,anchor:s};return ss(t,c),c}function ls(t,e){var n=t.state,i=t.stgns,r=n.rect,o=r.x,a=r.y,s=n.isVertical?i.size:n.legend.length(),c=n.isVertical?n.legend.length():i.size;"left"===n.ticks.anchor?o+=n.rect.width-i.size:"top"===n.ticks.anchor&&(a+=n.rect.height-i.size),"top"===n.title.anchor?a+=n.title.requiredHeight():"left"===n.title.anchor&&(o+=n.title.requiredWidth());var u={type:"rect",x:o,y:a,width:s,height:c,fill:{type:"gradient",stops:e,degree:n.isVertical?90:180}};return ss(t,u),u}function hs(t,e){var n=t.state,i=t.stgns,r="start",o={type:"rect",x:e.x,y:e.y,width:n.isVertical?0:e.width,height:n.isVertical?e.height:0,fill:"transparent"},a=n.ticks.values.map(function(a){var s=0,c=0,u=0;return n.isVertical?(c=e.y+e.height*a.pos,u=1===a.pos?-a.textMetrics.height/5:a.textMetrics.height):s=e.x+e.width*a.pos,"right"===n.ticks.anchor?(s=e.x+i.size+i.tick.padding,o.x=e.x+e.width):"left"===n.ticks.anchor?(s=e.x-i.tick.padding,r="end"):"top"===n.ticks.anchor?(c=e.y-i.tick.padding,u-=.25*a.textMetrics.height,r=0===a.pos?"start":"end"):"bottom"===n.ticks.anchor&&(c=e.y+e.height+i.tick.padding,u=.8*a.textMetrics.height,r=0===a.pos?"start":"end",o.y=e.y+e.height),{type:"text",x:s,y:c,dx:0,dy:u,text:a.label,fontSize:i.tick.fontSize,fontFamily:i.tick.fontFamily,fill:i.tick.fill,maxWidth:n.isVertical?i.tick.maxLengthPx:Math.min(i.tick.maxLengthPx,n.legend.length()/2),anchor:r,textBoundsFn:t.renderer.textBounds}});return{type:"container",id:"legend-seq-ticks",children:[].concat(zu(a),[o])}}function fs(t,e,n){var i=n[t];return"object"===(void 0===i?"undefined":xu(i))?-1!==i.valid.indexOf(e)?e:i.default:n.default}function ds(t){return fs(t.dock,t.settings.tick.anchor,{left:{valid:["left","right"],default:"left"},right:{valid:["left","right"],default:"right"},top:{valid:["top","bottom"],default:"top"},bottom:{valid:["top","bottom"],default:"bottom"},default:"right"})}function gs(t){var e={left:{valid:["top"],default:"top"},right:{valid:["top"],default:"top"},top:{valid:["left","right"],default:"left"},bottom:{valid:["left","right"],default:"left"},default:"top"};return fs(t.dock,t.settings.title.anchor,e)}function ps(t,e){var n={x:0,y:0,width:0,height:0},i=t.stgns.padding;return n.x=i.left,n.y=i.top,n.width=e.width-i.left-i.right,n.height=e.height-i.top-i.bottom,n}function ys(t,e){var n=e.domain(),i=n,r=t.stgns.tick.label;return!r&&t.formatter?r=t.formatter:!r&&e.data().fields&&(r=e.data().fields[0].formatter()),"function"==typeof r&&(i=n.map(r).map(String)),n.map(function(n,r){var o=i[r];return{value:n,label:o,pos:e.norm(parseFloat(n,10)),textMetrics:t.renderer.measureText({text:o,fontSize:t.stgns.tick.fontSize,fontFamily:t.stgns.tick.fontFamily})}})}function vs(t){var e="top"!==t.settings.dock&&"bottom"!==t.settings.dock,n=t.stgns.title,i=t.renderer.measureText({text:n.text,fontSize:n.fontSize,fontFamily:n.fontFamily}),r=t.renderer.textBounds({text:n.text,fontSize:n.fontSize,fontFamily:n.fontFamily,maxLines:n.maxLines,maxWidth:n.maxLengthPx,wordBreak:n.wordBreak,hyphens:n.hyphens,lineHeight:n.lineHeight}),o=t.chart.scale(t.stgns.fill),a=t.chart.scale(t.stgns.major),s=ys(t,a),c=ds(t.settings),u={isVertical:e,nodes:[],title:{anchor:gs(t.settings),textMetrics:i,textBounds:r,requiredWidth:function(){if(!n.show)return 0;var t=r.width,i=n.maxLengthPx;return e||(t+=n.padding,i+=n.padding),Math.min(t,i,u.rect.width)},requiredHeight:function(){if(!n.show)return 0;var t=r.height;return e&&(t+=n.padding),Math.min(t,u.rect.height)}},ticks:{values:s,anchor:c,length:Math.min(Math.max.apply(Math,zu(s.map(function(t){return t.textMetrics.width}))),t.stgns.tick.maxLengthPx),requiredHeight:function(){return"top"===c?Math.max.apply(Math,zu(u.ticks.values.map(function(t){return t.textMetrics.height})))+t.stgns.tick.padding:0},height:Math.max.apply(Math,zu(s.map(function(t){return t.textMetrics.height})))},legend:{fillScale:o,majorScale:a,length:function(){var n=e?"height":"width",i=e?"requiredHeight":"requiredWidth",r=Math.min(u.rect[n],u.rect[n]*t.stgns.length)-u.title[i]();return Math.max(0,Math.min(r,t.stgns.maxLengthPx))}}};return u}function ms(t){var e=t[0],n=t[t.length-1];e.x===n.x&&e.y===n.y||t.push(e)}function xs(t){for(var e=0;e<t.length-1;e++){var n=t[e],i=t[e+1];n.x===i.x&&n.y===i.y&&(t.splice(e,1),e--)}}function bs(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(dd,[null].concat(e)))}function ws(t,e){return gd.get(t)(e)}function ks(t){for(var e=void 0,n=[];null!==(e=yd.exec(t));){var i=e[2].trim(),r=-1===i.indexOf(",")?i.split(" "):i.split(",");n.push({cmd:e[1],args:r.filter(function(t){return t.trim().length>0}).map(function(t){return Number(t)})})}return n}function _s(t,e){var n=e.args[0]*(Math.PI/180);if(e.args.length>2){var i=e.args[1],r=e.args[2];t.translate(i,r),t.rotate(n),t.translate(-i,-r)}else 1===e.args.length&&t.rotate(n)}function Ms(t,e){var n=e.args[0],i=isNaN(e.args[1])?e.args[0]:e.args[1];t.scale(n,i)}function Ss(t,e){var n=e.args[0],i=isNaN(e.args[1])?0:e.args[1];t.translate(n,i)}function Rs(t,e){e.args.length>=6&&t.transform.apply(t,zu(e.args))}function zs(t,e){for(var n=ks(t),i=void 0,r=0,o=n.length;r<o;r++)"rotate"===(i=n[r]).cmd?_s(e,i):"scale"===i.cmd?Ms(e,i):"matrix"===i.cmd?Rs(e,i):"translate"===i.cmd&&Ss(e,i)}function Os(t,e){if(!e||!e.length||!t||"function"!=typeof md[t.type])return[];switch(t.type){case"type":return md[t.type](t.value,e);case"attr":return md[t.type](t.attribute,t.operator,t.attributeValue,e);case"universal":return md[t.type](e);case"tag":return md[t.type](t.value,e);default:return[]}}function Ns(t){var e=[],n=void 0,i=void 0,r=void 0,o=void 0;return t.split(/\s*,\s*/).forEach(function(t){t=t.trim(),n=[];for(;t&&(o=!1,(r=t.match(/^\s*([>+~]|\s)\s*/))&&(o=!0,n.push({type:" ",value:r[0]}),t=t.slice(r[0].length)),Object.keys(vd).forEach(function(e){(r=t.match(vd[e]))&&(o=!0,t=t.slice(r[0].length),i={type:e,value:r[0]},"attr"===e&&(r=r[0].match(/\[(\w[\w\._-]+)?(?:([!]?=)['\"]([\w\s#_-]*)['\"])?\]/),i.attribute=r[1],i.operator=r[2],i.attributeValue=r[3]),n.push(i))}),n&&n.length&&e.indexOf(n)<0&&e.push(n),o););}),e}function As(t,e){var n=t.collider();if(n&&n.fn){for(var i=t.modelViewMatrix,r=n.type,o=n.fn.points(),a=0,s=(o=i?i.transformPoints(o):o).length;a<s;a++)o[a].x/=e,o[a].y/=e;if("rect"===r||"bounds"===r){var c=w(o);return c.type="rect",c}if("circle"===r){var u=k(o,n.fn.r);return u.type="circle",u}if("line"===r){var l=_(o);return l.type="line",l}if("polygon"===r)return{type:"path",d:I(o)}}return null}function Es(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(bd,[null].concat(e)))}function Cs(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(wd,[null].concat(e)))}function Ts(t,e){var n=t.parent;if(n&&"stage"!==n.type){e.parent=Cs(n);var i=n.parent;i&&"stage"!==i.type&&Ts(i,e.parent)}}function js(t,e){for(var n=0,i=e.length;n<i;n++)e[n].input=t}function Ps(t,e,n){for(var i=t.descendants.length-1;i>=0;i--){var r=t.descendants[i],o=r._collider;if(o&&o.fn[e](n)){var a=Cs(r);return Ts(r,a),a}}return null}function Fs(t,e,n){var i=t._collider.fn,r=n;if(Array.isArray(n.vertices)&&(r=bs(n)),i[e](r)){var o=Cs(t);return Ts(t,o),o}return null}function Ls(t,e,n){var i={};if(t.modelViewMatrix)if(Array.isArray(n))i=t.inverseModelViewMatrix.transformPoints(n);else if(isNaN(n.r))Array.isArray(n.vertices)?i.vertices=t.inverseModelViewMatrix.transformPoints(n.vertices):i=t.inverseModelViewMatrix.transformPoint(n);else{var r={x:n.cx,y:n.cy},o=t.inverseModelViewMatrix.transformPoint(r);i.cx=o.x,i.cy=o.y,i.r=n.r}else i=n;if(Array.isArray(i.vertices)&&(i=bs(i)),t._collider.fn[e](i)){var a=Cs(t);return Ts(t,a),a}return null}function Ws(t,e,n){var i=t._collider;return null===i?null:"frontChild"===i.type?Ps(t,e,n):"bounds"===i.type?Fs(t,e,n):Ls(t,e,n)}function Ds(t,e,n,i){for(var r=t.length,o=0;o<r;o++){var a=t[o],s=Ws(a,e,i);s&&n.push(s),!a.children||s||a._collider||Ds(a.children,e,n,i)}}function Bs(t,e,n){for(var i=t.length,r=0;r<i;r++){var o=t[r];if(null!==Ws(o,e,n))return!0;if(o.children&&!o._collider)return Bs(o.children,e,n)}return!1}function Hs(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=t||{},i=n.x,r=n.y,o=n.width,a=n.height,s=n.x1,u=n.x2,l=n.y1,h=n.y2,f=n.cx,d=n.cy,g=n.r,p=n.vertices,y={},v=function(t){return"number"==typeof t&&!isNaN(t)};return v(f)&&v(d)&&v(g)?(y.cx=f*e,y.cy=d*e,y.r=g,["intersectsCircle",y]):v(s)&&v(u)&&v(l)&&v(h)?(y=m(t).map(function(t){return c(t,e)}),["intersectsLine",y]):v(i)&&v(r)&&v(o)&&v(a)?(y=x(t).map(function(t){return c(t,e)}),["intersectsRect",y]):v(i)&&v(r)?(y=c(t,e),["containsPoint",y]):Array.isArray(p)?(y.vertices=p.map(function(t){return c(t,e)}),["intersectsPolygon",y]):[]}function Is(t,e){var n=Hs(e,t.dpi),i=Ru(n,2),r=i[0],o=i[1],a=[];return r&&(Ds([t],r,a,o),js(e,a)),a}function Vs(t,e){var n=Hs(e,t.dpi),i=Ru(n,2);return Bs([t],i[0],i[1])}function Us(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0!==e.bounds){var i=e.bounds(n),r=Ru(i,3),o=r[0],a=r[2],s=o.x,c=o.y,u=a.x,l=a.y,h=isNaN(t._boundingRect.width)?u:Math.max(u,t._boundingRect.width+t._boundingRect.x),f=isNaN(t._boundingRect.height)?l:Math.max(l,t._boundingRect.height+t._boundingRect.y);t._boundingRect.x=isNaN(t._boundingRect.x)?s:Math.min(s,t._boundingRect.x),t._boundingRect.y=isNaN(t._boundingRect.y)?c:Math.min(c,t._boundingRect.y),t._boundingRect.width=h-t._boundingRect.x,t._boundingRect.height=f-t._boundingRect.y}}function qs(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(Nd,[null].concat(e)))}function Ys(t){if("string"!=typeof t)return[];for(var e=t.match(/[a-z][^a-z]*/gi),n=void 0,i=[],r=0;r<e.length;r++){var o=e[r].match(/([mlz])\s?(\S+)?(?:\s|,)?(\S+)?/i);if(Array.isArray(o)&&!isNaN(o[2])&&!isNaN(o[3])){var a=o[1],s=+o[2],c=+o[3];switch(a){case"M":case"L":n={x:s,y:c};break;case"m":case"l":n={x:n.x+s,y:n.y+c};break;default:continue}i.push(n)}}return i}function Xs(t,e){return Pd.get(t)(e)}function $s(t,e){if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++)e[n](t)}function Zs(t,e,n){t.node=n[e],t.index=e}function Gs(t,e,n,i){for(var r={siblings:t,node:null,index:0},o=0,a=t.length;o<a;o++)if(Zs(r,o,t),$s(r,i.create),!("function"==typeof r.node.disabled?r.node.disabled():r.node.disabled)){r.node=Fd.save(r.node);var s=Xs(r.node.type,r.node);s&&(r.node.transform&&(n.save(),zs(r.node.transform,n)),n.isIdentity()||(s.modelViewMatrix=n.clone()),e.addChild(s),r.node.children&&Gs(r.node.children,s,n,i),r.node.transform&&n.restore()),Fd.restore()}}function Js(t){var e=t.items,n=t.stage,i=t.dpi,r=t.on,o=void 0===r?{}:r;return n||(n=Xs("stage",i)),Gs(e,n,new pd,o),n}function Ks(t){return"string"==typeof t?-1!==t.search(Ld):-1!==String(t).search(Ld)}function Qs(t){return-1!==t.search(Wd)}function tc(t){return-1!==t.search(Dd)}function ec(t,e,n,i,r){return i.some(function(i){return i(t,e,n)})?Hd:r.some(function(i){return i(t,e,n)})?Bd:Id}function nc(t){""===t[0]&&t.shift(),""===t[t.length-1]&&t.pop()}function ic(t,e,n){return Math.max(e,Math.min(n,t))}function rc(t,e,n){return t?e>=0:e<n}function oc(){function t(t){var e=ic(t,0,m-1),n=v[e],i=c(n),r=ec(n,e,v,l,f);return{index:e,value:n,breakOpportunity:r,suppress:g.some(function(t){return t(n,e,v)}),hyphenation:y.some(function(t){return t(n,e,v)}),width:i.width,height:i.height,done:!1}}var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.string,i=e.separator,r=void 0===i?"":i,o=e.reverse,a=void 0!==o&&o,s=e.measureText,c=void 0===s?function(t){return{width:t.length,height:1}}:s,u=e.mandatoryBreakIdentifiers,l=void 0===u?[Ks]:u,h=e.noBreakAllowedIdentifiers,f=void 0===h?[]:h,d=e.suppressIdentifier,g=void 0===d?[Qs,Ks,function(t){return""===t}]:d,p=e.hyphenationIdentifiers,y=void 0===p?[tc]:p,v=String(n).split(r);nc(v);var m=v.length,x=a?m:-1;return{next:function(e){return isNaN(e)?a?x--:x++:x=ic(e,0,m-1),rc(a,x,m)?t(x):{done:!0}},peek:t,length:m}}function ac(t,e){var n=t.maxHeight,i=Math.max(t.maxLines,1)||1/0;if(isNaN(n))return i;var r=e*(t.lineHeight||Vd);return Math.max(1,Math.min(Math.floor(n/r),i))}function sc(t,e){return{lines:[],line:"",width:0,maxLines:ac(t,e(t.text).height),maxWidth:t.maxWidth,hyphens:{enabled:"auto"===t.hyphens,char:Ud,metrics:e(Ud)}}}function cc(t){t.lines.push(t.line),t.line="",t.width=0}function uc(t,e){t.line+=e.value,t.width+=e.width}function lc(t,e,n){if(e.width>t.maxWidth)return e;for(var i=e.index,r=1;r<5;r++){var o=n.peek(e.index-1);if(!e.hyphenation||!o.hyphenation||0===e.index)return e;if(t.width+t.hyphens.metrics.width<=t.maxWidth)return t.line+=t.hyphens.char,e;if(1===t.line.length)return e;e=n.next(i-r),t.line=t.line.slice(0,-1),t.width-=e.width}return e}function hc(t,e,n){for(var i=oc({string:e.value,measureText:n});t.lines.length<t.maxLines;){var r=i.next();if(r.done)break;t.width+r.width>t.maxWidth&&r.breakOpportunity===Id&&t.line.length>0?(r=t.hyphens.enabled?lc(t,r,i):r,cc(t),uc(t,r)):uc(t,r)}}function fc(t,e){for(var n=oc({string:t.text,separator:"",measureText:e,noBreakAllowedIdentifiers:[function(t,e){return 0===e}]}),i=sc(t,e),r=!0;i.lines.length<i.maxLines;){var o=n.next();if(o.done){cc(i),r=!1;break}o.breakOpportunity===Hd?cc(i):i.width+o.width>i.maxWidth&&o.breakOpportunity===Id?o.suppress?i.width+=o.width:(o=i.hyphens.enabled?lc(i,o,n):o,cc(i),uc(i,o)):uc(i,o)}return{lines:i.lines,reduced:r}}function dc(t,e){for(var n=oc({string:t.text,separator:/(\s|-|\u2010)/,measureText:e}),i=sc(t,e),r=!0;i.lines.length<i.maxLines;){var o=n.next();if(o.done){cc(i),r=!1;break}o.breakOpportunity===Hd?cc(i):i.width+o.width>i.maxWidth&&o.breakOpportunity===Id?o.suppress?cc(i):o.width>i.maxWidth?hc(i,o,e):(cc(i),uc(i,o)):uc(i,o)}return{lines:i.lines,reduced:r}}function gc(t,e,n){var i={type:"container",children:[]};void 0!==e.id&&(i.id=e.id);var r=0;return t.lines.forEach(function(o,a){var s=vu({},e);s.text=o,s._lineBreak=!0,t.reduced&&a===t.lines.length-1?s.text+=qd:delete s.maxWidth,s.dy=isNaN(s.dy)?r:s.dy+r,r+=n,i.children.push(s)}),i}function pc(t){return"text"===t.type&&!t._lineBreak}function yc(t,e){return function(n){return e({text:n,fontSize:t.fontSize,fontFamily:t.fontFamily})}}function vc(t){return{"break-all":fc,"break-word":dc}[t.wordBreak]}function mc(t){return function(e){var n=e.node;if(pc(n)){var i=vc(n);if(!i)return;var r=t(n);if(r.width<=n.maxWidth&&!Ks(n.text))return;var o=r.height*(n.lineHeight||Vd),a=i(n,yc(n,t));e.node=gc(a,n,o)}}}function xc(t,e){var n=t.text,i=t["font-size"],r=t["font-family"],o=t.maxWidth;if(n="string"==typeof n?n:""+n,void 0===o)return n;var a=e({text:n,fontSize:i,fontFamily:r}).width;if(a<=o)return n;for(var s=0,c=n.length-1;s<=c;){var u=Math.floor((s+c)/2);(a=e({text:n.substr(0,u)+qd,fontSize:i,fontFamily:r}).width)<=o?s=u+1:c=u-1}return n.substr(0,c)+qd}function bc(t){var e=t.text,n=t.fontSize,i=t.fontFamily,r=Xd[e+n+i];if(void 0!==r)return r;var o=($d=$d||document.createElement("canvas")).getContext("2d");o.font=n+" "+i;var a=o.measureText(e).width;return Xd[e+n+i]=a,a}function wc(t){var e=t.fontSize,n=t.fontFamily,i=Yd[e+n];if(void 0!==i)return i;var r=1.2*bc({text:"M",fontSize:e,fontFamily:n});return Yd[e+n]=r,r}function kc(t){var e=t.text,n=t.fontSize,i=t.fontFamily;return{width:bc({text:e,fontSize:n,fontFamily:i}),height:wc({fontSize:n,fontFamily:i})}}function _c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kc,n=t["font-size"]||t.fontSize,i=t["font-family"]||t.fontFamily,r=e({text:t.text,fontFamily:i,fontSize:n}),o=Math.min(t.maxWidth||r.width,r.width),a=t.x||0,s=t.y||0,c=t.dx||0,u={x:0,y:s+(t.dy||0)-.75*r.height,width:o,height:r.height},l=t["text-anchor"]||t.anchor;return u.x="middle"===l?a+c-o/2:"end"===l?a+c-o:a+c,u}function Mc(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kc,n=vc(t);if(n){for(var i=t["font-size"]||t.fontSize,r=t["font-family"]||t.fontFamily,o=n(t,function(t){return e({text:t,fontFamily:r,fontSize:i})}),a=vu({},t),s=0,c="",u=0,l=o.lines.length;u<l;u++){var h=o.lines[u],f=bc({text:h+=u===l-1&&o.reduced?qd:"",fontSize:i,fontFamily:r});f>=s&&(s=f,c=h)}a.text=c;var d=_c(a,e),g=t.lineHeight||Vd;return d.height=d.height*o.lines.length*g,d}return _c(t,e)}function Sc(t,e,n){var i=n.orientation,r=n.degree,o=n.stops,a=void 0===o?[]:o,s=null;if("radial"===i){var c=e.width||0,u=e.height||0,l=void 0!==e.x?e.x:e.cx,h=void 0!==e.y?e.y:e.cy;s=t.createRadialGradient(l+c/2,h+u/2,1,l+c/2,h+u/2,e.r||Math.max(e.width,e.height)/2)}else{var f=Cn(r),d=e.width||2*e.r,g=e.height||2*e.r,p=void 0!==e.x?e.x:e.cx-e.r,y=void 0!==e.y?e.y:e.cy-e.r;s=t.createLinearGradient(p+f.x1*d,y+f.y1*g,p+f.x2*d,y+f.y2*g)}for(var v=0,m=a.length;v<m;v++){var x=a[v];s.addColorStop(x.offset,x.color)}return s}function Rc(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=t.y,i=t.width,r=t.height,o=t.scaleRatio,a=t.margin,s={x:0,y:0,width:0,height:0,scaleRatio:{x:1,y:1},margin:{left:0,top:0}};return s.x=isNaN(e)?s.x:e,s.y=isNaN(n)?s.y:n,s.width=isNaN(i)?s.width:i,s.height=isNaN(r)?s.height:r,void 0!==o&&(s.scaleRatio.x=isNaN(o.x)?s.scaleRatio.x:o.x,s.scaleRatio.y=isNaN(o.y)?s.scaleRatio.y:o.y),void 0!==a&&(s.margin.left=isNaN(a.left)?0:a.left,s.margin.top=isNaN(a.top)?0:a.top),s}function zc(t){return Array.isArray(t)?t:"string"==typeof t?-1!==t.indexOf(",")?t.split(","):t.split(" "):[]}function Oc(t){return("undefined"==typeof window?1:window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}function Nc(t,e){e.setTransform(t[0][0],t[1][0],t[0][1],t[1][1],t[0][2],t[1][2])}function Ac(t,e,n){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=Object.keys(i),o=0,a=n.length;o<a;o++){var s=n[o],c=s[0],u=s[1],l=s[2];if(c in e.attrs&&!(u in i)&&t[u]!==e.attrs[c]){var h=l?l(e.attrs[c]):e.attrs[c];"function"==typeof t[u]?t[u](h):t[u]=h}}for(var f=0,d=r.length;f<d;f++){var g=r[f];t[g]=i[g]}}function Ec(t,e,n){for(var i=0,r=t.length;i<r;i++){var o=t[i],a={};e.save(),o.attrs&&(o.attrs.fill||o.attrs.stroke)&&(o.attrs.fill&&"object"===xu(o.attrs.fill)&&"gradient"===o.attrs.fill.type&&(a.fillStyle=Sc(e,o.attrs,o.attrs.fill)),o.attrs.stroke&&"object"===xu(o.attrs.stroke)&&"gradient"===o.attrs.stroke.type&&(a.strokeStyle=Sc(e,o.attrs,o.attrs.stroke))),Ac(e,o,n,a),o.modelViewMatrix&&Nc(o.modelViewMatrix.elements,e),Zd.has(o.type)&&Zd.get(o.type)(o.attrs,{g:e,doFill:"fill"in o.attrs&&"none"!==o.attrs.fill,doStroke:"stroke"in o.attrs&&0!==o.attrs["stroke-width"]}),o.children&&Ec(o.children,e,n),e.restore()}}function Cc(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Js,e=void 0,n=void 0,i=!1,r=Rc(),o=[["fill","fillStyle"],["stroke","strokeStyle"],["opacity","globalAlpha"],["globalAlpha","globalAlpha"],["stroke-width","lineWidth"],["stroke-dasharray","setLineDash",zc]],a=function(){};return a.element=function(){return e},a.root=function(){return e},a.appendTo=function(t){return e||((e=t.ownerDocument.createElement("canvas")).style.position="absolute",e.style["-webkit-font-smoothing"]="antialiased",e.style["-moz-osx-font-smoothing"]="antialiased",e.style.pointerEvents="none"),t.appendChild(e),e},a.render=function(s){if(!e)return!1;var c=e.getContext("2d"),u=Oc(c),l=r.scaleRatio.x,h=r.scaleRatio.y;i&&(e.style.left=Math.round(r.margin.left+r.x*l)+"px",e.style.top=Math.round(r.margin.top+r.y*h)+"px",e.style.width=Math.round(r.width*l)+"px",e.style.height=Math.round(r.height*h)+"px",e.width=Math.round(r.width*u*l),e.height=Math.round(r.height*u*h));var f={type:"container",children:s};1===u&&1===l&&1===h||(f.transform="scale("+u*l+", "+u*h+")");var d=t({items:[f],dpi:u,on:{create:[mc(kc)]}}),g=!n||!d.equals(n),p=i||g;return p&&(a.clear(),Ec(d.children,c,o)),i=!1,n=d,p},a.itemsAt=function(t){return n?n.getItemsFrom(t):[]},a.findShapes=function(t){return n?n.findShapes(t).map(function(t){return t.element=a.element(),t}):[]},a.clear=function(){e&&(e.width=e.width)},a.size=function(t){if(t){var e=Rc(t);JSON.stringify(r)!==JSON.stringify(e)&&(i=!0,r=e)}return r},a.destroy=function(){e&&(e.parentElement&&e.parentElement.removeChild(e),e=null),n=null},a.measureText=function(t){return kc({text:t.text,fontSize:t.fontSize,fontFamily:t.fontFamily})},a.textBounds=function(t){return Mc(t)},a}function Tc(t,e){Zd.add(t,e)}function jc(t){return Gd.test(t)}function Pc(t){return Jd.test(t)||Kd.test(t)}function Fc(t){var e=t?t.length:0,n=void 0,i=void 0;for(n=0;n<e;n++){if(i=t[n],jc(i))return"ltr";if(Pc(i))return"rtl"}return"ltr"}function Lc(t,e){return"rtl"===e?Qd[t]:t}function Wc(t){return"central"===t?"middle":"text-before-edge"===t?"top":"text-after-edge"===t?"bottom":t}function Dc(t,e){var n=[],i=void 0,r=[],o=[],a=[],s=void 0,c=void 0,u=function(t){return t.id},l=function(t,e){var n=void 0;return n="object"===(void 0===t?"undefined":xu(t))?"id"in t?t.id:e:t,{content:t,id:n+"__"+(t.type||"")}};t.isTree||(t=t.map(l)),e=e.map(l),s=t.map(u),c=e.map(u);for(var h=0,f=e.length;h<f;h++)-1===s.indexOf(e[h].id)?n.push(e[h]):o.push(e[h]);for(var d=0,g=t.length;d<g;d++)-1===c.indexOf(t[d].id)?r.push(t[d]):a.push(t[d]);for(var p=0,y=n.length;p<y;p++)n[p].content.children&&(n[p].diff=Dc([],n[p].content.children),n[p].children=n[p].diff.updatedNew.concat(n[p].diff.added),n[p].children.isTree=!0);for(var v=0,m=o.length;v<m;v++)o[v].diff=Dc(a[v].children||[],o[v].content.children||[]),o[v].object=a[v].object,o[v].children=o[v].diff.items;return i=o.concat(n),n.isTree=!0,r.isTree=!0,o.isTree=!0,a.isTree=!0,i.isTree=!0,{added:n,updatedNew:o,updatedOld:a,removed:r,items:i}}function Bc(t,e,n){for(var i=0,r=t.length;i<r;i++)t[i].object=n(t[i].content.type,e)}function Hc(t,e){for(var n=0,i=t.length;n<i;n++)null!==t[n].object&&void 0!==t[n].object&&(e(t[n].object),t[n].object=null)}function Ic(t,e,n,i){for(var r=void 0,o=0,a=t.length;o<a;o++)null!==(r=t[o]).object&&void 0!==r.object&&(n(r.object,r.content),r.diff&&(Bc(r.diff.added,r.object,e),Hc(r.diff.removed,i),Ic(r.diff.items,e,n,i)))}function Vc(t,e,n,i,r,o){var a=Dc(t,e);return Bc(a.added,n,i),Hc(a.removed,o),Ic(a.items,i,r,o),a.items}function Uc(){return new rg(Vc,eg,ig,ng)}function qc(t){var e=0,n=void 0,i=void 0;if(0===(t=JSON.stringify(t)).length)return e;for(n=0,i=t.length;n<i;n++)e=(e<<5)-e+t.charCodeAt(n),e&=e;return e}function Yc(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fill",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=qc(t[e]),r="";if(void 0!==ag[i])r=ag[i];else{var o=t[e],a=o.orientation,s=o.degree,c=o.stops,u=void 0===c?[]:c,l={};void 0===s&&(s=90),"radial"===a?l.type="radialGradient":(l=Cn(s)).type="linearGradient",l.id="picasso-gradient-"+i,l.children=u.map(function(t){return{type:"stop",offset:100*t.offset+"%",style:"stop-color:"+t.color+";stop-opacity:"+(t.opacity||1)}}),og.push(l),ag[i]=l.id,r=l.id}return"url("+n+"#"+r+")"}function Xc(){og=[],ag={}}function $c(t){var e="";"undefined"!=typeof window&&(e=window.location.href.split("#")[0]);var n=t.node;n.fill&&"object"===xu(n.fill)&&"gradient"===n.fill.type&&(n.fill=Yc(n,"fill",e)),n.stroke&&"object"===xu(n.stroke)&&"gradient"===n.stroke.type&&(n.stroke=Yc(n,"stroke",e))}function Zc(){return{type:"defs",children:og,disabled:function(){return 0===og.length}}}function Gc(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Uc,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tg,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Js,i=t(),r=void 0,o=void 0,a=!1,s=Rc(),c=void 0,u=function(){};return u.element=function(){return r},u.root=function(){return o},u.appendTo=function(t){return r||((r=t.ownerDocument.createElementNS(e,"svg")).style.position="absolute",r.style["-webkit-font-smoothing"]="antialiased",r.style["-moz-osx-font-smoothing"]="antialiased",r.style.pointerEvents="none",r.setAttribute("xmlns",e),(o=t.ownerDocument.createElementNS(e,"g")).style.pointerEvents="auto",r.appendChild(o)),t.appendChild(r),r},u.render=function(t){if(!r)return!1;var e=s.scaleRatio.x,l=s.scaleRatio.y;a&&(r.style.left=Math.round(s.margin.left+s.x*e)+"px",r.style.top=Math.round(s.margin.top+s.y*l)+"px",r.setAttribute("width",Math.round(s.width*e)),r.setAttribute("height",Math.round(s.height*l))),Xc();var h={type:"container",children:Array.isArray(t)?[].concat(zu(t),[Zc()]):t};1===e&&1===l||(h.transform="scale("+e+", "+l+")");var f=n({items:[h],on:{create:[$c,mc(kc)]}}),d=!c||!f.equals(c),g=a||d;return g&&(u.clear(),i.render(f.children,o)),a=!1,c=f,g},u.itemsAt=function(t){return c?c.getItemsFrom(t):[]},u.findShapes=function(t){return c?c.findShapes(t).map(function(t){return t.element=u.element(),t}):[]},u.clear=function(){if(!o)return u;var t=o.cloneNode(!1);return r.replaceChild(t,o),o=t,u},u.destroy=function(){r&&r.parentElement&&r.parentElement.removeChild(r),r=null,o=null},u.size=function(t){if(t){var e=Rc(t);JSON.stringify(s)!==JSON.stringify(e)&&(a=!0,s=e)}return s},u.measureText=function(t){return kc({text:t.text,fontSize:t.fontSize,fontFamily:t.fontFamily})},u.textBounds=function(t){return Mc(t)},u}function Jc(t){return void 0===t}function Kc(t){return void 0!==t}function Qc(t,e){return t.key===e.key&&t.sel===e.sel}function tu(t,e,n){var i,r,o={};for(i=e;i<=n;++i)Kc(r=t[i].key)&&(o[r]=i);return o}function eu(t,e){var n,i,r,o=e.elm,a=t.data.attrs,s=e.data.attrs;if(a||s){a=a||{},s=s||{};for(n in s)i=s[n],a[n]!==i&&(!i&&pg[n]?o.removeAttribute(n):(r=n.split(":")).length>1&&dg.hasOwnProperty(r[0])?o.setAttributeNS(dg[r[0]],n,i):o.setAttribute(n,i));for(n in a)n in s||o.removeAttribute(n)}}function nu(t,e){var n,i,r=e.elm,o=t.data.class,a=e.data.class;if(o||a){o=o||{},a=a||{};for(i in o)a[i]||r.classList.remove(i);for(i in a)(n=a[i])!==o[i]&&r.classList[n?"add":"remove"](i)}}function iu(t,e,n){wg(function(){t[e]=n})}function ru(t,e){var n,i,r=e.elm,o=t.data.style,a=e.data.style;if(o||a){o=o||{},a=a||{};var s="delayed"in o;for(i in o)a[i]||(r.style[i]="");for(i in a)if(n=a[i],"delayed"===i)for(i in a.delayed)n=a.delayed[i],s&&n===o.delayed[i]||iu(r.style,i,n);else"remove"!==i&&n!==o[i]&&(r.style[i]=n)}}function ou(t,e,n){if("function"==typeof t)t.call(e,n,e);else if("object"==typeof t)if("function"==typeof t[0])if(2===t.length)t[0].call(e,t[1],n,e);else{var i=t.slice(1);i.push(n),i.push(e),t[0].apply(e,i)}else for(var r=0;r<t.length;r++)ou(t[r])}function au(t,e){var n=t.type,i=e.data.on;i&&i[n]&&ou(i[n],e,t)}function su(){return function t(e){au(e,t.vnode)}}function cu(t,e){var n,i=t.data.on,r=t.listener,o=t.elm,a=e&&e.data.on,s=e&&e.elm;if(i!==a){if(i&&r)if(a)for(n in i)a[n]||o.removeEventListener(n,r,!1);else for(n in i)o.removeEventListener(n,r,!1);if(a){var c=e.listener=t.listener||su();if(c.vnode=e,i)for(n in a)i[n]||s.addEventListener(n,c,!1);else for(n in a)s.addEventListener(n,c,!1)}}}function uu(t,e,n){if(t.ns="http://www.w3.org/2000/svg","foreignObject"!==n&&void 0!==e)for(var i=0;i<e.length;++i)uu(e[i].data,e[i].children,e[i].sel)}function lu(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).createElement,e=void 0===t?document.createElement.bind(document):t,n=void 0,i=Rc(),r=void 0,o=function(){};return o.element=function(){return n},o.root=function(){return n},o.itemsAt=function(){return[]},o.findShapes=function(){return[]},o.appendTo=function(t){return n||((n=e("div")).style.position="absolute",n.style["-webkit-font-smoothing"]="antialiased",n.style["-moz-osx-font-smoothing"]="antialiased",n.style.pointerEvents="none"),t.appendChild(n),n},o.render=function(t){if(!n)return!1;var e=i.scaleRatio.x,o=i.scaleRatio.y;n.style.left=Math.round(i.margin.left+i.x*e)+"px",n.style.top=Math.round(i.margin.left+i.y*o)+"px",n.style.width=Math.round(i.width*e)+"px",n.style.height=Math.round(i.height*o)+"px";var a=Mg("div",{},Array.isArray(t)?t:[t]);return r?Sg(r,a):Sg(n,a),r=a,!0},o.renderArgs=[Mg],o.clear=function(){if(n){for(var t=n.firstChild;t;)n.removeChild(t),t=n.firstChild;r=null}},o.destroy=function(){n&&n.parentElement&&n.parentElement.removeChild(n),n=null},o.size=function(t){return t&&(i=Rc(t)),i},o.measureText=function(t){return kc({text:t.text,fontSize:t.fontSize,fontFamily:t.fontFamily})},o.textBounds=function(){return{x:0,y:0,width:0,height:0}},o}function hu(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(arguments[2],e)}function fu(){function t(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=vu({palettes:[]},e,t);return n.palettes=e.palettes.concat(t.palettes||[]),fu(n,r)}var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Ng(e.logger),r={component:kt(n.component),data:kt(n.data),formatter:kt(n.formatter),interaction:kt(n.interaction),renderer:gf(n.renderer),scale:kt(n.scale),symbol:kt(n.symbol),logger:i,dataset:lr,field:Se};return e.renderer&&e.renderer.prio&&r.renderer.default(e.renderer.prio[0]),t.use=function(t){return hu(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r)},t.chart=function(t){return nr(t,{registries:r,logger:i,style:e.style,palettes:e.palettes})},t.config=function(){return e},Object.keys(r).forEach(function(e){t[e]=r[e]}),t}var du=Object.prototype.hasOwnProperty,gu=Object.prototype.toString,pu=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===gu.call(t)},yu=function(t){if(!t||"[object Object]"!==gu.call(t))return!1;var e=du.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&du.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!n)return!1;var i;for(i in t);return void 0===i||du.call(t,i)},vu=function t(){var e,n,i,r,o,a,s=arguments[0],c=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},c=2),(null==s||"object"!=typeof s&&"function"!=typeof s)&&(s={});c<u;++c)if(null!=(e=arguments[c]))for(n in e)i=s[n],s!==(r=e[n])&&(l&&r&&(yu(r)||(o=pu(r)))?(o?(o=!1,a=i&&pu(i)?i:[]):a=i&&yu(i)?i:{},s[n]=t(l,a,r)):void 0!==r&&(s[n]=r));return s},mu=[],xu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bu=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},wu=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),ku=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},_u=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},Mu=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},Su=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},Ru=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),zu=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},Ou=1e-12,Nu=Math.PI,Au=2*Nu,Eu=Au-1e-6;U.prototype=q.prototype={constructor:U,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var o=this._x1,a=this._y1,s=n-t,c=i-e,u=o-t,l=a-e,h=u*u+l*l;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>1e-6)if(Math.abs(l*s-c*u)>1e-6&&r){var f=n-o,d=i-a,g=s*s+c*c,p=f*f+d*d,y=Math.sqrt(g),v=Math.sqrt(h),m=r*Math.tan((Nu-Math.acos((g+h-p)/(2*y*v)))/2),x=m/v,b=m/y;Math.abs(x-1)>1e-6&&(this._+="L"+(t+x*u)+","+(e+x*l)),this._+="A"+r+","+r+",0,0,"+ +(l*f>u*d)+","+(this._x1=t+b*s)+","+(this._y1=e+b*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,i,r,o){t=+t,e=+e;var a=(n=+n)*Math.cos(i),s=n*Math.sin(i),c=t+a,u=e+s,l=1^o,h=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+u:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-u)>1e-6)&&(this._+="L"+c+","+u),n&&(h<0&&(h=h%Au+Au),h>Eu?this._+="A"+n+","+n+",0,1,"+l+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+l+","+(this._x1=c)+","+(this._y1=u):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=Nu)+","+l+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var Cu=function(t){return function(){return t}},Tu=Math.abs,ju=Math.atan2,Pu=Math.cos,Fu=Math.max,Lu=Math.min,Wu=Math.sin,Du=Math.sqrt,Bu=1e-12,Hu=Math.PI,Iu=Hu/2,Vu=2*Hu,Uu=function(){function t(){var t,u,l=+e.apply(this,arguments),h=+n.apply(this,arguments),f=o.apply(this,arguments)-Iu,d=a.apply(this,arguments)-Iu,g=Tu(d-f),p=d>f;if(c||(c=t=q()),h<l&&(u=h,h=l,l=u),h>Bu)if(g>Vu-Bu)c.moveTo(h*Pu(f),h*Wu(f)),c.arc(0,0,h,f,d,!p),l>Bu&&(c.moveTo(l*Pu(d),l*Wu(d)),c.arc(0,0,l,d,f,p));else{var y,v,m=f,x=d,b=f,w=d,k=g,_=g,M=s.apply(this,arguments)/2,S=M>Bu&&(r?+r.apply(this,arguments):Du(l*l+h*h)),R=Lu(Tu(h-l)/2,+i.apply(this,arguments)),z=R,O=R;if(S>Bu){var N=X(S/l*Wu(M)),A=X(S/h*Wu(M));(k-=2*N)>Bu?(N*=p?1:-1,b+=N,w-=N):(k=0,b=w=(f+d)/2),(_-=2*A)>Bu?(A*=p?1:-1,m+=A,x-=A):(_=0,m=x=(f+d)/2)}var E=h*Pu(m),C=h*Wu(m),T=l*Pu(w),j=l*Wu(w);if(R>Bu){var P=h*Pu(x),F=h*Wu(x),L=l*Pu(b),W=l*Wu(b);if(g<Hu){var D=k>Bu?Q(E,C,L,W,P,F,T,j):[T,j],B=E-D[0],H=C-D[1],I=P-D[0],V=F-D[1],U=1/Wu(Y((B*I+H*V)/(Du(B*B+H*H)*Du(I*I+V*V)))/2),$=Du(D[0]*D[0]+D[1]*D[1]);z=Lu(R,(l-$)/(U-1)),O=Lu(R,(h-$)/(U+1))}}_>Bu?O>Bu?(y=tt(L,W,E,C,h,O,p),v=tt(P,F,T,j,h,O,p),c.moveTo(y.cx+y.x01,y.cy+y.y01),O<R?c.arc(y.cx,y.cy,O,ju(y.y01,y.x01),ju(v.y01,v.x01),!p):(c.arc(y.cx,y.cy,O,ju(y.y01,y.x01),ju(y.y11,y.x11),!p),c.arc(0,0,h,ju(y.cy+y.y11,y.cx+y.x11),ju(v.cy+v.y11,v.cx+v.x11),!p),c.arc(v.cx,v.cy,O,ju(v.y11,v.x11),ju(v.y01,v.x01),!p))):(c.moveTo(E,C),c.arc(0,0,h,m,x,!p)):c.moveTo(E,C),l>Bu&&k>Bu?z>Bu?(y=tt(T,j,P,F,l,-z,p),v=tt(E,C,L,W,l,-z,p),c.lineTo(y.cx+y.x01,y.cy+y.y01),z<R?c.arc(y.cx,y.cy,z,ju(y.y01,y.x01),ju(v.y01,v.x01),!p):(c.arc(y.cx,y.cy,z,ju(y.y01,y.x01),ju(y.y11,y.x11),!p),c.arc(0,0,l,ju(y.cy+y.y11,y.cx+y.x11),ju(v.cy+v.y11,v.cx+v.x11),p),c.arc(v.cx,v.cy,z,ju(v.y11,v.x11),ju(v.y01,v.x01),!p))):c.arc(0,0,l,w,b,p):c.lineTo(T,j)}else c.moveTo(0,0);if(c.closePath(),t)return c=null,t+""||null}var e=$,n=Z,i=Cu(0),r=null,o=G,a=J,s=K,c=null;return t.centroid=function(){var t=(+e.apply(this,arguments)+ +n.apply(this,arguments))/2,i=(+o.apply(this,arguments)+ +a.apply(this,arguments))/2-Hu/2;return[Pu(i)*t,Wu(i)*t]},t.innerRadius=function(n){return arguments.length?(e="function"==typeof n?n:Cu(+n),t):e},t.outerRadius=function(e){return arguments.length?(n="function"==typeof e?e:Cu(+e),t):n},t.cornerRadius=function(e){return arguments.length?(i="function"==typeof e?e:Cu(+e),t):i},t.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:Cu(+e),t):r},t.startAngle=function(e){return arguments.length?(o="function"==typeof e?e:Cu(+e),t):o},t.endAngle=function(e){return arguments.length?(a="function"==typeof e?e:Cu(+e),t):a},t.padAngle=function(e){return arguments.length?(s="function"==typeof e?e:Cu(+e),t):s},t.context=function(e){return arguments.length?(c=null==e?null:e,t):c},t};et.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var qu=function(t){return new et(t)},Yu=function(){function t(t){var s,c,u,l=t.length,h=!1;for(null==r&&(a=o(u=q())),s=0;s<=l;++s)!(s<l&&i(c=t[s],s,t))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+e(c,s,t),+n(c,s,t));if(u)return a=null,u+""||null}var e=nt,n=it,i=Cu(!0),r=null,o=qu,a=null;return t.x=function(n){return arguments.length?(e="function"==typeof n?n:Cu(+n),t):e},t.y=function(e){return arguments.length?(n="function"==typeof e?e:Cu(+e),t):n},t.defined=function(e){return arguments.length?(i="function"==typeof e?e:Cu(!!e),t):i},t.curve=function(e){return arguments.length?(o=e,null!=r&&(a=o(r)),t):o},t.context=function(e){return arguments.length?(null==e?r=a=null:a=o(r=e),t):r},t},Xu=function(){function t(t){var e,l,h,f,d,g=t.length,p=!1,y=new Array(g),v=new Array(g);for(null==s&&(u=c(d=q())),e=0;e<=g;++e){if(!(e<g&&a(f=t[e],e,t))===p)if(p=!p)l=e,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),h=e-1;h>=l;--h)u.point(y[h],v[h]);u.lineEnd(),u.areaEnd()}p&&(y[e]=+n(f,e,t),v[e]=+r(f,e,t),u.point(i?+i(f,e,t):y[e],o?+o(f,e,t):v[e]))}if(d)return u=null,d+""||null}function e(){return Yu().defined(a).curve(c).context(s)}var n=nt,i=null,r=Cu(0),o=it,a=Cu(!0),s=null,c=qu,u=null;return t.x=function(e){return arguments.length?(n="function"==typeof e?e:Cu(+e),i=null,t):n},t.x0=function(e){return arguments.length?(n="function"==typeof e?e:Cu(+e),t):n},t.x1=function(e){return arguments.length?(i=null==e?null:"function"==typeof e?e:Cu(+e),t):i},t.y=function(e){return arguments.length?(r="function"==typeof e?e:Cu(+e),o=null,t):r},t.y0=function(e){return arguments.length?(r="function"==typeof e?e:Cu(+e),t):r},t.y1=function(e){return arguments.length?(o=null==e?null:"function"==typeof e?e:Cu(+e),t):o},t.lineX0=t.lineY0=function(){return e().x(n).y(r)},t.lineY1=function(){return e().x(n).y(o)},t.lineX1=function(){return e().x(i).y(r)},t.defined=function(e){return arguments.length?(a="function"==typeof e?e:Cu(!!e),t):a},t.curve=function(e){return arguments.length?(c=e,null!=s&&(u=c(s)),t):c},t.context=function(e){return arguments.length?(null==e?s=u=null:u=c(s=e),t):s},t},$u=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},Zu=function(t){return t},Gu=function(){function t(t){var s,c,u,l,h,f=t.length,d=0,g=new Array(f),p=new Array(f),y=+r.apply(this,arguments),v=Math.min(Vu,Math.max(-Vu,o.apply(this,arguments)-y)),m=Math.min(Math.abs(v)/f,a.apply(this,arguments)),x=m*(v<0?-1:1);for(s=0;s<f;++s)(h=p[g[s]=s]=+e(t[s],s,t))>0&&(d+=h);for(null!=n?g.sort(function(t,e){return n(p[t],p[e])}):null!=i&&g.sort(function(e,n){return i(t[e],t[n])}),s=0,u=d?(v-f*x)/d:0;s<f;++s,y=l)c=g[s],l=y+((h=p[c])>0?h*u:0)+x,p[c]={data:t[c],index:s,value:h,startAngle:y,endAngle:l,padAngle:m};return p}var e=Zu,n=$u,i=null,r=Cu(0),o=Cu(Vu),a=Cu(0);return t.value=function(n){return arguments.length?(e="function"==typeof n?n:Cu(+n),t):e},t.sortValues=function(e){return arguments.length?(n=e,i=null,t):n},t.sort=function(e){return arguments.length?(i=e,n=null,t):i},t.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:Cu(+e),t):r},t.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:Cu(+e),t):o},t.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:Cu(+e),t):a},t},Ju=Array.prototype.slice;ot.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:rt(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:rt(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};st.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:at(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:at(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ku=function t(e){function n(t){return new st(t,e)}return n.tension=function(e){return t(+e)},n}(0);ut.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:ct(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Qu=function t(e){function n(t){return e?new ut(t,e):new st(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);gt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:dt(this,this._t0,ft(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,t!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,dt(this,ft(this,n=ht(this,t,e)),n);break;default:dt(this,this._t0,n=ht(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(pt.prototype=Object.create(gt.prototype)).point=function(t,e){gt.prototype.point.call(this,e,t)},yt.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,o){this._context.bezierCurveTo(e,t,i,n,o,r)}},vt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var i=mt(t),r=mt(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(i[0][o],r[0][o],i[1][o],r[1][o],t[a],e[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};xt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var tl,el=function(t,e){if((r=t.length)>1)for(var n,i,r,o=1,a=t[e[0]],s=a.length;o<r;++o)for(i=a,a=t[e[o]],n=0;n<s;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]},nl=function(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n},il=function(){function t(t){var o,a,s=e.apply(this,arguments),c=t.length,u=s.length,l=new Array(u);for(o=0;o<u;++o){for(var h,f=s[o],d=l[o]=new Array(c),g=0;g<c;++g)d[g]=h=[0,+r(t[g],f,g,t)],h.data=t[g];d.key=f}for(o=0,a=n(l);o<u;++o)l[a[o]].index=o;return i(l,a),l}var e=Cu([]),n=nl,i=el,r=bt;return t.keys=function(n){return arguments.length?(e="function"==typeof n?n:Cu(Ju.call(n)),t):e},t.value=function(e){return arguments.length?(r="function"==typeof e?e:Cu(+e),t):r},t.order=function(e){return arguments.length?(n=null==e?nl:"function"==typeof e?e:Cu(Ju.call(e)),t):n},t.offset=function(e){return arguments.length?(i=null==e?el:e,t):i},t},rl=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]},ol=function(t){return(t=rl(Math.abs(t)))?t[1]:NaN},al=function(t,e){return function(n,i){for(var r=n.length,o=[],a=0,s=t[0],c=0;r>0&&s>0&&(c+s+1>i&&(s=Math.max(1,i-c)),o.push(n.substring(r-=s,r+s)),!((c+=s+1)>i));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}},sl=function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}},cl=function(t,e){var n=rl(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")},ul={"":function(t,e){t:for(var n,i=(t=t.toPrecision(e)).length,r=1,o=-1;r<i;++r)switch(t[r]){case".":o=n=r;break;case"0":0===o&&(o=r),n=r;break;case"e":break t;default:o>0&&(o=0)}return o>0?t.slice(0,o)+t.slice(n+1):t},"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return cl(100*t,e)},r:cl,s:function(t,e){var n=rl(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(tl=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+rl(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},ll=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;_t.prototype=Mt.prototype,Mt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var hl,fl,dl,gl=function(t){return t},pl=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],yl=function(t){function e(t){function e(t){var e,i,a,l=y,b=v;if("c"===p)b=m(t)+b,t="";else{var w=(t=+t)<0;if(t=m(Math.abs(t),g),w&&0==+t&&(w=!1),l=(w?"("===u?u:"-":"-"===u||"("===u?"":u)+l,b=b+("s"===p?pl[8+tl/3]:"")+(w&&"("===u?")":""),x)for(e=-1,i=t.length;++e<i;)if(48>(a=t.charCodeAt(e))||a>57){b=(46===a?r+t.slice(e+1):t.slice(e))+b,t=t.slice(0,e);break}}d&&!h&&(t=n(t,1/0));var k=l.length+t.length+b.length,_=k<f?new Array(f-k+1).join(s):"";switch(d&&h&&(t=n(_+t,_.length?f-b.length:1/0),_=""),c){case"<":t=l+t+b+_;break;case"=":t=l+_+t+b;break;case"^":t=_.slice(0,k=_.length>>1)+l+t+b+_.slice(k);break;default:t=_+l+t+b}return o(t)}var s=(t=_t(t)).fill,c=t.align,u=t.sign,l=t.symbol,h=t.zero,f=t.width,d=t.comma,g=t.precision,p=t.type,y="$"===l?i[0]:"#"===l&&/[boxX]/.test(p)?"0"+p.toLowerCase():"",v="$"===l?i[1]:/[%p]/.test(p)?a:"",m=ul[p],x=!p||/[defgprs%]/.test(p);return g=null==g?p?6:12:/[gprs]/.test(p)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),e.toString=function(){return t+""},e}var n=t.grouping&&t.thousands?al(t.grouping,t.thousands):gl,i=t.currency,r=t.decimal,o=t.numerals?sl(t.numerals):gl,a=t.percent||"%";return{format:e,formatPrefix:function(t,n){var i=e((t=_t(t),t.type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(ol(n)/3))),o=Math.pow(10,-r),a=pl[8+r/3];return function(t){return i(o*t)+a}}}};!function(t){hl=yl(t),fl=hl.format,dl=hl.formatPrefix}({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var vl=function(t){return Math.max(0,-ol(Math.abs(t)))},ml=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ol(e)/3)))-ol(Math.abs(t)))},xl=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ol(e)-ol(t))+1},bl=new Date,wl=new Date,kl=St(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});kl.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?St(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):kl:null};var _l=6e4,Ml=6048e5,Sl=(St(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),St(function(t){t.setTime(Math.floor(t/_l)*_l)},function(t,e){t.setTime(+t+e*_l)},function(t,e){return(e-t)/_l},function(t){return t.getMinutes()}),St(function(t){var e=t.getTimezoneOffset()*_l%36e5;e<0&&(e+=36e5),t.setTime(36e5*Math.floor((+t-e)/36e5)+e)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()}),St(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*_l)/864e5},function(t){return t.getDate()-1})),Rl=Rt(0),zl=Rt(1),Ol=(Rt(2),Rt(3),Rt(4),Rt(5),Rt(6),St(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),St(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()}));Ol.every=function(t){return isFinite(t=Math.floor(t))&&t>0?St(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};St(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*_l)},function(t,e){return(e-t)/_l},function(t){return t.getUTCMinutes()}),St(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()});var Nl=St(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1}),Al=zt(0),El=zt(1),Cl=(zt(2),zt(3),zt(4),zt(5),zt(6),St(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),St(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()}));Cl.every=function(t){return isFinite(t=Math.floor(t))&&t>0?St(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var Tl,jl,Pl,Fl,Ll,Wl={"-":"",_:" ",0:"0"},Dl=/^\s*\d+/,Bl=/^%/,Hl=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;!function(t){Tl=Et(t),jl=Tl.format,Pl=Tl.parse,Fl=Tl.utcFormat,Ll=Tl.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Date.prototype.toISOString||Fl("%Y-%m-%dT%H:%M:%S.%LZ"),+new Date("2000-01-01T00:00:00.000Z")||Ll("%Y-%m-%dT%H:%M:%S.%LZ");var Il=kt();Il("d3-number",function(t,e,n){function i(t){return a(t)}function r(){i.locale({decimal:n||".",thousands:e||",",grouping:[3],currency:["$",""]})}var o=void 0,a=void 0;return i.locale=function(e){return o=yl(e),a=o.format(t),this},r(),i.format=function(t,i,a,s){return(a||s)&&(e=a,n=s,r()),o.format(t)(i)},i.pattern=function(e){return e&&(t=e,a=o.format(e)),t},i}),Il("d3-time",function(t){function e(t){return i(t)}var n=Et({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),i=n.format(t);return e.format=function(t,e){return n.format(t)(e)},e.locale=function(){return n=Et.apply(void 0,arguments),i=n.format(t),this},e.parse=function(t,e){return n.parse(t)(e)},e.parsePattern=function(t){return n.parse(t)},e});var Vl={id:function(t){return t.source+"/"+t.title},key:function(t){return t.title},tags:function(t){return t.tags},min:function(t){return t.min},max:function(t){return t.max},type:function(t){return t.type},title:function(t){return t.title},values:function(t){return t.values},value:function(t){return t},formatter:function(t){return t.formatter&&t.formatter()||Il("d3-number")("")}},Ul={diverging:function(t,e){if((s=t.length)>1)for(var n,i,r,o,a,s,c=0,u=t[e[0]].length;c<u;++c)for(o=a=0,n=0;n<s;++n)(r=(i=t[e[n]][c])[1]-i[0])>=0?(i[0]=o,i[1]=o+=r):r<0?(i[1]=a,i[0]=a+=r):i[0]=o},none:el,silhouette:function(t,e){if((n=t.length)>0){for(var n,i=0,r=t[e[0]],o=r.length;i<o;++i){for(var a=0,s=0;a<n;++a)s+=t[a][i][1]||0;r[i][1]+=r[i][0]=-s/2}el(t,e)}},expand:function(t,e){if((i=t.length)>0){for(var n,i,r,o=0,a=t[0].length;o<a;++o){for(r=n=0;n<i;++n)r+=t[n][o][1]||0;if(r)for(n=0;n<i;++n)t[n][o][1]/=r}el(t,e)}},wiggle:function(t,e){if((r=t.length)>0&&(i=(n=t[e[0]]).length)>0){for(var n,i,r,o=0,a=1;a<i;++a){for(var s=0,c=0,u=0;s<r;++s){for(var l=t[e[s]],h=l[a][1]||0,f=(h-(l[a-1][1]||0))/2,d=0;d<s;++d){var g=t[e[d]];f+=(g[a][1]||0)-(g[a-1][1]||0)}c+=h,u+=f*h}n[a-1][1]+=n[a-1][0]=o,c&&(o-=u/c)}n[a-1][1]+=n[a-1][0]=o,el(t,e)}}},ql={ascending:function(t){var e=t.map(wt);return nl(t).sort(function(t,n){return e[t]-e[n]})},insideout:function(t){var e,n,i=t.length,r=t.map(wt),o=nl(t).sort(function(t,e){return r[e]-r[t]}),a=0,s=0,c=[],u=[];for(e=0;e<i;++e)n=o[e],a<s?(a+=r[n],c.push(n)):(s+=r[n],u.push(n));return u.reverse().concat(c)},none:nl,reverse:function(t){return nl(t).reverse()}},Yl=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Xl=function(t){return 1===t.length&&(t=Te(t)),{left:function(e,n,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)<0?i=o+1:r=o}return i},right:function(e,n,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)>0?r=o:i=o+1}return i}}}(Yl).right,$l=function(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(r);++i<r;)o[i]=t+i*n;return o},Zl=Math.sqrt(50),Gl=Math.sqrt(10),Jl=Math.sqrt(2),Kl=function(t,e,n){var i,r,o,a=e<t,s=-1;if(a&&(i=t,t=e,e=i),0===(o=je(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),r=new Array(i=Math.ceil(e-t+1));++s<i;)r[s]=(t+s)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),r=new Array(i=Math.ceil(t-e+1));++s<i;)r[s]=(t-s)/o;return a&&r.reverse(),r};Fe.prototype=Le.prototype={constructor:Fe,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var Ql=Le.prototype;We.prototype=function(t,e){var n=new We;if(t instanceof We)t.each(function(t){n.add(t)});else if(t){var i=-1,r=t.length;if(null==e)for(;++i<r;)n.add(t[i]);else for(;++i<r;)n.add(e(t[i],i,t))}return n}.prototype={constructor:We,has:Ql.has,add:function(t){return t+="",this["$"+t]=t,this},remove:Ql.remove,clear:Ql.clear,values:Ql.keys,size:Ql.size,empty:Ql.empty,each:Ql.each};var th=Array.prototype,eh=th.map,nh=th.slice,ih={name:"implicit"},rh=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t},oh="\\s*([+-]?\\d+)\\s*",ah="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",sh="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ch=/^#([0-9a-f]{3})$/,uh=/^#([0-9a-f]{6})$/,lh=new RegExp("^rgb\\("+[oh,oh,oh]+"\\)$"),hh=new RegExp("^rgb\\("+[sh,sh,sh]+"\\)$"),fh=new RegExp("^rgba\\("+[oh,oh,oh,ah]+"\\)$"),dh=new RegExp("^rgba\\("+[sh,sh,sh,ah]+"\\)$"),gh=new RegExp("^hsl\\("+[ah,sh,sh]+"\\)$"),ph=new RegExp("^hsla\\("+[ah,sh,sh,ah]+"\\)$"),yh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};rh(Ie,Ve,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),rh($e,Xe,He(Ie,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new $e(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new $e(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),rh(Je,function(t,e,n,i){return 1===arguments.length?Ge(t):new Je(t,e,n,null==i?1:i)},He(Ie,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Je(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Je(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new $e(Ke(t>=240?t-240:t+120,r,i),Ke(t,r,i),Ke(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var vh=Math.PI/180,mh=180/Math.PI,xh=.95047,bh=1,wh=1.08883,kh=4/29,_h=6/29,Mh=3*_h*_h,Sh=_h*_h*_h;rh(tn,function(t,e,n,i){return 1===arguments.length?Qe(t):new tn(t,e,n,null==i?1:i)},He(Ie,{brighter:function(t){return new tn(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new tn(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return t=bh*nn(t),e=xh*nn(e),n=wh*nn(n),new $e(rn(3.2404542*e-1.5371385*t-.4985314*n),rn(-.969266*e+1.8760108*t+.041556*n),rn(.0556434*e-.2040259*t+1.0572252*n),this.opacity)}})),rh(sn,function(t,e,n,i){return 1===arguments.length?an(t):new sn(t,e,n,null==i?1:i)},He(Ie,{brighter:function(t){return new sn(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new sn(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Qe(this).rgb()}}));var Rh=-.14861,zh=1.78277,Oh=-.29227,Nh=-.90649,Ah=1.97294,Eh=Ah*Nh,Ch=Ah*zh,Th=zh*Oh-Nh*Rh;rh(ln,un,He(Ie,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ln(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ln(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*vh,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),r=Math.sin(t);return new $e(255*(e+n*(Rh*i+zh*r)),255*(e+n*(Oh*i+Nh*r)),255*(e+n*(Ah*i)),this.opacity)}}));var jh=function(t){return function(){return t}},Ph=function t(e){function n(t,e){var n=i((t=Xe(t)).r,(e=Xe(e)).r),r=i(t.g,e.g),o=i(t.b,e.b),a=gn(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=r(e),t.b=o(e),t.opacity=a(e),t+""}}var i=dn(e);return n.gamma=t,n}(1),Fh=function(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,o=new Array(i),a=new Array(i);for(n=0;n<r;++n)o[n]=Vh(t[n],e[n]);for(;n<i;++n)a[n]=e[n];return function(t){for(n=0;n<r;++n)a[n]=o[n](t);return a}},Lh=function(t,e){var n=new Date;return t=+t,e-=t,function(i){return n.setTime(t+e*i),n}},Wh=function(t,e){return t=+t,e-=t,function(n){return t+e*n}},Dh=function(t,e){var n,i={},r={};null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={});for(n in e)n in t?i[n]=Vh(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}},Bh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Hh=new RegExp(Bh.source,"g"),Ih=function(t,e){var n,i,r,o=Bh.lastIndex=Hh.lastIndex=0,a=-1,s=[],c=[];for(t+="",e+="";(n=Bh.exec(t))&&(i=Hh.exec(e));)(r=i.index)>o&&(r=e.slice(o,r),s[a]?s[a]+=r:s[++a]=r),(n=n[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,c.push({i:a,x:Wh(n,i)})),o=Hh.lastIndex;return o<e.length&&(r=e.slice(o),s[a]?s[a]+=r:s[++a]=r),s.length<2?c[0]?yn(c[0].x):pn(e):(e=c.length,function(t){for(var n,i=0;i<e;++i)s[(n=c[i]).i]=n.x(t);return s.join("")})},Vh=function(t,e){var n,i=typeof e;return null==e||"boolean"===i?jh(e):("number"===i?Wh:"string"===i?(n=Ve(e))?(e=n,Ph):Ih:e instanceof Ve?Ph:e instanceof Date?Lh:Array.isArray(e)?Fh:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Dh:Wh)(t,e)},Uh=function(t,e){return t=+t,e-=t,function(n){return Math.round(t+e*n)}};vn(function(t,e){var n=e-t;return n?hn(t,n>180||n<-180?n-360*Math.round(n/360):n):jh(isNaN(t)?e:t)});var qh=vn(gn),Yh=function(t){return function(){return t}},Xh=function(t){return+t},$h=[0,1],Zh=function(t,e,n){var i,r=t[0],o=t[t.length-1],a=Pe(r,o,null==e?10:e);switch((n=_t(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(r),Math.abs(o));return null!=n.precision||isNaN(i=ml(a,s))||(n.precision=i),dl(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(i=xl(a,Math.max(Math.abs(r),Math.abs(o))))||(n.precision=i-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(i=vl(a))||(n.precision=i-2*("%"===n.type))}return fl(n)},Gh=function(t){return t.match(/.{6}/g).map(function(t){return"#"+t})};Gh("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Gh("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),Gh("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),Gh("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),qh(un(300,.5,0),un(-240,.5,1));qh(un(-100,.75,.35),un(80,1.5,.8)),qh(un(260,.75,.35),un(80,1.5,.8)),un();var Jh=function(t){return t.min()},Kh=function(t){return t.max()},Qh=function(t){return"number"==typeof t&&!isNaN(t)},tf=["min","max","expand","include","invert"],ef=["padding","paddingOuter","paddingInner","align","invert","maxPxStep"],nf=kt();nf("linear",$n),nf("band",function(){function t(t,e){t.data=function(){return n},t.datum=function(t){return a[s[t]]},t.start=function(){return t.domain()[0]},t.end=function(){return t.domain()[t.domain().length-1]},t.labels=function(){return u},t.ticks=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.scale=t,In(n,e.trackBy||"label")}}for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Be(),r="function"==typeof e.value?e.value:function(t){return t.value},o="function"==typeof e.label?e.label:r,a=n.items||[],s={},c=[],u=[],l=0;l<a.length;l++){var h=r(a[l]);-1===c.indexOf(h)&&(c.push(h),u.push(o(a[l])))}t(i,e);var f=Gn(e||{},n.fields);return i.pxScale=function(n){var r=f.maxPxStep;if(isNaN(r))return i;var o=i.domain().length,a=Math.max(1,o-i.paddingInner()+2*i.paddingOuter());if(a*r>=n)return i;var s=i.copy();s.type=i.type,t(s,e);var c=a*r/n,u=(1-c)*i.align();return s.range(f.invert?[c+u,u]:[u,c+u]),s},i.domain(c),i.range(f.invert?[1,0]:[0,1]),i.padding(isNaN(f.padding)?0:f.padding),isNaN(f.paddingInner)||i.paddingInner(f.paddingInner),isNaN(f.paddingOuter)||i.paddingOuter(f.paddingOuter),i.align(isNaN(f.align)?.5:f.align),i}),nf("sequential-color",Kn),nf("threshold-color",function(){function t(t){return Nn(t)?NaN:r(t)}var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).theme,r=zn();Object.keys(r).forEach(function(e){return t[e]=r[e]});var o=On(e,n.fields),a=Ru(o,2),s=a[0],c=a[1],u=e.domain?e.domain.length:-1,l=i.palette("sequential",u>0?u:2),h=e.range||l,f=e.domain||(e.nice?ni(h,s,c):[s+(c-s)/2]);return h.length>f.length+1?f=Qn(h,s,c):h.length<f.length+1&&(h=ei(f,h,s,c)),t.data=function(){return n},t.range(h),t.range(e.invert?t.range().reverse():t.range()),t.domain(f),t}),nf("categorical-color",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).theme,i=ii(t,e),r=void 0;if(r=t.range?t.range.slice():n?n.palette("categorical",i.domain().length).slice():[],t.unknown)i.unknown(t.unknown);else if(n&&n.palette("unknown")){var o=n.palette("unknown");i.unknown(o[0])}if(t.explicit&&t.explicit.domain){var a=i.domain().slice(),s=t.explicit.domain||[];if(s.length){for(var c=Math.floor(a.length/r.length),u=1;u<c+1;u*=2)r=r.concat(r);var l=t.explicit.range||[];s.map(function(t,e){return[a.indexOf(t),t,l[e]]}).sort(function(t,e){return t[0]-e[0]}).forEach(function(t){var e=a.indexOf(t[1]);-1!==e&&r.splice(e,0,t[2])}),r.length=a.length}}return i.range(r),i});var rf={};rf.isObject=function(t){return"object"==typeof t&&null!==t},rf.isNumber=function(t){return"number"==typeof t},rf.isUndefined=function(t){return void 0===t},rf.isFunction=function(t){return"function"==typeof t};var of=ui;ui.EventEmitter=ui,ui.prototype._events=void 0,ui.prototype._maxListeners=void 0,ui.defaultMaxListeners=10,ui.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},ui.prototype.setMaxListeners=function(t){if(!rf.isNumber(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},ui.prototype.emit=function(t){var e,n,i,r,o,a;if(this._events||(this._events={}),"error"===t&&!this._events.error)throw(e=arguments[1])instanceof Error?e:Error('Uncaught, unspecified "error" event.');if(n=this._events[t],rf.isUndefined(n))return!1;if(rf.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,r=new Array(i-1),o=1;o<i;o++)r[o-1]=arguments[o];n.apply(this,r)}else if(rf.isObject(n)){for(i=arguments.length,r=new Array(i-1),o=1;o<i;o++)r[o-1]=arguments[o];for(i=(a=n.slice()).length,o=0;o<i;o++)a[o].apply(this,r)}return!0},ui.prototype.addListener=function(t,e){if(!rf.isFunction(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,rf.isFunction(e.listener)?e.listener:e),this._events[t]?rf.isObject(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,rf.isObject(this._events[t])&&!this._events[t].warned){var n;(n=rf.isUndefined(this._maxListeners)?ui.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,rf.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),rf.isFunction(console.trace)&&console.trace())}return this},ui.prototype.on=ui.prototype.addListener,ui.prototype.once=function(t,e){function n(){this.removeListener(t,n),i||(i=!0,e.apply(this,arguments))}if(!rf.isFunction(e))throw TypeError("listener must be a function");var i=!1;return n.listener=e,this.on(t,n),this},ui.prototype.removeListener=function(t,e){var n,i,r,o;if(!rf.isFunction(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],r=n.length,i=-1,n===e||rf.isFunction(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(rf.isObject(n)){for(o=r;o-- >0;)if(n[o]===e||n[o].listener&&n[o].listener===e){i=o;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},ui.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],rf.isFunction(n))this.removeListener(t,n);else if(Array.isArray(n))for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},ui.prototype.listeners=function(t){return this._events&&this._events[t]?rf.isFunction(this._events[t])?[this._events[t]]:this._events[t].slice():[]},ui.listenerCount=function(t,e){return t._events&&t._events[e]?rf.isFunction(t._events[e])?1:t._events[e].length:0};var af={mixin:function(t){return Object.keys(of.prototype).forEach(function(e){t[e]=of.prototype[e]}),of.init(t),t}},sf=(kt(),kt()),cf=[],uf=function(t){return["on","preferredSize","created","beforeMount","mounted","resize","beforeUpdate","updated","beforeRender","render","beforeDestroy","destroyed","defaultSettings","data","settings","formatter","scale","chart","dockConfig","mediator","style"].some(function(e){return e===t})},lf=function(){function t(){bu(this,t)}return wu(t,null,[{key:"testCirclePoint",value:function(t,e){return!Gi(t)&&h({x:t.cx,y:t.cy},e)<=Math.pow(t.r,2)}},{key:"testCircleRect",value:function(t,e){if(Zi(e)||Gi(t))return!1;var n=e.width/2,i=e.height/2,r=e.x+n,o=e.y+i,a=t.r,s=t.cx,c=t.cy,u=Math.abs(s-r),l=Math.abs(c-o);return!(u>n+a||l>i+a)&&(u<=n||l<=i||Math.pow(u-n,2)+Math.pow(l-i,2)<=Math.pow(a,2))}},{key:"testCircleLine",value:function(e,n){if(Gi(e)||$i(n))return!1;var i=m(n),r=Ru(i,2),o=r[0],a=r[1];if(t.testCirclePoint(e,o)||t.testCirclePoint(e,a))return!0;var s={x:e.cx,y:e.cy},c=y(o,a,s);return h(c,s)<=Math.pow(e.r,2)&&v(o,a,c)}},{key:"testCircleCircle",value:function(t,e){if(Gi(t)||Gi(e))return!1;var n=t.cx-e.cx,i=t.cy-e.cy;return Math.pow(n,2)+Math.pow(i,2)<=Math.pow(t.r+e.r,2)}},{key:"testCirclePolygon",value:function(e,n){if(Ji(n)||Gi(e))return!1;var i={x:e.cx,y:e.cy};if(t.testPolygonPoint(n,i))return!0;for(var r=n.edges.length,o=0;o<r;o++){var a=_(n.edges[o]);if(t.testCircleLine(e,a))return!0}return!1}},{key:"testPolygonPoint",value:function(e,n){if(Ji(e)||!t.testRectPoint(w(e.bounds()),n))return!1;for(var i=!0,r=e.vertices.length,o=b(e.vertices),a={x:Ru(o,1)[0]-1,y:n.y},s=0;s<r-1;s++){var c=_(e.edges[s]);c.y1<n.y&&c.y2<n.y||c.y1>n.y&&c.y2>n.y||(i=t.testLineLine(c,_([a,n]))?!i:i)}return!i}},{key:"testPolygonLine",value:function(e,n){if(Ji(e))return!1;for(var i=0,r=e.edges.length;i<r;i++){var o=_(e.edges[i]);if(t.testLineLine(n,o))return!0}var a=m(n),s=Ru(a,2),c=s[0],u=s[1];return t.testPolygonPoint(e,c)||t.testPolygonPoint(e,u)}},{key:"testPolygonRect",value:function(e,n){if(Ji(e))return!1;for(var i=0,r=e.edges.length;i<r;i++){var o=_(e.edges[i]);if(t.testRectLine(n,o))return!0}var a=x(n),s=Ru(a,4),c=s[0],u=s[1],l=s[2],h=s[3];return t.testPolygonPoint(e,c)||t.testPolygonPoint(e,u)||t.testPolygonPoint(e,l)||t.testPolygonPoint(e,h)}},{key:"testRectRect",value:function(t,e){return!Zi(t)&&!Zi(e)&&(t.x<=e.x+e.width&&e.x<=t.x+t.width&&t.y<=e.y+e.height&&e.y<=t.y+t.height)}},{key:"testRectPoint",value:function(t,e){return!Zi(t)&&(e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height)}},{key:"testRectLine",value:function(e,n){if($i(n)||Zi(e))return!1;var i=m(n),r=Ru(i,2),o=r[0],a=r[1];if(t.testRectPoint(e,o)||t.testRectPoint(e,a))return!0;for(var s=x(e),c=s.length,u=0;u<c;u++){var l=_([s[u],s[3!==u?u+1:0]]);if(t.testLineLine(l,n))return!0}return!1}},{key:"testLineLine",value:function(t,e){var n=m(t),i=Ru(n,2),r=i[0],o=i[1],a=m(e),s=Ru(a,2),c=s[0],h=s[1],f=u(o,r),d=l(o,r),g=u(h,c),p=l(h,c),y=u(r,c),v=l(r,c),x=p*f-g*d,b=g*v-p*y,w=f*v-d*y,k=void 0,_=void 0;if(0===f&&0===d)return!1;if(0===g&&0===p)return!1;if(0===x){if(0===b&&0===w){if(0===f){if(0===d)return r.x===o.x&&r.y===o.y;k=l(c,r)/d,_=l(h,r)/d}else k=(c.x-r.x)/f,_=(h.x-r.x)/f;return!(k<0&&_<0||k>1&&_>1)}return!1}var M=b/x;return x=w/x,M>=0&&M<=1&&x>=0&&x<=1}},{key:"testLinePoint",value:function(t,e){if($i(t))return!1;var n=m(t),i=Ru(n,2);return v(i[0],i[1],e)}}]),t}(),hf=/^\$/,ff="@extend",df=function(t){return["on","created","beforeMount","mounted","resize","beforeUpdate","updated","beforeRender","render","beforeDestroy","destroyed","data","settings"].some(function(e){return e===t})};nr.mixin=function(t){mu.push(t)};var gf=function(t){var e=kt(t);return e.prio=function(t){return t?e.default(t[0]):[e.default()]},e.types=function(){return e.getKeys()},e},pf=kt(),yf={numeric:function(t){return t.filter(function(t){return"number"==typeof t&&!isNaN(t)})}},vf={sum:function(t){return t.reduce(function(t,e){return t+e},0)}},mf={first:function(t){return t[0]},last:function(t){return t[t.length-1]},min:function(t){var e=yf.numeric(t);return e.length?Math.min.apply(null,e):NaN},max:function(t){var e=yf.numeric(t);return e.length?Math.max.apply(null,e):NaN},sum:function(t){var e=yf.numeric(t);return e.length?e.reduce(function(t,e){return t+e},0):NaN},avg:function(t){var e=yf.numeric(t),n=e.length;return n?vf.sum(e)/n:NaN}},xf={numeric:function(t){return t.filter(function(t){return"number"==typeof t&&!isNaN(t)})}};lr.normalizeProperties=ar;var bf=kt();bf.default("default"),bf("default",lr);var wf=kt();wf("native",function(t,e,n){function i(t){u=t.key,(c=t).events=c.events||[],void 0===c.enable&&(c.enable=!0)}function r(){"function"==typeof c.enable&&(c.enable=c.enable.bind(a)()),c.enable&&Object.keys(c.events).forEach(function(t){var e=c.events[t].bind(a);n.addEventListener(t,e),s.push({key:t,listener:e})})}function o(){s.forEach(function(t){var e=t.key,i=t.listener;n.removeEventListener(e,i)}),s=[]}var a={chart:t,mediator:e,element:n},s=[],c=void 0,u=void 0,l=!0;return{get key(){return u},set:function(t){i(t),o(),l&&r()},off:function(){l=!1,o()},on:function(){l=!0,0===s.length&&r()},destroy:function(){o(),a=null,c=null}}}),"undefined"!=typeof window&&function(t){function e(t){var e=t.match(u);return e?e.map(Number):[]}function n(t){var n=[];return t.replace(c,function(t,i,r){var o=i.toLowerCase();for(r=e(r),"m"===o&&r.length>2&&(n.push([i].concat(r.splice(0,2))),o="l",i="m"===i?"l":"L");r.length!==s[o];){if(r.length<s[o])throw new Error("malformed path data");n.push([i].concat(r.splice(0,s[o])))}return r.unshift(i),n.push(r)}),n}function i(t){this.segments=[],t&&(this.segments=n(t))}function r(t,e){var n=t.x*Math.cos(e)-t.y*Math.sin(e),i=t.y*Math.cos(e)+t.x*Math.sin(e);t.x=n,t.y=i}function o(t,e,n){t.x+=e,t.y+=n}function a(t,e){var n=void 0,i=void 0,a=void 0,s=void 0,c=void 0,u=void 0,l=void 0,h=void 0,f=void 0,d=void 0,g=void 0,p=void 0,y={x:0,y:0};t.beginPath();for(var v=0;v<e.length;++v){var m=e[v];switch(g=m[0]){case"m":case"M":"m"===g?(l=y.x+m[1],h=y.y+m[2]):(l=m[1],h=m[2]),t.moveTo(l,h),y.x=l,y.y=h;break;case"l":case"L":"l"===g?(l=y.x+m[1],h=y.y+m[2]):(l=m[1],h=m[2]),t.lineTo(l,h),y.x=l,y.y=h;break;case"a":case"A":"a"===g?(l=y.x+m[6],h=y.y+m[7]):(l=m[6],h=m[7]),f=m[1],a=m[4],s=m[5],o(c={x:l,y:h},-y.x,-y.y),r(c,-(u=Math.atan2(c.y,c.x))),d=c.x/2,(p={x:0,y:0}).x=c.x/2,p.y=s&&!a||!s&&a?Math.sqrt(f*f-d*d):-Math.sqrt(f*f-d*d),i=Math.atan2(-p.y,-p.x),n=Math.atan2(c.y-p.y,c.x-p.x),i+=u,n+=u,r(c,u),r(p,u),o(c,y.x,y.y),o(p,y.x,y.y),t.arc(p.x,p.y,f,i,n,!s),y.x=l,y.y=h;break;case"z":case"Z":t.closePath();break;default:throw new Error(g+" is not implemented")}}}if(t&&!t.Path2D){var s={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},c=/([astvzqmhlc])([^astvzqmhlc]*)/gi,u=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;i.prototype.moveTo=function(t,e){this.segments.push(["M",t,e])},i.prototype.lineTo=function(t,e){this.segments.push(["L",t,e])},i.prototype.arc=function(t,e,n,i,r,o){this.segments.push(["AC",t,e,n,i,r,!!o])},i.prototype.closePath=function(){this.segments.push(["Z"])};var l=t.CanvasRenderingContext2D.prototype.fill,h=t.CanvasRenderingContext2D.prototype.stroke;t.CanvasRenderingContext2D.prototype.fill=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var i="nonzero";0===e.length||1===e.length&&"string"==typeof e[0]?l.apply(this,e):(2===arguments.length&&(i=e[1]),a(this,e[0].segments),l.call(this,i))},t.CanvasRenderingContext2D.prototype.stroke=function(t){t?(a(this,t.segments),h.call(this)):h.call(this)},t.Path2D=i}}(window);var kf=function(t){function e(e){if(t[e.type]&&t[e.type].condition(e)){var n=t[e.type],i=void 0===n.conditionAppend||n.conditionAppend(e);n.items.forEach(function(t){var n=Math.round(e[t.key]),r=e[t.key]-n;e[t.key]=n,i&&"append"===t.type&&(r>0?e[t.key]+=.5:e[t.key]-=.5)})}}return void 0===t&&((t={}).line={append:["x1","x2","y1","y2"],round:[],condition:function(t){return t.x1===t.x2||t.y1===t.y2},conditionAppend:function(t){return t.strokeWidth%2!=0}},t.rect={append:["x","y"],round:["width","height"],condition:function(){return!0},conditionAppend:function(t){return t.strokeWidth%2!=0}}),Object.keys(t).forEach(function(e){var n=t[e];n.items=[],n.append.forEach(function(t){n.items.push({key:t,type:"append"})}),n.round.forEach(function(t){n.items.push({key:t,type:"round"})})}),e.multiple=function(t){return t.forEach(function(t){return e(t)})},e}(),_f=function(){function t(){bu(this,t),this.reset(),this.push.apply(this,arguments)}return wu(t,[{key:"transposeCoordinate",value:function(t,e,n){if("number"==typeof e&&isFinite(e)){var i=t.substring(0,1);if("x"===i||"cx"===t)return e*this.width;if("width"===t)return e*this.width;if("r"===t)return e*(n?this.height:this.width);if("y"===i||"cy"===t)return e*this.height;if("height"===t)return e*this.height}return e}},{key:"push",value:function(){var t;return(t=this.storage).push.apply(t,arguments),this}},{key:"processItem",value:function(e){var n={},i=void 0!==e.flipXY?e.flipXY:this.flipXY,r=void 0!==e.crisp?e.crisp:this.crisp;if(e.fn&&"function"==typeof e.fn){var o=i?this.height:this.width,a=i?this.width:this.height;e=e.fn({width:o,height:a,flipXY:i});for(var s=Object.keys(e),c=0,u=s.length;c<u;c++){var l=s[c];n[t.evaluateKey(l,i)]=e[l]}}else for(var h=Object.keys(e),f=0,d=h.length;f<d;f++){var g=h[f],p=t.evaluateKey(g,i),y=this.transposeCoordinate(p,e[g],i);n[p]=y}return r&&kf(n),n}},{key:"output",value:function(){for(var t=[],e=0,n=this.storage.length;e<n;e++){var i=this.processItem(this.storage[e]);t.push(i)}return t}},{key:"reset",value:function(){this.storage=[],this.flipXY=!1,this.crisp=!1,this.width=0,this.height=0}}],[{key:"evaluateKey",value:function(t,e){if(e){var n=t.substring(0,1),i=t.substring(1);if("x"===n)return"y"+i;if("y"===n)return"x"+i;if("cx"===t)return"cy";if("cy"===t)return"cx";if("width"===t)return"height";if("height"===t)return"width"}return t}}]),t}(),Mf={fontFamily:"Arial",fontSize:"13px",color:"#595959",backgroundColor:"#ffffff",stroke:"#000000",strokeWidth:0,$fill:"#333333"},Sf=/^\$/,Rf={line:{show:!0,stroke:"#000",strokeWidth:1},median:{show:!0,stroke:"#000",strokeWidth:1},whisker:{show:!0,stroke:"#000",strokeWidth:1,fill:"",type:"line",width:1},box:{show:!0,fill:"#fff",stroke:"#000",strokeWidth:1,width:1,maxWidthPx:100,minWidthPx:1,minHeightPx:1}},zf={require:["chart"],defaultSettings:{settings:{},data:{}},created:function(){this.rect={x:0,y:0,width:0,height:0},this.dispersion=vr(this.chart,Rf,this.settings.settings),this.updateSettings(this.settings)},updateSettings:function(t){this.dispersion.updateSettings(t),void 0===this.settings.settings.orientation&&(this.settings.settings.orientation="vertical"),void 0===this.settings.settings.whiskers&&(this.settings.settings.whiskers=!0)},beforeRender:function(t){this.rect=t.size},render:function(t){var e=t.data;return this.boxWidth=this.dispersion.bandwidth()*this.rect.width,this.dispersion.onData(e,this.rect),this.dispersion.render(this.rect,this.buildShapes)},beforeUpdate:function(t){var e=t.settings;this.updateSettings(e)},buildShapes:function(t){var e=t.item,n=t.blueprint,i=t.doodle;if(Nn(e.major))return[];var r=[],o=this.dispersion.bandwidth(),a=e.majorEnd-e.majorStart,s=e.major;null===e.majorStart||isNaN(a)||(s=e.majorStart+.5*a,o=Math.abs(a));var c=void 0,u=void 0,l=void 0;if(e.style.box.show&&!Nn(e.start)&&!Nn(e.end)){var h=Math.max(e.start,e.end),f=Math.min(e.start,e.end);r.push(n.processItem({fn:function(t){var n=t.width,r=t.height,a=mr(-100,r+200,Math.floor(h*r)),d=mr(-100,r+200,Math.floor(f*r));c=Math.floor(s*n),u=Math.floor((s+e.style.box.width*o)*n),l=u-c,l=mr(e.style.box.minWidthPx,e.style.box.maxWidthPx,l);var g=a-d,p=Math.max(e.style.box.minHeightPx,g),y=(p-g)/2;return vu(i.style({},"box",e.style),{type:"rect",x:c-Math.floor(l/2),y:d-y,height:p,width:l})},crisp:!0}))}if(!e.style.line.show||Nn(e.min)||Nn(e.start)||r.push(n.processItem({fn:function(t){var n=t.height;return vu(i.style({},"line",e.style),{type:"line",y1:Math.floor(e.start*n),x1:c,y2:Math.floor(e.min*n),x2:c})},crisp:!0})),!e.style.line.show||Nn(e.max)||Nn(e.end)||r.push(n.processItem({fn:function(t){var n=t.height;return vu(i.style({},"line",e.style),{type:"line",y1:Math.floor(e.max*n),x1:c,y2:Math.floor(e.end*n),x2:c})},crisp:!0})),e.style.median.show&&!Nn(e.med)&&r.push(n.processItem({fn:function(t){var n=t.height;return vu(i.style({},"median",e.style),{type:"line",y1:e.med*n,x1:c-Math.floor(l/2),y2:e.med*n,x2:c+Math.floor(l/2)})},crisp:!0})),e.style.whisker.show&&!Nn(e.min)&&!Nn(e.max)){var d=l*e.style.whisker.width;r.push(n.processItem({fn:function(t){var n=t.height;return vu(i.style({type:"line"},"whisker",e.style),{y1:Math.floor(e.min*n),x1:c-Math.floor(d/2),y2:Math.floor(e.min*n),x2:c+Math.floor(d/2),cx:c,cy:Math.floor(e.min*n),width:d,r:d/2})},crisp:!0})),r.push(n.processItem({fn:function(t){var n=t.height;return vu(i.style({type:"line"},"whisker",e.style),{y1:Math.floor(e.max*n),x1:c-Math.floor(d/2),y2:Math.floor(e.max*n),x2:c+Math.floor(d/2),cx:c,cy:Math.floor(e.max*n),width:d,r:d/2})},crisp:!0}))}return r}},Of={fill:"fill",stroke:"stroke",opacity:"opacity",strokeWidth:"stroke-width",fontFamily:"font-family",fontSize:"font-size",baseline:"dominant-baseline",dominantBaseline:"dominant-baseline",anchor:"text-anchor",textAnchor:"text-anchor",maxWidth:"maxWidth",transform:"transform",strokeDasharray:"stroke-dasharray",id:"id"},Nf={up:0,down:180,left:-90,right:90},Af=kt();Af.add("circle",function(t){return{type:"circle",fill:"black",cx:t.x,cy:t.y,r:t.size/2,collider:{type:"circle"}}}),Af.add("diamond",function(t){var e=t.size,n=t.x-e/2,i=t.y-e/2;return{type:"path",fill:"black",d:I([{x:n,y:i+e/2},{x:n+e/2,y:i},{x:n+e,y:i+e/2},{x:n+e/2,y:i+e},{x:n,y:i+e/2}])}}),Af.add("saltire",function(t){var e=En(45),n=t.size/2,i=isNaN(t.width)?n/2:t.width,r=Math.min(i,n),o=t.size,a=Math.sin(Math.asin(-e))*(r/2);o+=2*(n/Math.sin(-e)-n),o-=2*a;var s={x:t.x,y:t.y};return{type:"path",fill:"black",d:I(kr(t.x,t.y,o,r).map(function(t){return p(t,e,s)}))}}),Af.add("square",function(t){var e=t.size;return{type:"rect",fill:"black",x:t.x-e/2,y:t.y-e/2,width:e,height:e}}),Af.add("triangle",function(t){var e=t.size,n={x:t.x,y:t.y},i=Nf[t.direction]||0,r=e/2,o=t.x-r,a=t.y-r,s=[{x:o,y:a+e},{x:o+r,y:a},{x:o+e,y:a+e},{x:o,y:a+e}],c=En(i);return s=s.map(function(t){return p(t,c,n)}),{type:"path",fill:"black",d:I(s)}}),Af.add("line",function(t){var e="vertical"===t.direction,n=t.size/2,i=t.x,r=t.y;return{type:"line",stroke:"black",strokeWidth:1,x1:i-(e?0:n),y1:r-(e?n:0),x2:i+(e?0:n),y2:r+(e?n:0)}}),Af.add("star",function(t){for(var e=t.size,n=[],i=e/2,r=t.points||5,o=Math.min(t.innerRadius||e/2,e)/2,a=isNaN(t.startAngle)?90:t.startAngle,s=360/r,c=1;c<=r;c++){var u=s*c+a,l=En(u),h=En(u+s/2),f=Math.sin(l),d=Math.cos(l),g=Math.sin(h),p=Math.cos(h);n.push({x:t.x+d*i,y:t.y+f*i}),n.push({x:t.x+p*o,y:t.y+g*o})}return{type:"path",fill:"black",d:I(n)}}),Af.add("n-polygon",function(t){for(var e=[],n=t.size/2,i=Math.max(isNaN(t.sides)?6:t.sides,3),r=360/i,o=isNaN(t.startAngle)?0:t.startAngle,a=1;a<=i;a++){var s=En(r*a+o),c=Math.sin(s),u=Math.cos(s);e.push({x:t.x+u*n,y:t.y+c*n})}return{type:"path",fill:"black",d:I(e)}}),Af.add("cross",function(t){var e=t.x,n=t.y,i=t.size/2,r=isNaN(t.width)?i/2:t.width,o=Math.min(r,i);return{type:"path",fill:"black",d:I(kr(e,n,t.size,o))}}),Af.add("bar",function(t){var e={x:t.x,y:t.y},n="vertical"===t.direction,i=t.size/2,r=i/2/2,o=[{x:e.x-i,y:e.y+r},{x:e.x-i,y:e.y-r},{x:e.x+i,y:e.y-r},{x:e.x+i,y:e.y+r}];if(n){var a=En(90);o=o.map(function(t){return p(t,a,e)})}var s=w(o);return s.type="rect",s.fill="black",s.collider={type:"rect"},s});var Ef={shape:"circle",label:"",fill:"$fill",stroke:"#ccc",strokeWidth:0,opacity:1,x:.5,y:.5,size:1,strokeDasharray:""},Cf={maxPx:1e4,minPx:1,maxRelExtent:.1,minRelExtent:.01,maxRelDiscrete:1,minRelDiscrete:.1},Tf={errorShape:{shape:"saltire",width:2,size:.5,fill:"#333",stroke:"#333",strokeWidth:0}},jf={require:["chart"],defaultSettings:{settings:{},data:{}},created:function(){this.rect={x:0,y:0,width:0,height:0},this.updateSettings(this.settings)},updateSettings:function(t){var e=this.chart;this.local=Or(t.settings,e)},beforeUpdate:function(t){this.updateSettings(t.settings)},beforeRender:function(t){this.rect=t.size},render:function(t){var e=this,n=t.data,i=this.rect,r=i.width,o=i.height;xr(this.local,"x",r),xr(this.local,"y",o);var a=vu({},Cf,this.settings.settings.sizeLimits),s=(n.items||[]).map(function(t,n,i){var r=pr(t,e.local,i);return r.errorShape=pr(t,e.local.errorShape,i),r.data=t,r}),c=zr(this.local.x,this.local.y,r,o,a);return Nr(s,this.rect,c,this.settings.shapeFn||Sr)}},Pf={shape:"pie",label:"",fill:"#999",stroke:"#ccc",strokeWidth:1,opacity:1,arc:.25,innerRadius:0,outerRadius:.5,cornerRadius:1,offset:0},Ff={require:["chart"],defaultSettings:{settings:{startAngle:0,endAngle:2*Math.PI,padAngle:0,slice:{}},data:{}},created:function(){this.rect={x:0,y:0,width:0,height:0},this.updateSettings(this.settings)},updateSettings:function(t){var e=this.chart;this.local=gr(t.settings.slice,Pf,e)},beforeUpdate:function(t){this.updateSettings(t)},beforeRender:function(t){this.rect=t.size},render:function(t){var e=this,n=t.data,i=[],r=this.settings.settings,o=(n.items||[]).map(function(t,n,r){var o=pr(t,e.local,r);return o.data=t,i.push(t.arc.value),o}),a=Gu();return a.startAngle(r.startAngle),a.endAngle(r.endAngle),a.padAngle(r.padAngle),Er(a(i),this.rect,o)}},Lf={created:function(){},require:["chart","renderer"],defaultSettings:{displayOrder:0,styles:{}},beforeRender:function(t){this.rect=t.size,this.blueprint=fr(),this.blueprint.width=this.rect.width,this.blueprint.height=this.rect.height,this.blueprint.x=this.rect.x,this.blueprint.y=this.rect.y,this.blueprint.crisp=!0},render:function(){var t=this;if(this.x=this.settings.x?this.chart.scale(this.settings.x):null,this.y=this.settings.y?this.chart.scale(this.settings.y):null,xr(this,"x",this.rect.width),xr(this,"y",this.rect.height),!this.x&&!this.y)return[];var e={labels:{show:!0,tiltAngle:40,maxEdgeBleed:1/0,fontFamily:"Arial",fontSize:"12px",fill:"#595959",margin:4,maxLengthPx:150,mode:"horizontal"},line:{show:!0,strokeWidth:1,stroke:"#cccccc"},ticks:{show:!0,margin:0,tickSize:8,stroke:"#cccccc",strokeWidth:1},minorTicks:{show:!1,margin:0,tickSize:3,stroke:"#E6E6E6",strokeWidth:1}};this.settings.ticks=vu({},e.ticks,this.settings.ticks||{}),this.settings.minorTicks=vu({},e.minorTicks,this.settings.minorTicks||{}),this.lines={x:[],y:[]},this.lines.x=Cr(this.x,this.rect.width),this.lines.y=Cr(this.y,this.rect.height),this.lines.y=this.lines.y.map(function(t){return vu(t,{flipXY:!0})});var n={};return[].concat(zu(this.lines.x),zu(this.lines.y)).forEach(function(e){(n=e.isMinor?t.settings.minorTicks:t.settings.ticks).show&&t.blueprint.push({type:"line",x1:e.position,y1:0,x2:e.position,y2:1,stroke:n.stroke||"black",strokeWidth:n.strokeWidth||1,flipXY:e.flipXY||!1})}),this.blueprint.output()}},Wf={require:["chart","renderer","dockConfig"],defaultSettings:{displayOrder:0,style:{oob:{show:!0,width:10,fill:"#1A1A1A",stroke:"transparent",strokeWidth:0,opacity:1,text:{fontFamily:"Arial",stroke:"transparent",fill:"#fff",strokeWidth:0,opacity:1},triangle:{fill:"#4D4D4D",stroke:"transparent",strokeWidth:0,opacity:1},padding:{x:28,y:5}},line:{stroke:"#000"},label:{strokeWidth:0}}},preferredSize:function(){return 30},beforeRender:function(t){this.rect=t.size,this.blueprint=fr(),this.blueprint.width=this.rect.width,this.blueprint.height=this.rect.height,this.blueprint.x=this.rect.x,this.blueprint.y=this.rect.y,this.blueprint.crisp=!0},render:function(){var t=this,e=this.settings;if(this.lines={x:[],y:[]},this.lines.x=e.lines&&e.lines.x||[],this.lines.y=e.lines&&e.lines.y||[],0===this.lines.x.length&&0===this.lines.y.length)return[];var n={x0:[],x1:[],y0:[],y1:[]};this.lines.x=this.lines.x.filter(Br).map(function(e){if(e.scale){var n=t.chart.scale(e.scale);return vu(e,{scale:n,position:n(e.value)})}return vu(e,{position:e.value})}),this.lines.y=this.lines.y.filter(Br).map(function(e){if(e.scale){var n=t.chart.scale(e.scale);return vu(e,{scale:n,position:n(e.value),flipXY:!0})}return vu(e,{position:e.value,flipXY:!0})}),this.lines.x=this.lines.x.filter(function(t){return!(t.position<0||t.position>1)||(n["x"+(t.position>1?1:0)].push(Dr(t)),!1)}),this.lines.y=this.lines.y.filter(function(t){return!(t.position<0||t.position>1)||(n["y"+(t.position>1?1:0)].push(Dr(t)),!1)});var i=[];return[].concat(zu(this.lines.x),zu(this.lines.y)).forEach(function(n){(!0===n.show||void 0===n.show)&&Wr({chart:t.chart,blueprint:t.blueprint,renderer:t.renderer,p:n,settings:e,items:i})}),e.style.oob.show&&Pr({blueprint:this.blueprint,oob:n,settings:e,items:i}),i}},Df={fontFamily:"Arial",fontSize:"13px",color:"#595959",fill:"#333333",backgroundColor:"#ffffff",stroke:"#000000",strokeWidth:0},Bf={require:["chart","renderer","dockConfig"],defaultSettings:{displayOrder:0,prioOrder:0,paddingStart:0,paddingEnd:10},created:function(){this.state={isDiscrete:!!this.scale.bandwidth,isHorizontal:!1,labels:{activeMode:"horizontal"},ticks:[],innerRect:{width:0,height:0,x:0,y:0},outerRect:{width:0,height:0,x:0,y:0},defaultStyleSettings:void 0,defaultDock:void 0,concreteNodeBuilder:void 0,settings:void 0},this.state.isDiscrete?(this.state.defaultStyleSettings={labels:{show:!0,tiltAngle:40,maxEdgeBleed:1/0,fontFamily:"Arial",fontSize:"12px",fill:"#595959",margin:6,maxLengthPx:150,mode:"auto",maxGlyphCount:NaN},line:{show:!1,strokeWidth:1,stroke:"#cccccc"},ticks:{show:!1,margin:0,tickSize:4,stroke:"#cccccc",strokeWidth:1}},this.state.defaultDock="bottom"):(this.state.defaultStyleSettings={labels:{show:!0,tiltAngle:40,maxEdgeBleed:1/0,fontFamily:"Arial",fontSize:"12px",fill:"#595959",margin:4,maxLengthPx:150,mode:"horizontal"},line:{show:!0,strokeWidth:1,stroke:"#cccccc"},ticks:{show:!0,margin:0,tickSize:8,stroke:"#cccccc",strokeWidth:1},minorTicks:{show:!1,margin:0,tickSize:3,stroke:"#E6E6E6",strokeWidth:1}},this.state.defaultDock="left"),this.setState(this.settings)},setState:function(t){var e=this;this.state.isDiscrete=!!this.scale.bandwidth;var n=Do(t.settings,this.state.defaultStyleSettings,this.chart);this.state.settings=vu(!0,{},this.settings,t.settings,n);var i=void 0!==this.state.settings.dock?this.state.settings.dock:this.state.defaultDock;this.state.concreteNodeBuilder=So(this.state.isDiscrete),this.state.settings.dock=i,this.state.settings.align=Wo(this.state.settings.align,i),this.state.settings.labels.tiltAngle=Math.max(-90,Math.min(this.state.settings.labels.tiltAngle,90)),this.dockConfig.dock=i,Object.keys(n).forEach(function(t){e.state.settings[t]=To(e.state.settings[t])}),this.state.isHorizontal="top"===this.state.settings.align||"bottom"===this.state.settings.align,this.state.labels.activeMode=Bo(this.state,this.state.settings,this.state.isDiscrete)},preferredSize:function(t){var e=this.formatter,n=this.state,i=this.scale,r=this.state.isHorizontal?t.inner.width:t.inner.height;return this.state.pxScale=br(i,r),Ro({isDiscrete:this.state.isDiscrete,rect:t.inner,formatter:e,measureText:this.renderer.measureText,scale:this.state.pxScale,settings:this.state.settings,state:n})},beforeUpdate:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).settings;this.setState(t)},resize:function(t){var e=t.inner,n=t.outer,i=vu({},e,Lo({align:this.state.settings.align,inner:e})),r=n||i;return vu(this.state.innerRect,i),vu(this.state.outerRect,r),n},beforeRender:function(){var t=this.scale,e=this.formatter,n=this.state.isHorizontal?this.state.innerRect.width:this.state.innerRect.height;this.state.pxScale=br(t,n),this.state.ticks=this.state.pxScale.ticks({distance:n,formatter:e})},render:function(){var t=this.state,e=[];return e.push.apply(e,zu(this.state.concreteNodeBuilder.build({settings:this.state.settings,scale:this.state.pxScale,innerRect:this.state.innerRect,outerRect:this.state.outerRect,measureText:this.renderer.measureText,textBounds:this.renderer.textBounds,ticks:this.state.ticks,state:t}))),kf.multiple(e),e}},Hf={require:["renderer","chart"],defaultSettings:{dock:"bottom",displayOrder:0,prioOrder:0,settings:{paddingStart:5,paddingEnd:5,paddingLeft:0,paddingRight:0,anchor:"center",join:", ",maxLengthPx:NaN,style:{fontSize:"15px",fontFamily:"Arial",fill:"#999"}}},created:function(){this.rect={x:0,y:0,width:0,height:0},this.definitionSettings=this.settings.settings;var t=this.settings.text,e=this.definitionSettings.join;this.title=Ho(t,e,this.scale)},preferredSize:function(){return this.renderer.measureText({text:this.title,fontSize:this.definitionSettings.style.fontSize,fontFamily:this.definitionSettings.style.fontFamily}).height+this.definitionSettings.paddingStart+this.definitionSettings.paddingEnd},beforeRender:function(t){vu(this.rect,t.size)},render:function(){var t=this.title,e=this.definitionSettings,n=this.rect,i=[];return i.push(Vo({title:t,dock:this.settings.dock,definitionSettings:e,rect:n,measureText:this.renderer.measureText})),i},beforeUpdate:function(t){t.settings&&(vu(this.settings,t.settings),this.definitionSettings=t.settings.settings);var e=this.settings.text,n=this.definitionSettings.join;this.title=Ho(e,n,this.scale)}},If={require:["chart","renderer"],on:{panStart:function(t){var e=qo(t,this.renderer),n={x:e.x-t.deltaX,y:e.y-t.deltaY};this.currentMove=Uo(this,n),this.currentMove.update(e)},panMove:function(t){if(this.currentMove){var e=qo(t,this.renderer);this.currentMove.update(e)}},panEnd:function(t){if(this.currentMove){var e=qo(t,this.renderer);this.currentMove.end(e),this.currentMove=null}},panCancel:function(){this.currentMove=null},tap:function(t){var e=qo(t,this.renderer);Uo(this,e).end(e)}},defaultSettings:{settings:{backgroundColor:"#eee",thumbColor:"#ccc",width:16}},created:function(){this.rect={x:0,y:0,width:0,height:0}},preferredSize:function(t){var e=this.chart.scroll(this.settings.scroll).getState();return e.viewSize>=e.max-e.min?Math.max(t.width,t.height):this.settings.settings.width},resize:function(t){var e=t.inner;return this.rect=e,e},render:function(t){var e,n=this.settings.dock,i=this.settings.settings.invert,r="top"===n||"bottom"===n,o=r?"width":"height",a=this.rect[o],s=this.chart.scroll(this.settings.scroll).getState(),c=a*(s.start-s.min)/(s.max-s.min),u=a*s.viewSize/(s.max-s.min);return i&&(c=a-c-u),t("div",{style:{position:"relative",width:"100%",height:"100%",background:this.settings.settings.backgroundColor,pointerEvents:"auto"}},[].concat(t("div",{class:{scroller:!0},style:(e={position:"absolute"},ku(e,r?"left":"top",c+"px"),ku(e,r?"top":"left","25%"),ku(e,r?"height":"width","50%"),ku(e,o,Math.max(1,u)+"px"),ku(e,"background",this.settings.settings.thumbColor),e)})))},renderer:"dom"},Vf=5,Uf=0,qf={require:["chart","settings","renderer"],defaultSettings:{settings:{bubbles:{show:!0,align:"start",fontSize:"14px",fontFamily:"Arial",fill:"#595959"},fill:"#ccc",target:{fill:"#ccc"}}},renderer:"dom",on:{rangeStart:function(t){this.start(t)},rangeMove:function(t){this.move(t)},rangeEnd:function(t){this.end(t)},rangeClear:function(t){this.clear(t)}},created:function(){this.state={}},beforeRender:function(t){this.state.rect=t.size},render:function(t){var e=this.settings.settings;this.state.direction="vertical"===e.direction?Uf:1;var n=this.renderer.element().getBoundingClientRect(),i=this.state.rect[this.state.direction===Uf?"height":"width"],r=br(this.chart.scale(e.scale),i),o=pa(this);if(r=o.scale?o.scale:r,this.state.targetRect=o.targetRect,this.state.targetFillRect=o.targetFillRect,this.state.size=null===o.size?i:o.size,this.state.settings=e,this.state.offset=n,this.state.brush=e.brush,this.state.brushInstance=this.chart.brush(this.state.brush),this.state.renderer=this.renderer,this.state.multi=!!e.multiple,this.state.h=t,this.state.cssCoord={offset:this.state.direction===Uf?"top":"left",coord:this.state.direction===Uf?"y":"x",pos:this.state.direction===Uf?"deltaY":"deltaX"},{}.hasOwnProperty.call(r,"norm")){this.state.fauxBrushInstance=null,this.state.findValues=null,this.state.scale=r;var a=this.state.scale.data();a&&a.fields&&a.fields[0]&&(this.state.format=a.fields[0].formatter())}else this.state.scale=$n(),this.state.scale.data=r.data,this.state.format=function(t,e){return fa(r.range(),e)?ha(t,r):"-"},this.state.fauxBrushInstance=Ai(),this.state.findValues=function(t){return da(t,r)};return[]},start:function(t){na({e:t,state:this.state,renderer:this.renderer,ranges:ca,targetSize:Vf})},end:function(){this.state.started&&(ia(this.state,ca),sa(this.state))},move:function(t){this.state.started&&(oa(this.state,t),ua(this.state),sa(this.state))},clear:function(){this.state.fauxBrushInstance&&this.state.fauxBrushInstance.clear(),this.state.renderer.render([])}},Yf={require:["chart","settings","renderer"],defaultSettings:{settings:{bubbles:{show:!0,align:"start",fontSize:"14px",fontFamily:"Arial",fill:"#595959"},fill:"#ccc",target:{fill:"#ccc"}}},renderer:"dom",on:{areaStart:function(t){this.start(t)},areaMove:function(t){this.move(t)},areaEnd:function(t){this.end(t)},areaClear:function(t){this.clear(t)}},created:function(){this.rect={x:0,y:0,width:0,height:0},this.state={}},beforeRender:function(t){this.rect=t.size},render:function(t){this.state.rect=this.rect;var e=this.settings.settings,n="vertical"===e.direction?Uf:1,i=this.state.rect[n===Uf?"height":"width"],r=this.renderer.element().getBoundingClientRect(),o=e.target?this.chart.component(e.target.component):null;return o&&o.rect?this.state.targetRect={x:o.rect.x-this.rect.x,y:o.rect.y-this.rect.y,width:o.rect.width,height:o.rect.height}:this.state.targetRect=null,this.state.chart=this.chart,this.state.direction=n,this.state.settings=e,this.state.offset=r,this.state.rc=yi(),this.state.renderer=this.renderer,this.state.multi=!!e.multiple,this.state.h=t,this.state.size=i,this.state.cssCoord={offset:this.state.direction===Uf?"top":"left",coord:this.state.direction===Uf?"y":"x",pos:this.state.direction===Uf?"deltaY":"deltaX",area:this.state.direction===Uf?"height":"width"},this.state.format=function(t,e){return wa(this,t,e)},[]},start:function(t){ea({e:t,state:this.state,renderer:this.renderer,ranges:va,targetSize:Vf})},end:function(){this.state.started&&(ra(this.state,va),ya(this.state))},move:function(t){this.state.started&&(aa(this.state,t),ba(this.state),ya(this.state))},clear:function(){this.state.rc&&this.state.rc.clear(),this.state.renderer.render([])}},Xf={require:["chart","settings","renderer"],defaultSettings:{settings:{}},preferredSize:function(){return 50},created:function(){this.rect={x:0,y:0,width:0,height:0},this.state={}},beforeRender:function(t){this.rect=t.size},render:function(){var t=this.settings.settings,e=this.chart.brush(t.brush),n=t.direction||"horizontal",i="horizontal"===n?this.rect.width:this.rect.height,r=br(this.chart.scale(t.scale),i);return Oa(this.state),za(this.state,e,r,this.renderer),this.state.rect=this.rect,this.state.fill=t.fill||"#ccc",this.state.opacity=void 0!==t.opacity?t.opacity:1,this.state.direction=n,_a(this.state)},beforeDestroy:function(){Oa(this.state)}},$f={require:["chart","renderer","settings"],defaultSettings:{displayOrder:0,settings:{brush:{components:[]},snapIndicator:{threshold:75,strokeDasharray:"5, 5",stroke:"black",strokeWidth:2,opacity:.5},lasso:{fill:"transparent",stroke:"black",strokeWidth:2,opacity:.7,strokeDasharray:"20, 10"},startPoint:{r:10,fill:"green",stroke:"black",strokeWidth:1,opacity:1}}},on:{lassoStart:function(t){this.start(t)},lassoEnd:function(t){this.end(t)},lassoMove:function(t){this.move(t)},lassoCancel:function(){this.cancel()}},created:function(){this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}}},start:function(t){this.state.active=!0,this.state.path=Da(this.settings.settings.lasso),this.state.snapIndicator=Ba(this.settings.settings.snapIndicator),this.state.startPoint=Ha(this.settings.settings.startPoint),this.state.rendererBounds=this.renderer.element().getBoundingClientRect(),this.state.componentDelta=Fa(this.chart,this.state.rendererBounds),this.state.brushConfig=Ia(this.settings);var e=Na(this.state.rendererBounds,t);Ea(this.state,e),Ta({state:this.state,start:e}),Pa(this.state,e)},move:function(t){if(this.state.active){var e=Na(this.state.rendererBounds,t);Aa(e,this.state,this.settings)?ja(this.state,!0):ja(this.state,!1),Ea(this.state,e),Ta({state:this.state,end:e}),Ca(this.state,this.renderer),La(this.state,this.chart)}},end:function(t){this.state.active&&(ja(this.state,!1),Aa(Na(this.state.rendererBounds,t),this.state,this.settings)&&Wa(this.state,this.chart),this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}},this.renderer.render([]))},cancel:function(){this.state.active&&(Va(this.state,this.chart),this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}},this.renderer.render([]))},render:function(){}},Zf=1.4,Gf=4,Jf=2*Gf,Kf={require:["chart","renderer","settings"],defaultSettings:{settings:{}},created:function(){this.rect={x:0,y:0,width:0,height:0}},beforeRender:function(t){this.rect=t.size},render:function(){var t=this,e=[],n=[],i=void 0,r=void 0;return(this.settings.settings.sources||[]).forEach(function(o){o.strategy&&"bar"===o.strategy.type&&o.component&&((i=t.chart.component(o.component))&&(n=t.chart.findShapes(o.selector).filter(function(t){return t.key===o.component}),r=i.data),e.push.apply(e,zu($a({settings:o.strategy.settings,nodes:n,rect:{x:0,y:0,width:t.rect.width,height:t.rect.height},data:r,renderer:t.renderer,context:t}))))}),e}},Qf=26,td=18,ed=8,nd=4,id={require:["chart","settings","renderer","update"],defaultSettings:{settings:{direction:null,anchor:"left",layout:{mode:"stack"},item:{show:!0,justify:.5,align:.5,symbolPadding:8,label:{fontSize:"12px",fontFamily:"Arial",fill:"#595959",wordBreak:"none",hyphens:"auto",maxLines:2,maxWidth:136,lineHeight:1.2},shape:{type:"square",strokeWidth:0,size:8},margin:{top:0,bottom:8,left:8,right:8}},title:{show:!0,fontSize:"16px",fontFamily:"Arial",fill:"#595959",wordBreak:"none",hyphens:"auto",maxLines:2,maxWidth:156,lineHeight:1.25,margin:{top:4,bottom:8,left:8,right:4}},buttons:{show:!1,rect:{fill:"transparent",stroke:"transparent",strokeWidth:0},symbol:{fill:"grey",stroke:"grey",strokeWidth:0},"rect:disabled":{fill:"transparent",stroke:"transparent",strokeWidth:0},"symbol:disabled":{fill:"lightgrey",stroke:"lightgrey",strokeWidth:0}}}},on:{tap:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=this.renderer.element().getBoundingClientRect(),i=this.renderer.findShapes(".scroll-button"),r=0;r<i.length;r++){var o=i[r];if(lf.testRectPoint(o.bounds,{x:t.center.x-n.left,y:t.center.y-n.top})){as(this,"+"===o.desc.action?e:-e);break}}},scroll:function(){as(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:3)},resetindex:function(){this.initState()}},createLocal:function(){var t=this.settings.settings,e=this.settings.dock||"center",n=t.direction||("top"===e||"bottom"===e?"horizontal":"vertical"),i="horizontal"===n,r=t.anchor,o="threshold-color"===this.scale.type,a="object"===xu(t.layout)&&"stack"===t.layout.mode,s=void 0;this.scale&&(s=(this.scale.data().fields||[])[0]),this.local={direction:n,anchor:r,isHorizontal:i,isThreshold:o,isStacked:a,sourceTitle:s?s.title():"",sourceField:s,formatter:s?s.formatter():this.formatter}},initState:function(){this.state={index:0,pageSize:0,fixedInnerWidth:0,fixedInnerHeight:0,maxShapeSize:0,preferredSize:0,pageMax:1/0,pageMin:0}},preferredSize:function(t){var e=this,n=e.settings,i=e.renderer,r=e.local,o=e.state,a=e.scale;o.defs=rs({scale:a,settings:n.settings,renderer:i,local:r}),o.titleDef=is({settings:n.settings,local:r,renderer:i}),o.buttonDefs=ns(n.settings);var s=es(o,r),c=s.maxOuterWidth,u=s.maxOuterHeight,l=s.maxInnerWidth,h=s.maxInnerHeight,f=s.maxShapeSize;return this.state.fixedInnerWidth=l,this.state.fixedInnerHeight=h,this.state.maxOuterWidth=c,this.state.maxOuterHeight=u,this.state.maxShapeSize=f,this.state.preferredSize="left"===this.settings.dock||"right"===this.settings.dock?c:u,this.local.isHorizontal&&c>t.inner.width?Math.max(t.inner.width,t.inner.height):!this.local.isHorizontal&&u>t.inner.height?Math.max(t.inner.width,t.inner.height):this.state.preferredSize},beforeUpdate:function(){this.createLocal(),this.initState()},created:function(){this.createLocal(),this.initState(),this.rect={x:0,y:0,width:0,height:0}},beforeRender:function(t){this.rect=t.size},render:function(){return os({chart:this.chart,settings:this.settings.settings,scale:this.scale,rect:this.rect,local:this.local,state:this.state})}},rd={require:["chart","settings","renderer"],defaultSettings:{displayOrder:0,dock:"right",settings:{size:15,length:.5,maxLengthPx:250,align:.5,justify:0,padding:{left:5,right:5,top:5,bottom:5},tick:{label:null,fill:"#595959",fontSize:"12px",fontFamily:"Arial",maxLengthPx:100,anchor:null,padding:5},title:{show:!0,text:"",fill:"#595959",fontSize:"12px",fontFamily:"Arial",maxLengthPx:100,padding:5,maxLines:2,wordBreak:"none",lineHeight:1.2,hyphens:"auto",anchor:null}}},preferredSize:function(t){var e=this.state;e.rect=ps(this,t.inner);var n=this.stgns.size,i=e.isVertical?this.stgns.padding.left+this.stgns.padding.right:this.stgns.padding.top+this.stgns.padding.bottom;n+=i;var r=Math.max(t.inner.width,t.inner.height);if("left"===e.ticks.anchor||"right"===e.ticks.anchor){if(e.ticks.values.reduce(function(t,e){return t+e.textMetrics.height},0)>this.state.legend.length())return r;n+=e.ticks.length}else{if(e.ticks.length>this.state.legend.length())return r;n+=Math.max.apply(Math,zu(e.ticks.values.map(function(t){return t.textMetrics.height})))}return n+=this.stgns.tick.padding,this.stgns.title.show&&(n="left"===e.title.anchor||"right"===e.title.anchor?Math.max(e.title.textBounds.height+i,n):Math.max(n,e.title.requiredWidth()+i)),this.state.preferredSize=n,n},created:function(){this.stgns=this.settings.settings,this.state=vs(this)},beforeUpdate:function(t){this.stgns=t.settings.settings,this.state=vs(this)},beforeRender:function(t){if(this.state.nodes=[],this.state.rect=ps(this,t.size),this.stgns.title.show){var e=us(this);this.state.nodes.push(e)}var n=ls(this,cs(this)),i={id:"legend-seq-target",type:"container",children:[n,hs(this,n)]};this.state.nodes.push(i)},render:function(){return this.state.nodes}},od={step:function(t){return new xt(t,.5)},stepAfter:function(t){return new xt(t,1)},stepBefore:function(t){return new xt(t,0)},linear:qu,basis:function(t){return new ot(t)},cardinal:Ku.tension(0),catmullRom:Qu,monotonex:function(t){return new gt(t)},monotoney:function(t){return new pt(t)},natural:function(t){return new vt(t)}},ad={coordinates:{minor:.5,major:.5,layerId:0},orientation:"horizontal",layers:{curve:"linear",show:!0,line:{stroke:"#ccc",strokeWidth:1,opacity:1,show:!0},area:{fill:"#ccc",opacity:.8,show:!0}}},sd={require:["chart"],created:function(){this.stngs=this.settings.settings||{}},beforeRender:function(t){var e=t.size;this.rect=e},render:function(t){for(var e=this,n=t.data,i=this.rect,r=i.width,o=i.height,a=this.stngs.orientation||"horizontal",s=gr(this.stngs.coordinates,ad.coordinates,this.chart),c=gr(this.stngs.layers.line,ad.layers.line,this.chart),u=gr(this.stngs.layers.area,ad.layers.area,this.chart),l=gr({curve:this.stngs.layers.curve,show:this.stngs.layers.show},{curve:ad.layers.curve,show:ad.layers.show},this.chart),h=void 0===this.stngs.coordinates.minor0,f={},d=0,g=0;g<n.items.length;g++){var p=n.items[g],y=pr(p,{layerId:s.layerId}).layerId;f[y]=f[y]||{order:d++,id:y,items:[],firstPoint:p},f[y].items.push(p)}var v=Object.keys(f).map(function(t){return f[t].firstPoint}),m=Object.keys(f).map(function(t){var e=f[t],n=pr(e.firstPoint,l,v);if(n&&!1===n.show)return null;for(var i=pr(e.firstPoint,c,v),r=pr(e.firstPoint,u,v),o=[],a=[],d=e.items.slice(),g=void 0,p=void 0,y=0;y<e.items.length;y++)g=pr(p=e.items[y],s,d),isNaN(g.major)||(h&&(g.minor0=s.minor.scale?s.minor.scale(p.minor0?p.minor0.value:0):0),o.push(g.minor),a.push(g));return{layerObj:n,lineObj:i,areaObj:r,median:o.sort(function(t,e){return t-e})[Math.floor((o.length-1)/2)],points:a,firstPoint:e.firstPoint}});m.sort(function(t,e){return t.median-e.median});var x=[];return m.forEach(function(t){var n=t.lineObj,i=t.layerObj,s=t.areaObj,c=t.points,u=Xu(),l=void 0,f=void 0;if("vertical"===a?(u.y(function(t){return t.major*o}).x1(function(t){return t.minor*r}).x0(function(t){return t.minor0*r}).defined(function(t){return"number"==typeof t.minor&&!isNaN(t.minor)}).curve(od["monotone"===i.curve?"monotoney":i.curve]),l=u.lineX1(),f=u.lineX0()):(u.x(function(t){return t.major*r}).y1(function(t){return t.minor*o}).y0(function(t){return t.minor0*o}).defined(function(t){return"number"==typeof t.minor&&!isNaN(t.minor)}).curve(od["monotone"===i.curve?"monotonex":i.curve]),l=u.lineY1(),f=u.lineY0()),e.stngs.layers.area&&!1!==s.show){var d=u(c);x.push({type:"path",d:d,opacity:s.opacity,stroke:s.stroke,strokeWidth:s.strokeWidth,fill:s.fill,data:t.firstPoint})}if(n&&!1!==n.show){var g=l(c);x.push({type:"path",d:g,opacity:n.opacity,stroke:n.stroke,strokeWidth:n.strokeWidth,fill:"none",data:t.firstPoint}),!h&&e.stngs.layers.area&&!1!==s.show&&(g=f(c),x.push({type:"path",d:g,opacity:n.opacity,stroke:n.stroke,strokeWidth:n.strokeWidth,fill:"none",data:t.firstPoint}))}}),x}},cd=[function(t){t.component("box-marker",zf)},function(t){t.component("point-marker",jf)},function(t){t.component("pie",Ff)},function(t){t.component("grid-line",Lf)},function(t){t.component("ref-line",Wf)},function(t){t.component("axis",Bf)},function(t){t.component("text",Hf)},function(t){t.component("scrollbar",If)},function(t){t.component("brush-range",qf),t.component("brush-area-dir",Yf)},function(t){t.component("range",Xf)},function(t){t.component("brush-lasso",$f)},function(t){t.component("labels",Kf)},function(t){t.component("legend-cat",id)},function(t){t.component("legend-seq",rd)},function(t){t.component("line",sd)}],ud=function(){function t(e){bu(this,t),this._parent=null,this._children=[],this._ancestors=null,this.type=e,this.data=null}return wu(t,[{key:"detach",value:function(){return this._parent&&this._parent.removeChild(this),this}},{key:"equals",value:function(t){var e=this.children,n=t.children;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(!e[i].equals(n[i]))return!1;return!0}},{key:"toJSON",value:function(){return{type:this.type,children:this.children.map(function(t){return t.toJSON()})}}},{key:"parent",get:function(){return this._parent}},{key:"isBranch",get:function(){return this._children&&this._children.length}},{key:"children",get:function(){return this._children}},{key:"ancestors",get:function(){if(!this._ancestors){var t=this._parent;this._ancestors=t?[t].concat(t.ancestors):[]}return this._ancestors}},{key:"descendants",get:function(){var t=[],e=void 0,n=void 0,i=void 0;for(e=0,n=this._children.length;e<n;e++)i=this._children[e],t.push(i),i._children.length&&(t=t.concat(i.descendants));return t}}]),t}(),ld=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.x,i=void 0===n?0:n,r=e.y,o=void 0===r?0:r,a=e.width,s=void 0===a?0:a,c=e.height,u=void 0===c?0:c,l=e.minWidth,h=void 0===l?0:l,f=e.minHeight,d=void 0===f?0:f;bu(this,t),this.set({x:i,y:o,width:s,height:u,minWidth:h,minHeight:d})}return wu(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=void 0===e?0:e,i=t.y,r=void 0===i?0:i,o=t.width,a=void 0===o?0:o,s=t.height,c=void 0===s?0:s,u=t.minWidth,l=void 0===u?0:u,h=t.minHeight,f=void 0===h?0:h;a>=0?(this.x=n,this.width=Math.max(a,l)):(this.x=n+Math.min(a,-l),this.width=-Math.min(a,-l)),c>=0?(this.y=r,this.height=Math.max(c,f)):(this.y=r+Math.min(c,-f),this.height=-Math.min(c,-f))}},{key:"containsPoint",value:function(t){return lf.testRectPoint(this,t)}},{key:"intersectsLine",value:function(t){var e=_(t);return lf.testRectLine(this,e)}},{key:"intersectsRect",value:function(t){var e=w(t);return lf.testRectRect(this,e)}},{key:"intersectsCircle",value:function(t){return lf.testCircleRect(t,this)}},{key:"intersectsPolygon",value:function(t){return lf.testPolygonRect(t,this)}},{key:"points",value:function(){return[{x:this.x,y:this.y},{x:this.x+this.width,y:this.y},{x:this.x+this.width,y:this.y+this.height},{x:this.x,y:this.y+this.height}]}}]),t}(),hd=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.cx,i=void 0===n?0:n,r=e.cy,o=void 0===r?0:r,a=e.r,s=void 0===a?0:a,c=e.minRadius,u=void 0===c?0:c;bu(this,t),this.set({cx:i,cy:o,r:s,minRadius:u})}return wu(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.cx,n=void 0===e?0:e,i=t.cy,r=void 0===i?0:i,o=t.r,a=void 0===o?0:o,s=t.minRadius,c=void 0===s?0:s;this.cx=n,this.cy=r,this.r=Math.max(a,c),this.vector={x:this.cx,y:this.cy}}},{key:"containsPoint",value:function(t){return lf.testCirclePoint(this,t)}},{key:"intersectsLine",value:function(t){var e=_(t);return lf.testCircleLine(this,e)}},{key:"intersectsRect",value:function(t){var e=w(t);return lf.testCircleRect(this,e)}},{key:"intersectsCircle",value:function(t){return lf.testCircleCircle(this,t)}},{key:"intersectsPolygon",value:function(t){return lf.testCirclePolygon(this,t)}},{key:"points",value:function(){return[{x:this.cx,y:this.cy}]}}]),t}(),fd=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.x1,i=void 0===n?0:n,r=e.y1,o=void 0===r?0:r,a=e.x2,s=void 0===a?0:a,c=e.y2,u=void 0===c?0:c,l=e.tolerance,h=void 0===l?0:l;bu(this,t),this.set({x1:i,y1:o,x2:s,y2:u,tolerance:h})}return wu(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x1,n=void 0===e?0:e,i=t.y1,r=void 0===i?0:i,o=t.x2,a=void 0===o?0:o,s=t.y2,c=void 0===s?0:s,u=t.tolerance,l=void 0===u?0:u;this.x1=n,this.y1=r,this.x2=a,this.y2=c,this.tolerance=Math.max(0,Math.round(l)),this.vectors=this.points(),this.zeroSize=n===a&&r===c}},{key:"containsPoint",value:function(t){if(this.tolerance>0){var e={cx:t.x,cy:t.y,r:this.tolerance};return lf.testCircleLine(e,this)}return lf.testLinePoint(this,t)}},{key:"intersectsLine",value:function(t){var e=_(t);return lf.testLineLine(this,e)}},{key:"intersectsRect",value:function(t){var e=w(t);return lf.testRectLine(e,this)}},{key:"intersectsCircle",value:function(t){return lf.testCircleLine(t,this)}},{key:"intersectsPolygon",value:function(t){return lf.testPolygonLine(t,this)}},{key:"points",value:function(){return[{x:this.x1,y:this.y1},{x:this.x2,y:this.y2}]}}]),t}(),dd=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).vertices,n=void 0===e?[]:e;bu(this,t),this.set({vertices:n})}return wu(t,[{key:"set",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).vertices,e=void 0===t?[]:t;if(this.vertices=e.slice(),this.edges=[],xs(this.vertices),!(this.vertices.length<=2)){ms(this.vertices);for(var n=0;n<this.vertices.length-1;n++)this.edges.push([this.vertices[n],this.vertices[n+1]]);this._minMax=null,this._bounds=null}}},{key:"containsPoint",value:function(t){return lf.testPolygonPoint(this,t)}},{key:"intersectsCircle",value:function(t){return lf.testCirclePolygon(t,this)}},{key:"intersectsLine",value:function(t){return lf.testPolygonLine(this,t)}},{key:"intersectsRect",value:function(t){return lf.testPolygonRect(this,t)}},{key:"intersectsPolygon",value:function(){return!1}},{key:"points",value:function(){return this.vertices}},{key:"bounds",value:function(){if(!this._bounds){this._minMax=this._minMax?this._minMax:b(this.vertices);var t=Ru(this._minMax,4),e=t[0],n=t[1],i=t[2],r=t[3];this._bounds=[{x:e,y:n},{x:i,y:n},{x:i,y:r},{x:e,y:r}]}return this._bounds}}]),t}(),gd=kt();gd.add("rect",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(ld,[null].concat(e)))}),gd.add("circle",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(hd,[null].concat(e)))}),gd.add("line",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(fd,[null].concat(e)))}),gd.add("polygon",bs);var pd=function(){function t(){bu(this,t),this._elements=[[1,0,0],[0,1,0],[0,0,1]],this._stack=[]}return wu(t,[{key:"clone",value:function(){return(new t).multiply(this)}},{key:"set",value:function(t){return this._elements=t,this}},{key:"save",value:function(){return this._stack.push(this.elements),this}},{key:"restore",value:function(){return this._stack.length&&(this._elements=this._stack.pop()),this}},{key:"add",value:function(t){var e=void 0,n=void 0;for(e=0;e<this._elements.length;e++)for(n=0;n<this._elements[e].length;n++)this._elements[e][n]+=t;return this}},{key:"translate",value:function(t,e){return this.multiply([[1,0,t],[0,1,e],[0,0,1]]),this}},{key:"rotate",value:function(t){var e=Math.cos(-t),n=Math.sin(-t);return this.multiply([[e,n,0],[-n,e,0],[0,0,1]]),this}},{key:"multiply",value:function(e){var n=void 0,i=void 0,r=void 0,o=void 0;if(e instanceof t&&(e=e._elements),Array.isArray(e)){for(r=[[0,0,0],[0,0,0],[0,0,0]],n=0;n<this._elements.length;n++)for(i=0;i<this._elements[n].length;i++)for(o=0;o<3;o++)r[n][i]+=this._elements[n][o]*e[o][i];this._elements=r}else for(n=0;n<this._elements.length;n++)for(i=0;i<this._elements[n].length;i++)this._elements[n][i]*=e;return this}},{key:"scale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this.multiply([[t,0,0],[0,e,0],[0,0,1]]),this}},{key:"transform",value:function(t,e,n,i,r,o){return this.multiply([[t,n,r],[e,i,o],[0,0,1]]),this}},{key:"determinant",value:function(){var t=this._elements[0][0],e=this._elements[0][1],n=this._elements[0][2],i=this._elements[1][0],r=this._elements[1][1],o=this._elements[1][2],a=this._elements[2][0],s=this._elements[2][1],c=this._elements[2][2];return t*r*c+e*o*a+n*i*s-n*r*a-e*i*c-t*o*s}},{key:"invert",value:function(){var t=this.determinant(),e=this._elements[0][0],n=this._elements[0][1],i=this._elements[0][2],r=this._elements[1][0],o=this._elements[1][1],a=this._elements[1][2],s=this._elements[2][0],c=this._elements[2][1],u=this._elements[2][2];return this._elements=[[o*u-a*c,i*c-n*u,n*a-i*o],[a*s-r*u,e*u-i*s,i*r-e*a],[r*c-o*s,s*n-e*c,e*o-n*r]],this.multiply(1/t),this}},{key:"transpose",value:function(){var t=Object.create(this._elements);return this._elements=[[t[0][0],t[1][0],t[2][0]],[t[0][1],t[1][1],t[2][1]],[t[0][2],t[1][2],t[2][2]]],this}},{key:"identity",value:function(){return this._elements=[[1,0,0],[0,1,0],[0,0,1]],this}},{key:"toString",value:function(){return""+this._elements.map(function(t){return t.join("\t")}).join("\n")}},{key:"isIdentity",value:function(){var t=this._elements;return 1===t[0][0]&&0===t[0][1]&&0===t[0][2]&&0===t[1][0]&&1===t[1][1]&&0===t[1][2]&&0===t[2][0]&&0===t[2][1]&&1===t[2][2]}},{key:"transformPoint",value:function(t){var e=[t.x,t.y,1],n=void 0,i=void 0,r=this._elements,o=[0,0,0];for(n=0;n<this._elements.length;n++)for(i=0;i<this._elements[n].length;i++)o[n]+=e[i]*r[n][i];return{x:o[0],y:o[1]}}},{key:"transformPoints",value:function(t){var e=void 0,n=void 0,i=void 0,r=void 0,o=void 0,a=this._elements,s=[];for(r=0;r<t.length;r++){for(e=[t[r].x,t[r].y,1],o=[0,0,0],n=0;n<this._elements.length;n++)for(i=0;i<this._elements[n].length;i++)o[n]+=e[i]*a[n][i];s.push({x:o[0],y:o[1]})}return s}},{key:"elements",get:function(){var t=this._elements;return[[t[0][0],t[0][1],t[0][2]],[t[1][0],t[1][1],t[1][2]],[t[2][0],t[2][1],t[2][2]]]}}]),t}(),yd=/(translate|scale|rotate|matrix)\(([0-9,.eE+-\s]+)(?:,|\s?)+\)/g,vd={type:/^\w[\w-]+/,attr:/^\[\w(?:[\w\._-]+)?(?:[!]?=['\"][\w\s*#_-]*['\"])?\]/,universal:/^(\*)/,tag:/^\.(\w+)/},md={type:function(t,e){return e.filter(function(e){var n=e.type;return!!n&&n.toLowerCase()===t.toLowerCase()})},attr:function(t,e,n,i){return i.filter(function(i){var r=i.attrs[t];if(!e)return void 0!==r;if(void 0===r)return!1;switch(e){case"=":return n===String(r);case"!=":return n!==String(r);default:return!1}})},universal:function(t){return t},tag:function(t,e){return e.filter(function(e){var n=e.tag;return!!n&&-1!==n.indexOf(t.replace(".",""))})}},xd={find:function(t,e){var n=[],i=[],r=void 0,o=void 0;if(e.isBranch){r=Ns(t),o=e.descendants;for(var a=void 0,s=0,c=r.length;s<c;s++)!function(t,e){a=r[t];var n=[],s=o.slice(),c=!1;a.reverse().forEach(function(t){if(" "===t.type)return n.push(s),s=o.slice(),void(c=!1);s=Os(t,s),c=!0}),c&&n.push(s);var u=n[0].filter(function(t){for(var e=t.parent,i=void 0,r=1;r<n.length;r++){for(i=n[r].indexOf(e);e&&i<0;)e=e.parent,i=n[r].indexOf(e);if(i<0)return!1}return!0});i.push(u)}(s);for(var u=0,l=i.length;u<l;u++)for(var h=0,f=i[u].length;h<f;h++)n.indexOf(i[u][h])<0&&n.push(i[u][h])}return n||[]}},bd=function(){function t(e){var n=this;bu(this,t),this._bounds=e.boundingRect?function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e.boundingRect(t)}:function(){return{x:0,y:0,width:0,height:0}},this._attrs=e.attrs,this._type=e.type,this._data=e.data,this._dpi=e.stage?e.stage.dpi:1,this._collider=function(){return As(e,n._dpi)},this._desc=e.desc,this._tag=e.tag}return wu(t,[{key:"type",get:function(){return this._type}},{key:"data",get:function(){return this._data}},{key:"attrs",get:function(){return this._attrs}},{key:"element",get:function(){return this._element},set:function(t){this._element=t}},{key:"key",get:function(){return this._key},set:function(t){this._key=t}},{key:"bounds",get:function(){var t=this._bounds();return t.x/=this._dpi,t.y/=this._dpi,t.width/=this._dpi,t.height/=this._dpi,t}},{key:"localBounds",get:function(){return this._bounds(!1)}},{key:"collider",get:function(){return this._collider()}},{key:"desc",get:function(){return this._desc}},{key:"tag",get:function(){return this._tag}}]),t}(),wd=function(){function t(e){bu(this,t),this._node=Es(e),this._parent=null,this._input=null}return wu(t,[{key:"node",get:function(){return this._node}},{key:"parent",set:function(t){this._parent=t},get:function(){return this._parent}},{key:"input",set:function(t){this._input=t},get:function(){return this._input}}]),t}(),kd=function(t){function e(t){bu(this,e);var n=Su(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._stage=null,n._collider=null,n._attrs={},n._node=null,n}return Mu(e,ud),wu(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.node=t;var e=t.data,n=t.desc,i=t.tag;wr(this.attrs,t),void 0!==e&&(this.data=e),"object"===(void 0===n?"undefined":xu(n))&&(this.desc=vu(!0,{},n)),"string"==typeof i&&(this.tag=i)}},{key:"collider",value:function(t){if(void 0===t)return this._collider;var e=t.type,n=void 0===e?null:e,i={type:n};return n?this._collider&&this._collider.type===n?this._collider.fn.set(t):"frontChild"===n?this._collider=i:"bounds"===n?(i.fn=ws("rect",t),this._collider=i):-1!==["line","rect","circle","polygon"].indexOf(n)&&(i.fn=ws(n,t),this._collider=i):this._collider=null,this._collider}},{key:"findShapes",value:function(t){return xd.find(t,this).map(function(t){return Es(t)})}},{key:"getItemsFrom",value:function(t){return Is(this,t)}},{key:"containsPoint",value:function(t){return Vs(this,t)}},{key:"intersectsLine",value:function(t){return Vs(this,t)}},{key:"intersectsRect",value:function(t){return Vs(this,t)}},{key:"intersectsCircle",value:function(t){return Vs(this,t)}},{key:"intersectsPolygon",value:function(t){return Vs(this,t)}},{key:"resolveLocalTransform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new pd;void 0!==this.attrs.transform&&zs(this.attrs.transform,t),this.modelViewMatrix=t.clone()}},{key:"resolveGlobalTransform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new pd,e=this.ancestors;if(e.length>0)for(var n=e.length-1;n>=0;n--)e[n].resolveLocalTransform(t),t=e[n].modelViewMatrix;this.resolveLocalTransform(t)}},{key:"attr",value:function(t){return this.attrs[t]}},{key:"equals",value:function(t){var n=this.attrs,i=Object.keys(n),r=t.attrs,o=Object.keys(r);if(i.length!==o.length)return!1;for(var a=0;a<i.length;a++){var s=i[a];if(!Object.hasOwnProperty.call(r,s))return!1;if(n[s]!==r[s])return!1}return _u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"equals",this).call(this,t)}},{key:"toJSON",value:function(){var t=_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"toJSON",this).call(this);return t.attrs=this.attrs,t}},{key:"attrs",get:function(){return this._attrs}},{key:"stage",get:function(){return this._parent&&!this._stage?this._stage=this._parent.stage:this._parent||this._stage===this||(this._stage=null),this._stage}},{key:"modelViewMatrix",set:function(t){this._mvm=t,this._imvm=null},get:function(){return this._mvm}},{key:"inverseModelViewMatrix",get:function(){return this._imvm=this._imvm?this._imvm:this._mvm.clone().invert(),this._imvm}},{key:"node",set:function(t){this._node=t},get:function(){return this._node}}]),e}(),_d=function(t){function e(){return bu(this,e),Su(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return Mu(e,ud),wu(e,[{key:"addChild",value:function(t){if(!(t&&t instanceof ud))throw new TypeError("Expecting a Node as argument, but got "+t);if(t===this)throw new Error("Can not add itself as child!");if(t._children&&t._children.length&&this.ancestors.indexOf(t)>=0)throw new Error("Can not add an ancestor as child!");t._parent&&t._parent!==this&&t._parent.removeChild(t);var e=this._children.indexOf(t);return e>=0&&this._children.splice(e,1),this._children.push(t),t._parent=this,t._ancestors=null,this}},{key:"addChildren",value:function(t){var e=void 0,n=t?t.length:0;for(e=0;e<n;e++)this.addChild(t[e]);return this}},{key:"removeChild",value:function(t){var e=this._children.indexOf(t);return e>=0&&(this._children.splice(e,1),t._parent=null,t._ancestors=null),this}},{key:"removeChildren",value:function(t){var e=void 0,n=void 0;if(!this._children)return this;if(t)for(n=t.length,e=0;e<n;e++)this.removeChild(t[e]);else for(;this._children.length;)this.removeChild(this._children[0]);return this}}]),e}(),Md=_d.prototype,Sd=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};bu(this,e);var n=t.type,i=void 0===n?"container":n,r=Su(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i));return r.set(t),r._boundingRect={},r}return Mu(e,kd),wu(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"set",this).call(this,t);var n=t.collider,i=vu({type:null},n);_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"collider",this).call(this,i)}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.children.length;this._boundingRect={};for(var n=0;n<e;n++)Us(this,this.children[n],t);return vu({x:0,y:0,width:0,height:0},this._boundingRect)}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.boundingRect(t);return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}},{key:"addChild",value:function(t){var n=Md.addChild.call(this,t);if(this._collider&&"bounds"===this._collider.type){Us(this,t,!0);var i=vu({type:"bounds",x:0,y:0,width:0,height:0},this._boundingRect);_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"collider",this).call(this,i)}return n}},{key:"addChildren",value:function(t){var n=Md.addChildren.call(this,t),i=t.length;if(this._collider&&"bounds"===this._collider.type&&i>0){for(var r=0;r<i;r++)Us(this,t[r],!0);var o=vu({type:"bounds",x:0,y:0,width:0,height:0},this._boundingRect);_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"collider",this).call(this,o)}return n}},{key:"removeChild",value:function(t){t._stage=null;var n=t.descendants,i=n?n.length:0,r=void 0;for(r=0;r<i;r++)n[r]._stage=null;if(Md.removeChild.call(this,t),this._collider&&"bounds"===this._collider.type){var o=vu(this.boundingRect(!0),{type:"bounds"});_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"collider",this).call(this,o)}return this}},{key:"removeChildren",value:function(t){if(Md.removeChildren.call(this,t),this._collider&&"bounds"===this._collider.type){var n=vu(this.boundingRect(!0),{type:"bounds"});_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"collider",this).call(this,n)}return this}}]),e}(),Rd=function(t){function e(t){bu(this,e);var n=Su(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"stage"));return n._stage=n,n._dpiRatio=t||1,n}return Mu(e,Sd),wu(e,[{key:"dpi",get:function(){return this._dpiRatio}}]),e}(),zd=_d.prototype,Od=["x1","x2","y1","y2","id","offset","style"],Nd=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};bu(this,e);var n=t.type,i=void 0===n?"container":n,r=Su(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i));return r.set(t),r._boundingRect={},r}return Mu(e,kd),wu(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"set",this).call(this,t);for(var n=this.attrs,i="",r=0,o=Od.length;r!==o;r++)t[i=Od[r]]&&(n[i]=t[i])}},{key:"addChild",value:function(t){return zd.addChild.call(this,t)}},{key:"addChildren",value:function(t){return zd.addChildren.call(this,t)}},{key:"removeChild",value:function(t){t._stage=null;var e=t.descendants,n=e?e.length:0,i=void 0;for(i=0;i<n;i++)e[i]._stage=null;return zd.removeChild.call(this,t),this}},{key:"removeChildren",value:function(t){return zd.removeChildren.call(this,t),this}}]),e}(),Ad=function(t){function e(){bu(this,e);var t=Su(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"rect"));return t.set.apply(t,arguments),t}return Mu(e,kd),wu(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.x,i=void 0===n?0:n,r=t.y,o=void 0===r?0:r,a=t.width,s=void 0===a?0:a,c=t.height,u=void 0===c?0:c,l=t.collider,h=vu({type:"rect",x:i,y:o,width:s,height:u},l);_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"set",this).call(this,t),_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"collider",this).call(this,h),s>=0?(this.attrs.x=i,this.attrs.width=s):(this.attrs.x=i+s,this.attrs.width=-s),u>=0?(this.attrs.y=o,this.attrs.height=u):(this.attrs.y=o+u,this.attrs.height=-u)}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=x(this.attrs),n=b(t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(e):e),i=Ru(n,4),r=i[0],o=i[1];return{x:r,y:o,width:i[2]-r,height:i[3]-o}}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.boundingRect(t);return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}}]),e}(),Ed=function(t){function e(){bu(this,e);var t=Su(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"circle"));return t.set.apply(t,arguments),t}return Mu(e,kd),wu(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.cx,i=void 0===n?0:n,r=t.cy,o=void 0===r?0:r,a=t.r,s=void 0===a?0:a,c=t.collider,u=vu({type:"circle",cx:i,cy:o,r:s},c);_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"set",this).call(this,t),_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"collider",this).call(this,u),this.attrs.cx=i,this.attrs.cy=o,this.attrs.r=s}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.bounds(t);return{x:e[0].x,y:e[0].y,width:e[2].x-e[0].x,height:e[2].y-e[0].y}}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.attrs,n=e.cx,i=e.cy,r=e.r,o=e.r,a=n-r,s=i-o,c=2*r,u=2*o,l=[{x:a,y:s},{x:a+c,y:s},{x:a+c,y:s+u},{x:a,y:s+u}];if(t&&this.modelViewMatrix){var h=b(l=this.modelViewMatrix.transformPoints(l)),f=Ru(h,4),d=f[0],g=f[1];return c=f[2]-d,u=f[3]-g,[{x:d,y:g},{x:d+c,y:g},{x:d+c,y:g+u},{x:d,y:g+u}]}return l}}]),e}(),Cd=function(t){function e(){bu(this,e);var t=Su(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"line"));return t.set.apply(t,arguments),t}return Mu(e,kd),wu(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.x1,i=void 0===n?0:n,r=t.y1,o=void 0===r?0:r,a=t.x2,s=void 0===a?0:a,c=t.y2,u=void 0===c?0:c,l=t.collider;_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"set",this).call(this,t),this.attrs.x1=i,this.attrs.y1=o,this.attrs.x2=s,this.attrs.y2=u;var h={type:"line",x1:i,y1:o,x2:s,y2:u};_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"collider",this).call(this,vu(h,l))}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=m(this.attrs);t&&this.modelViewMatrix&&(e=this.modelViewMatrix.transformPoints(e));var n=b(e),i=Ru(n,4),r=i[0],o=i[1],a=i[2],s=i[3],c=r!==a||o!==s;return{x:r,y:o,width:c?Math.max(1,a-r):0,height:c?Math.max(1,s-o):0}}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.boundingRect(t);return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}}]),e}(),Td=function(t){function e(){bu(this,e);var t=Su(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"path"));return t.set.apply(t,arguments),t}return Mu(e,kd),wu(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"set",this).call(this,t),this.attrs.d=t.d,_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"collider",this).call(this,t.collider),this.points=null}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.points=this.points?this.points:Ys(this.attrs.d);var e=b(t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(this.points):this.points),n=Ru(e,4),i=n[0],r=n[1],o=n[2],a=n[3];return{x:i||0,y:r||0,width:o-i||0,height:a-r||0}}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.boundingRect(t);return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}}]),e}(),jd=function(t){function e(){bu(this,e);var t=Su(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"text"));return t.set.apply(t,arguments),t}return Mu(e,kd),wu(e,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.x,i=void 0===n?0:n,r=t.y,o=void 0===r?0:r,a=t.dx,s=void 0===a?0:a,c=t.dy,u=void 0===c?0:c,l=t.textBoundsFn,h=t.text,f=t.collider,d=t.boundingRect;_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"set",this).call(this,t),_u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"collider",this).call(this,f),this.attrs.x=i,this.attrs.y=o,this.attrs.dx=s,this.attrs.dy=u,this.attrs.text=h,d?this._boundingRect=d:"function"==typeof l&&(this._boundingRect=l(this.attrs))}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._boundingRect)return{x:0,y:0,width:0,height:0};var e=x(this._boundingRect),n=b(t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(e):e),i=Ru(n,4),r=i[0],o=i[1];return{x:r,y:o,width:i[2]-r,height:i[3]-o}}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.boundingRect(t);return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}}]),e}(),Pd=kt();Pd.add("rect",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(Ad,[null].concat(e)))}),Pd.add("circle",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(Ed,[null].concat(e)))}),Pd.add("text",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(jd,[null].concat(e)))}),Pd.add("line",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(Cd,[null].concat(e)))}),Pd.add("path",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(Td,[null].concat(e)))}),Pd.add("stage",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(Rd,[null].concat(e)))}),Pd.add("container",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(Sd,[null].concat(e)))}),Pd.add("defs",qs),Pd.add("linearGradient",qs),Pd.add("radialGradient",qs),Pd.add("stop",qs);var Fd=function(){function t(){return n[n.length-1]}var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[{}];return t.save=function(){for(var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t(),o={},a="",s=0;s<e.length;s++)void 0!==r[a=e[s]]&&(o[a]=r[a]);return vu(o,i),n.push(o),t()},t.restore=function(){n.splice(n.length-1,1)},t}(["stroke","fill","strokeWidth","opacity","fontFamily","fontSize","baseline"]),Ld=/\n+|\r+|\r\n/,Wd=/\s/,Dd=/[a-zA-Z\u00C0-\u00F6\u00F8-\u00FF\u00AD]/,Bd=0,Hd=1,Id=2,Vd=1.2,Ud="‐",qd="…",Yd={},Xd={},$d=void 0,Zd=kt(),Gd=new RegExp("[A-Za-zªµºÀ-ÖØ-öø-ʸʻ-ˁː-ˑˠ-ˤˮͰ-ͳͶ-ͽΆΈ-ϵϷ-҂Ҋ-։ः-हऻऽ-ीॉ-ौॎ-ॐक़-ॡ।-ॿং-হঽ-ীে-ৌৎ-ৡ০-ৱ৴-৺ਃ-ਹਾ-ੀਖ਼-੯ੲ-ੴઃ-હઽ-ીૉ-ૌૐ-ૡ૦-૯ଂ-ହଽ-ାୀେ-ୌୗ-ୡ୦-୷ஃ-ிு-ௌௐ-௲ఁ-ఽు-ౄౘ-ౡ౦-౯౿-ಹಽ-ೋೕ-ೡ೦-ീെ-ൌൎ-ൡ൦-ෆා-ෑෘ-ะา-ำเ-ๆ๏-ະາ-ຳຽ-ໆ໐-༗༚-༴༶༸༾-ཬཿ྅ྈ-ྌ྾-࿅࿇-ာေးျ-ြဿ-ၗၚ-ၝၡ-ၰၵ-ႁႃ-ႄႇ-ႌႎ-ႜ႞-ፚ፠-ᎏᎠ-Ᏼᐁ-ᙿᚁ-ᚚᚠ-ᜑᜠ-ᜱ᜵-ᝑᝠ-ᝰក-ាើ-ៅះ-ៈ។-៚ៜ០-៩᠐-ᢨᢪ-ᤜᤣ-ᤦᤩ-ᤱᤳ-ᤸ᥆-᧚ᨀ-ᨖᨙ-ᩕᩗᩡᩣ-ᩤᩭ-ᩲ᪀-᪭ᬄ-ᬳᬵᬻᬽ-ᭁᭃ-᭪᭴-᭼ᮂ-ᮡᮦ-ᮧ᮪-ᯥᯧᯪ-ᯬᯮ᯲-ᰫᰴ-ᰵ᰻-᱿᳓᳡ᳩ-ᳬᳮ-ᶿḀ-ᾼιῂ-ῌῐ-Ίῠ-Ῥῲ-ῼ‎ⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎ-⅏Ⅰ-ↈ⌶-⍺⎕⒜-ⓩ⚬⠀-⣿Ⰰ-ⳤⳫ-ⳮⴀ-⵰ⶀ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ㆺㇰ-㈜㈠-㉏㉠-㉻㉿-㊰㋀-㋋㋐-㍶㍻-㏝㏠-㏾㐀-䶵一-ꒌꓐ-ꘌꘐ-ꙮꚀ-ꛯ꛲-꛷Ꜣ-ꞇ꞉-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠤꠧ꠰-꠷ꡀ-ꡳꢀ-ꣃ꣎-꣙ꣲ-ꤥ꤮-ꥆꥒ-ꥼꦃ-ꦲꦴ-ꦵꦺ-ꦻꦽ-ꨨꨯ-ꨰꨳ-ꨴꩀ-ꩂꩄ-ꩋꩍ-ꪯꪱꪵ-ꪶꪹ-ꪽꫀꫂ-ꯤꯦ-ꯧꯩ-꯬꯰-ﬗＡ-Ｚａ-ｚｦ-ￜ]"),Jd=new RegExp("[־׀׃׆א-״߀-ߪߴ-ߵߺ-ࠕࠚࠤࠨ࠰-ࡘ࡞‏יִײַ-ﬨשׁ-ﭏ]"),Kd=new RegExp("[؈؋؍؛-ي٭-ٯٱ-ەۥ-ۦۮ-ۯۺ-܍ܐܒ-ܯݍ-ޥޱﭐ-ﴽﵐ-﷼ﹰ-ﻼ]"),Qd={start:"end",end:"start",center:"center",middle:"middle"};Tc("rect",function(t,e){var n=e.g,i=e.doFill,r=e.doStroke;n.beginPath(),n.rect(t.x,t.y,t.width,t.height),i&&n.fill(),r&&n.stroke()}),Tc("circle",function(t,e){var n=e.g,i=e.doFill,r=e.doStroke;n.beginPath(),n.moveTo(t.cx+t.r,t.cy),n.arc(t.cx,t.cy,t.r,0,2*Math.PI,!1),i&&n.fill(),r&&n.stroke()}),Tc("line",function(t,e){var n=e.g,i=e.doStroke;n.beginPath(),n.moveTo(t.x1,t.y1),n.lineTo(t.x2,t.y2),i&&n.stroke()}),Tc("path",function(t,e){var n=e.g,i=e.doStroke,r=e.doFill,o=new Path2D(t.d);r&&n.fill(o),i&&n.stroke(o)}),Tc("text",function(t,e){var n=e.g,i=xc(t,kc);n.font=t["font-size"]+" "+t["font-family"],n.canvas.dir=Fc(t.text);var r="middle"===t["text-anchor"]?"center":t["text-anchor"];n.textAlign=Lc(r,n.canvas.dir),n.textBaseline=Wc(t["dominant-baseline"]),n.fillText(i,t.x+t.dx,t.y+t.dy)});for(var tg="http://www.w3.org/2000/svg",eg=function(t,e){if(!t||"string"!=typeof t)throw new Error("Invalid type: "+t);var n=e.ownerDocument.createElementNS(tg,"container"===t?"g":t);return e.appendChild(n),n},ng=function(t){t.parentNode&&t.parentNode.removeChild(t)},ig=function(t,e){for(var n in e.attrs)if("text"===n){t.setAttribute("style","white-space: pre"),t.textContent=xc(e.attrs,kc);var i=Fc(e.attrs.text);"rtl"===i&&(t.setAttribute("direction","rtl"),t.setAttribute("dir","rtl"),t.setAttribute("text-anchor",Lc(t.getAttribute("text-anchor"),i)))}else t.setAttribute(n,e.attrs[n]);if("string"==typeof e.data||"number"==typeof e.data||"boolean"==typeof e.data)t.setAttribute("data",e.data);else if("object"===xu(e.data)&&null!==e.data)for(var r in e.data)"string"!=typeof e.data[r]&&"number"!=typeof e.data[r]&&"boolean"!=typeof e.data[r]||t.setAttribute("data-"+r,e.data[r])},rg=function(){function t(e,n,i,r){bu(this,t),this.create=e,this.nodeCreator=n,this.nodeMaintainer=i,this.nodeDestroyer=r}return wu(t,[{key:"render",value:function(t,e){return this.create([],t,e,this.nodeCreator,this.nodeMaintainer,this.nodeDestroyer)}}]),t}(),og=[],ag={},sg=function(t,e,n,i,r){return{sel:t,data:e,children:n,text:i,elm:r,key:void 0===e?void 0:e.key}},cg={array:Array.isArray,primitive:function(t){return"string"==typeof t||"number"==typeof t}},ug={createElement:function(t){return document.createElement(t)},createElementNS:function(t,e){return document.createElementNS(t,e)},createTextNode:function(t){return document.createTextNode(t)},appendChild:function(t,e){t.appendChild(e)},removeChild:function(t,e){t.removeChild(e)},insertBefore:function(t,e,n){t.insertBefore(e,n)},parentNode:function(t){return t.parentElement},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e}},lg=sg("",{},[],void 0,void 0),hg=["create","update","remove","destroy","pre","post"],fg={init:function(t,e){function n(t){var n=t.id?"#"+t.id:"",i=t.className?"."+t.className.split(" ").join("."):"";return sg(e.tagName(t).toLowerCase()+n+i,{},[],void 0,t)}function i(t,n){return function(){if(0==--n){var i=e.parentNode(t);e.removeChild(i,t)}}}function r(t,n){var i,o=t.data;Kc(o)&&Kc(i=o.hook)&&Kc(i=i.init)&&(i(t),o=t.data);var a,s=t.children,c=t.sel;if(Kc(c)){var u=c.indexOf("#"),l=c.indexOf(".",u),h=u>0?u:c.length,d=l>0?l:c.length,g=-1!==u||-1!==l?c.slice(0,Math.min(h,d)):c;if(a=t.elm=Kc(o)&&Kc(i=o.ns)?e.createElementNS(i,g):e.createElement(g),h<d&&(a.id=c.slice(h+1,d)),l>0&&(a.className=c.slice(d+1).replace(/\./g," ")),cg.array(s))for(i=0;i<s.length;++i)e.appendChild(a,r(s[i],n));else cg.primitive(t.text)&&e.appendChild(a,e.createTextNode(t.text));for(i=0;i<f.create.length;++i)f.create[i](lg,t);Kc(i=t.data.hook)&&(i.create&&i.create(lg,t),i.insert&&n.push(t))}else a=t.elm=e.createTextNode(t.text);return t.elm}function o(t,n,i,o,a,s){for(;o<=a;++o)e.insertBefore(t,r(i[o],s),n)}function a(t){var e,n,i=t.data;if(Kc(i)){for(Kc(e=i.hook)&&Kc(e=e.destroy)&&e(t),e=0;e<f.destroy.length;++e)f.destroy[e](t);if(Kc(e=t.children))for(n=0;n<t.children.length;++n)a(t.children[n])}}function s(t,n,r,o){for(;r<=o;++r){var s,c,u,l=n[r];if(Kc(l))if(Kc(l.sel)){for(a(l),c=f.remove.length+1,u=i(l.elm,c),s=0;s<f.remove.length;++s)f.remove[s](l,u);Kc(s=l.data)&&Kc(s=s.hook)&&Kc(s=s.remove)?s(l,u):u()}else e.removeChild(t,l.elm)}}function c(t,n,i,a){for(var c,l,h,f=0,d=0,g=n.length-1,p=n[0],y=n[g],v=i.length-1,m=i[0],x=i[v];f<=g&&d<=v;)Jc(p)?p=n[++f]:Jc(y)?y=n[--g]:Qc(p,m)?(u(p,m,a),p=n[++f],m=i[++d]):Qc(y,x)?(u(y,x,a),y=n[--g],x=i[--v]):Qc(p,x)?(u(p,x,a),e.insertBefore(t,p.elm,e.nextSibling(y.elm)),p=n[++f],x=i[--v]):Qc(y,m)?(u(y,m,a),e.insertBefore(t,y.elm,p.elm),y=n[--g],m=i[++d]):(Jc(c)&&(c=tu(n,f,g)),Jc(l=c[m.key])?(e.insertBefore(t,r(m,a),p.elm),m=i[++d]):(u(h=n[l],m,a),n[l]=void 0,e.insertBefore(t,h.elm,p.elm),m=i[++d]));f>g?o(t,Jc(i[v+1])?null:i[v+1].elm,i,d,v,a):d>v&&s(t,n,f,g)}function u(t,n,i){var a,u;Kc(a=n.data)&&Kc(u=a.hook)&&Kc(a=u.prepatch)&&a(t,n);var l=n.elm=t.elm,h=t.children,d=n.children;if(t!==n){if(!Qc(t,n)){var g=e.parentNode(t.elm);return l=r(n,i),e.insertBefore(g,l,t.elm),void s(g,[t],0,0)}if(Kc(n.data)){for(a=0;a<f.update.length;++a)f.update[a](t,n);Kc(a=n.data.hook)&&Kc(a=a.update)&&a(t,n)}Jc(n.text)?Kc(h)&&Kc(d)?h!==d&&c(l,h,d,i):Kc(d)?(Kc(t.text)&&e.setTextContent(l,""),o(l,null,d,0,d.length-1,i)):Kc(h)?s(l,h,0,h.length-1):Kc(t.text)&&e.setTextContent(l,""):t.text!==n.text&&e.setTextContent(l,n.text),Kc(u)&&Kc(a=u.postpatch)&&a(t,n)}}var l,h,f={};for(Jc(e)&&(e=ug),l=0;l<hg.length;++l)for(f[hg[l]]=[],h=0;h<t.length;++h)void 0!==t[h][hg[l]]&&f[hg[l]].push(t[h][hg[l]]);return function(t,i){var o,a,c,l=[];for(o=0;o<f.pre.length;++o)f.pre[o]();for(Jc(t.sel)&&(t=n(t)),Qc(t,i)?u(t,i,l):(a=t.elm,c=e.parentNode(a),r(i,l),null!==c&&(e.insertBefore(c,i.elm,e.nextSibling(a)),s(c,[t],0,0))),o=0;o<l.length;++o)l[o].data.hook.insert(l[o]);for(o=0;o<f.post.length;++o)f.post[o]();return i}}},dg={xlink:"http://www.w3.org/1999/xlink"},gg=["allowfullscreen","async","autofocus","autoplay","checked","compact","controls","declare","default","defaultchecked","defaultmuted","defaultselected","defer","disabled","draggable","enabled","formnovalidate","hidden","indeterminate","inert","ismap","itemscope","loop","multiple","muted","nohref","noresize","noshade","novalidate","nowrap","open","pauseonexit","readonly","required","reversed","scoped","seamless","selected","sortable","spellcheck","translate","truespeed","typemustmatch","visible"],pg=Object.create(null),yg=0,vg=gg.length;yg<vg;yg++)pg[gg[yg]]=!0;var mg={create:eu,update:eu},xg={create:nu,update:nu},bg="undefined"!=typeof window&&window.requestAnimationFrame||setTimeout,wg=function(t){bg(function(){bg(t)})},kg={create:ru,update:ru,destroy:function(t){var e,n,i=t.elm,r=t.data.style;if(r&&(e=r.destroy))for(n in e)i.style[n]=e[n]},remove:function(t,e){var n=t.data.style;if(n&&n.remove){var i,r,o=t.elm,a=0,s=n.remove,c=0,u=[];for(i in s)u.push(i),o.style[i]=s[i];for(var l=(r=getComputedStyle(o))["transition-property"].split(", ");a<l.length;++a)-1!==u.indexOf(l[a])&&c++;o.addEventListener("transitionend",function(t){t.target===o&&--c,0===c&&e()})}else e()}},_g={create:cu,update:cu,destroy:cu},Mg=function(t,e,n){var i,r,o,a={};if(void 0!==n?(a=e,cg.array(n)?i=n:cg.primitive(n)&&(r=n)):void 0!==e&&(cg.array(e)?i=e:cg.primitive(e)?r=e:a=e),cg.array(i))for(o=0;o<i.length;++o)cg.primitive(i[o])&&(i[o]=sg(void 0,void 0,void 0,i[o]));return"s"===t[0]&&"v"===t[1]&&"g"===t[2]&&uu(a,i,t),sg(t,a,i,r,void 0)},Sg=fg.init([mg,xg,kg,_g]),Rg=[function(t){t.renderer("svg",Gc)},function(t){t.renderer("canvas",Cc)},function(t){t.renderer("dom",lu)}],zg=[],Og={OFF:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},Ng=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.level,i=void 0===n?Og.OFF:n,r=e.pipe,o=void 0===r?console:r,a=i,s=(t={},ku(t,Og.OFF,function(){}),ku(t,Og.ERROR,function(){return o.error.apply(o,arguments)}),ku(t,Og.WARN,function(){return o.warn.apply(o,arguments)}),ku(t,Og.INFO,function(){return o.info.apply(o,arguments)}),ku(t,Og.DEBUG,function(){return o.log.apply(o,arguments)}),t),c=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];!t||a<t||(s[t]||s[Og.DEBUG]).apply(void 0,n)};return{log:c,error:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return c.apply(void 0,[Og.ERROR].concat(e))},warn:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return c.apply(void 0,[Og.WARN].concat(e))},info:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return c.apply(void 0,[Og.INFO].concat(e))},debug:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return c.apply(void 0,[Og.DEBUG].concat(e))},level:function(t){return"number"==typeof t&&(a=t),a},LOG_LEVEL:Og}},Ag=fu({renderer:{prio:["svg","canvas"]},logger:{level:0},style:{"$font-family":"Arial","$font-size-m":"12px","$line-height-m":"16px",$primary:"steelblue",$shape:{fill:"$primary",strokeWidth:0,stroke:"#ccc"}},palettes:[{key:"categorical",colors:[["#a54343","#d76c6c","#ec983d","#ecc43d","#f9ec86","#cbe989","#70ba6e","#578b60","#79d69f","#26a0a7","#138185","#65d3da"]]},{key:"diverging",colors:[["#3d52a1","#3a89c9","#77b7e5","#b4ddf7","#e6f5fe","#ffe3aa","#f9bd7e","#ed875e","#d24d3e","#ae1c3e"]]},{key:"sequential",colors:[["rgb(180,221,212)","rgb(34, 83, 90)"]]}]},{component:pf,data:bf,formatter:Il,interaction:wf,renderer:gf(),scale:nf});return cd.forEach(Ag.use),Rg.forEach(Ag.use),zg.forEach(Ag.use),Ag});
